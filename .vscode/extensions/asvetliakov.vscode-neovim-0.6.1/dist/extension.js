(()=>{var e={2289:(e,t,n)=>{var i={};e.exports=i,i.themes={};var r=n(3837),s=i.styles=n(8982),o=Object.defineProperties,a=new RegExp(/[\r\n]+/g);i.supportsColor=n(8136).supportsColor,void 0===i.enabled&&(i.enabled=!1!==i.supportsColor()),i.enable=function(){i.enabled=!0},i.disable=function(){i.enabled=!1},i.stripColors=i.strip=function(e){return(""+e).replace(/\x1B\[\d+m/g,"")},i.stylize=function(e,t){if(!i.enabled)return e+"";var n=s[t];return!n&&t in i?i[t](e):n.open+e+n.close};var c=/[|\\{}()[\]^$+*?.]/g;function l(e){var t=function e(){return f.apply(e,arguments)};return t._styles=e,t.__proto__=d,t}var u,h=(u={},s.grey=s.gray,Object.keys(s).forEach((function(e){s[e].closeRe=new RegExp(function(e){if("string"!=typeof e)throw new TypeError("Expected a string");return e.replace(c,"\\$&")}(s[e].close),"g"),u[e]={get:function(){return l(this._styles.concat(e))}}})),u),d=o((function(){}),h);function f(){var e=Array.prototype.slice.call(arguments).map((function(e){return null!=e&&e.constructor===String?e:r.inspect(e)})).join(" ");if(!i.enabled||!e)return e;for(var t=-1!=e.indexOf("\n"),n=this._styles,o=n.length;o--;){var c=s[n[o]];e=c.open+e.replace(c.closeRe,c.open)+c.close,t&&(e=e.replace(a,(function(e){return c.close+e+c.open})))}return e}i.setTheme=function(e){if("string"!=typeof e)for(var t in e)!function(t){i[t]=function(n){if("object"==typeof e[t]){var r=n;for(var s in e[t])r=i[e[t][s]](r);return r}return i[e[t]](n)}}(t);else console.log("colors.setTheme now only accepts an object, not a string.  If you are trying to set a theme from a file, it is now your (the caller's) responsibility to require the file.  The old syntax looked like colors.setTheme(__dirname + '/../themes/generic-logging.js'); The new syntax looks like colors.setTheme(require(__dirname + '/../themes/generic-logging.js'));")};var p=function(e,t){var n=t.split("");return(n=n.map(e)).join("")};for(var g in i.trap=n(8763),i.zalgo=n(750),i.maps={},i.maps.america=n(6278)(i),i.maps.zebra=n(848)(i),i.maps.rainbow=n(8823)(i),i.maps.random=n(9353)(i),i.maps)!function(e){i[e]=function(t){return p(i.maps[e],t)}}(g);o(i,function(){var e={};return Object.keys(h).forEach((function(t){e[t]={get:function(){return l([t])}}})),e}())},8763:e=>{e.exports=function(e,t){var n="";e=(e=e||"Run the trap, drop the bass").split("");var i={a:["@","Ą","Ⱥ","Ʌ","Δ","Λ","Д"],b:["ß","Ɓ","Ƀ","ɮ","β","฿"],c:["©","Ȼ","Ͼ"],d:["Ð","Ɗ","Ԁ","ԁ","Ԃ","ԃ"],e:["Ë","ĕ","Ǝ","ɘ","Σ","ξ","Ҽ","੬"],f:["Ӻ"],g:["ɢ"],h:["Ħ","ƕ","Ң","Һ","Ӈ","Ԋ"],i:["༏"],j:["Ĵ"],k:["ĸ","Ҡ","Ӄ","Ԟ"],l:["Ĺ"],m:["ʍ","Ӎ","ӎ","Ԡ","ԡ","൩"],n:["Ñ","ŋ","Ɲ","Ͷ","Π","Ҋ"],o:["Ø","õ","ø","Ǿ","ʘ","Ѻ","ם","۝","๏"],p:["Ƿ","Ҏ"],q:["্"],r:["®","Ʀ","Ȑ","Ɍ","ʀ","Я"],s:["§","Ϟ","ϟ","Ϩ"],t:["Ł","Ŧ","ͳ"],u:["Ʊ","Ս"],v:["ט"],w:["Ш","Ѡ","Ѽ","൰"],x:["Ҳ","Ӿ","Ӽ","ӽ"],y:["¥","Ұ","Ӌ"],z:["Ƶ","ɀ"]};return e.forEach((function(e){e=e.toLowerCase();var t=i[e]||[" "],r=Math.floor(Math.random()*t.length);n+=void 0!==i[e]?i[e][r]:e})),n}},750:e=>{e.exports=function(e,t){e=e||"   he is here   ";var n={up:["̍","̎","̄","̅","̿","̑","̆","̐","͒","͗","͑","̇","̈","̊","͂","̓","̈","͊","͋","͌","̃","̂","̌","͐","̀","́","̋","̏","̒","̓","̔","̽","̉","ͣ","ͤ","ͥ","ͦ","ͧ","ͨ","ͩ","ͪ","ͫ","ͬ","ͭ","ͮ","ͯ","̾","͛","͆","̚"],down:["̖","̗","̘","̙","̜","̝","̞","̟","̠","̤","̥","̦","̩","̪","̫","̬","̭","̮","̯","̰","̱","̲","̳","̹","̺","̻","̼","ͅ","͇","͈","͉","͍","͎","͓","͔","͕","͖","͙","͚","̣"],mid:["̕","̛","̀","́","͘","̡","̢","̧","̨","̴","̵","̶","͜","͝","͞","͟","͠","͢","̸","̷","͡"," ҉"]},i=[].concat(n.up,n.down,n.mid);function r(e){return Math.floor(Math.random()*e)}function s(e){var t=!1;return i.filter((function(n){t=n===e})),t}return function(e,t){var i,o,a="";for(o in(t=t||{}).up=void 0===t.up||t.up,t.mid=void 0===t.mid||t.mid,t.down=void 0===t.down||t.down,t.size=void 0!==t.size?t.size:"maxi",e=e.split(""))if(!s(o)){switch(a+=e[o],i={up:0,down:0,mid:0},t.size){case"mini":i.up=r(8),i.mid=r(2),i.down=r(8);break;case"maxi":i.up=r(16)+3,i.mid=r(4)+1,i.down=r(64)+3;break;default:i.up=r(8)+1,i.mid=r(6)/2,i.down=r(8)+1}var c=["up","mid","down"];for(var l in c)for(var u=c[l],h=0;h<=i[u];h++)t[u]&&(a+=n[u][r(n[u].length)])}return a}(e,t)}},6278:e=>{e.exports=function(e){return function(t,n,i){if(" "===t)return t;switch(n%3){case 0:return e.red(t);case 1:return e.white(t);case 2:return e.blue(t)}}}},8823:e=>{e.exports=function(e){var t=["red","yellow","green","blue","magenta"];return function(n,i,r){return" "===n?n:e[t[i++%t.length]](n)}}},9353:e=>{e.exports=function(e){var t=["underline","inverse","grey","yellow","red","green","blue","white","cyan","magenta","brightYellow","brightRed","brightGreen","brightBlue","brightWhite","brightCyan","brightMagenta"];return function(n,i,r){return" "===n?n:e[t[Math.round(Math.random()*(t.length-2))]](n)}}},848:e=>{e.exports=function(e){return function(t,n,i){return n%2==0?t:e.inverse(t)}}},8982:e=>{var t={};e.exports=t;var n={reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],inverse:[7,27],hidden:[8,28],strikethrough:[9,29],black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],gray:[90,39],grey:[90,39],brightRed:[91,39],brightGreen:[92,39],brightYellow:[93,39],brightBlue:[94,39],brightMagenta:[95,39],brightCyan:[96,39],brightWhite:[97,39],bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgGray:[100,49],bgGrey:[100,49],bgBrightRed:[101,49],bgBrightGreen:[102,49],bgBrightYellow:[103,49],bgBrightBlue:[104,49],bgBrightMagenta:[105,49],bgBrightCyan:[106,49],bgBrightWhite:[107,49],blackBG:[40,49],redBG:[41,49],greenBG:[42,49],yellowBG:[43,49],blueBG:[44,49],magentaBG:[45,49],cyanBG:[46,49],whiteBG:[47,49]};Object.keys(n).forEach((function(e){var i=n[e],r=t[e]=[];r.open="["+i[0]+"m",r.close="["+i[1]+"m"}))},3719:e=>{"use strict";e.exports=function(e,t){var n=(t=t||process.argv).indexOf("--"),i=/^-{1,2}/.test(e)?"":"--",r=t.indexOf(i+e);return-1!==r&&(-1===n||r<n)}},8136:(e,t,n)=>{"use strict";var i=n(2037),r=n(3719),s=process.env,o=void 0;function a(e){var t=function(e){if(!1===o)return 0;if(r("color=16m")||r("color=full")||r("color=truecolor"))return 3;if(r("color=256"))return 2;if(e&&!e.isTTY&&!0!==o)return 0;var t=o?1:0;if("win32"===process.platform){var n=i.release().split(".");return Number(process.versions.node.split(".")[0])>=8&&Number(n[0])>=10&&Number(n[2])>=10586?Number(n[2])>=14931?3:2:1}if("CI"in s)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI"].some((function(e){return e in s}))||"codeship"===s.CI_NAME?1:t;if("TEAMCITY_VERSION"in s)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(s.TEAMCITY_VERSION)?1:0;if("TERM_PROGRAM"in s){var a=parseInt((s.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(s.TERM_PROGRAM){case"iTerm.app":return a>=3?3:2;case"Hyper":return 3;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(s.TERM)?2:/^screen|^xterm|^vt100|^rxvt|color|ansi|cygwin|linux/i.test(s.TERM)||"COLORTERM"in s?1:(s.TERM,t)}(e);return function(e){return 0!==e&&{level:e,hasBasic:!0,has256:e>=2,has16m:e>=3}}(t)}r("no-color")||r("no-colors")||r("color=false")?o=!1:(r("color")||r("colors")||r("color=true")||r("color=always"))&&(o=!0),"FORCE_COLOR"in s&&(o=0===s.FORCE_COLOR.length||0!==parseInt(s.FORCE_COLOR,10)),e.exports={supportsColor:a,stdout:a(process.stdout),stderr:a(process.stderr)}},3645:(e,t,n)=>{var i=n(2289);e.exports=i},4099:e=>{var t=[],n=[],i=function(){};function r(e){return!~t.indexOf(e)&&(t.push(e),!0)}function s(e){i=e}function o(e){for(var n=[],i=0;i<t.length;i++)if(t[i].async)n.push(t[i]);else if(t[i](e))return!0;return!!n.length&&new Promise((function(t){Promise.all(n.map((function(t){return t(e)}))).then((function(e){t(e.some(Boolean))}))}))}function a(e){return!~n.indexOf(e)&&(n.push(e),!0)}function c(){i.apply(i,arguments)}function l(e){for(var t=0;t<n.length;t++)e=n[t].apply(n[t],arguments);return e}function u(e,t){var n=Object.prototype.hasOwnProperty;for(var i in t)n.call(t,i)&&(e[i]=t[i]);return e}function h(e){return e.enabled=!1,e.modify=a,e.set=s,e.use=r,u((function(){return!1}),e)}function d(e){return e.enabled=!0,e.modify=a,e.set=s,e.use=r,u((function(){var t=Array.prototype.slice.call(arguments,0);return c.call(c,e,l(t,e)),!0}),e)}e.exports=function(e){return e.introduce=u,e.enabled=o,e.process=l,e.modify=a,e.write=c,e.nope=h,e.yep=d,e.set=s,e.use=r,e}},3420:(e,t,n)=>{e.exports=n(3601)},3601:(e,t,n)=>{var i=n(4099)((function e(t,n){return(n=n||{}).namespace=t,n.prod=!0,n.dev=!1,n.force||e.force?e.yep(n):e.nope(n)}));e.exports=i},4409:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,s.isAsync)(e)?function(...t){const n=t.pop();return a(e.apply(this,t),n)}:(0,i.default)((function(t,n){var i;try{i=e.apply(this,t)}catch(e){return n(e)}if(i&&"function"==typeof i.then)return a(i,n);n(null,i)}))};var i=o(n(3519)),r=o(n(3111)),s=n(8993);function o(e){return e&&e.__esModule?e:{default:e}}function a(e,t){return e.then((e=>{c(t,null,e)}),(e=>{c(t,e&&e.message?e:new Error(e))}))}function c(e,t,n){try{e(t,n)}catch(e){(0,r.default)((e=>{throw e}),e)}}e.exports=t.default},1846:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=u(n(5616)),r=u(n(1605)),s=u(n(7388)),o=u(n(6979)),a=u(n(3362)),c=u(n(8993)),l=u(n(2795));function u(e){return e&&e.__esModule?e:{default:e}}function h(e,t,n){n=(0,o.default)(n);var i=0,s=0,{length:c}=e,l=!1;function u(e,t){!1===e&&(l=!0),!0!==l&&(e?n(e):++s!==c&&t!==r.default||n(null))}for(0===c&&n(null);i<c;i++)t(e[i],i,(0,a.default)(u))}function d(e,t,n){return(0,s.default)(e,1/0,t,n)}t.default=(0,l.default)((function(e,t,n){return((0,i.default)(e)?h:d)(e,(0,c.default)(t),n)}),3),e.exports=t.default},7388:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=o(n(6954)),r=o(n(8993)),s=o(n(2795));function o(e){return e&&e.__esModule?e:{default:e}}t.default=(0,s.default)((function(e,t,n,s){return(0,i.default)(t)(e,(0,r.default)(n),s)}),4),e.exports=t.default},667:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=s(n(7388)),r=s(n(2795));function s(e){return e&&e.__esModule?e:{default:e}}t.default=(0,r.default)((function(e,t,n){return(0,i.default)(e,1,t,n)}),3),e.exports=t.default},8058:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a(n(1846)),r=a(n(6529)),s=a(n(8993)),o=a(n(2795));function a(e){return e&&e.__esModule?e:{default:e}}t.default=(0,o.default)((function(e,t,n){return(0,i.default)(e,(0,r.default)((0,s.default)(t)),n)}),3),e.exports=t.default},8617:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,i){let s=!1,o=!1,a=!1,c=0,l=0;function u(){c>=t||a||s||(a=!0,e.next().then((({value:e,done:t})=>{if(!o&&!s){if(a=!1,t)return s=!0,void(c<=0&&i(null));c++,n(e,l,h),l++,u()}})).catch(d))}function h(e,t){if(c-=1,!o)return e?d(e):!1===e?(s=!0,void(o=!0)):t===r.default||s&&c<=0?(s=!0,i(null)):void u()}function d(e){o||(a=!1,s=!0,i(e))}u()};var i,r=(i=n(1605))&&i.__esModule?i:{default:i};e.exports=t.default},2795:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t=e.length){if(!t)throw new Error("arity is undefined");return function(...n){return"function"==typeof n[t-1]?e.apply(this,n):new Promise(((i,r)=>{n[t-1]=(e,...t)=>{if(e)return r(e);i(t.length>1?t:t[0])},e.apply(this,n)}))}},e.exports=t.default},1605:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={},e.exports=t.default},6954:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=l(n(6979)),r=l(n(9733)),s=l(n(3362)),o=n(8993),a=l(n(8617)),c=l(n(1605));function l(e){return e&&e.__esModule?e:{default:e}}t.default=e=>(t,n,l)=>{if(l=(0,i.default)(l),e<=0)throw new RangeError("concurrency limit cannot be less than 1");if(!t)return l(null);if((0,o.isAsyncGenerator)(t))return(0,a.default)(t,e,n,l);if((0,o.isAsyncIterable)(t))return(0,a.default)(t[Symbol.asyncIterator](),e,n,l);var u=(0,r.default)(t),h=!1,d=!1,f=0,p=!1;function g(e,t){if(!d)if(f-=1,e)h=!0,l(e);else if(!1===e)h=!0,d=!0;else{if(t===c.default||h&&f<=0)return h=!0,l(null);p||m()}}function m(){for(p=!0;f<e&&!h;){var t=u();if(null===t)return h=!0,void(f<=0&&l(null));f+=1,n(t.value,t.key,(0,s.default)(g))}p=!1}m()},e.exports=t.default},7818:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e[Symbol.iterator]&&e[Symbol.iterator]()},e.exports=t.default},3519:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return function(...t){var n=t.pop();return e.call(this,t,n)}},e.exports=t.default},5616:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e&&"number"==typeof e.length&&e.length>=0&&e.length%1==0},e.exports=t.default},9733:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if((0,i.default)(e))return function(e){var t=-1,n=e.length;return function(){return++t<n?{value:e[t],key:t}:null}}(e);var t,n,s,o,a=(0,r.default)(e);return a?function(e){var t=-1;return function(){var n=e.next();return n.done?null:(t++,{value:n.value,key:t})}}(a):(n=(t=e)?Object.keys(t):[],s=-1,o=n.length,function e(){var i=n[++s];return"__proto__"===i?e():s<o?{value:t[i],key:i}:null})};var i=s(n(5616)),r=s(n(7818));function s(e){return e&&e.__esModule?e:{default:e}}e.exports=t.default},6979:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){function t(...t){if(null!==e){var n=e;e=null,n.apply(this,t)}}return Object.assign(t,e),t},e.exports=t.default},3362:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return function(...t){if(null===e)throw new Error("Callback was already called.");var n=e;e=null,n.apply(this,t)}},e.exports=t.default},3409:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=o(n(5616)),r=o(n(8993)),s=o(n(2795));function o(e){return e&&e.__esModule?e:{default:e}}t.default=(0,s.default)(((e,t,n)=>{var s=(0,i.default)(t)?[]:{};e(t,((e,t,n)=>{(0,r.default)(e)(((e,...i)=>{i.length<2&&([i]=i),s[t]=i,n(e)}))}),(e=>n(e,s)))}),3),e.exports=t.default},3111:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fallback=o,t.wrap=a;var n,i=t.hasQueueMicrotask="function"==typeof queueMicrotask&&queueMicrotask,r=t.hasSetImmediate="function"==typeof setImmediate&&setImmediate,s=t.hasNextTick="object"==typeof process&&"function"==typeof process.nextTick;function o(e){setTimeout(e,0)}function a(e){return(t,...n)=>e((()=>t(...n)))}n=i?queueMicrotask:r?setImmediate:s?process.nextTick:o,t.default=a(n)},6529:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(t,n,i)=>e(t,i)},e.exports=t.default},8993:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isAsyncIterable=t.isAsyncGenerator=t.isAsync=void 0;var i,r=(i=n(4409))&&i.__esModule?i:{default:i};function s(e){return"AsyncFunction"===e[Symbol.toStringTag]}t.default=function(e){if("function"!=typeof e)throw new Error("expected a function");return s(e)?(0,r.default)(e):e},t.isAsync=s,t.isAsyncGenerator=function(e){return"AsyncGenerator"===e[Symbol.toStringTag]},t.isAsyncIterable=function(e){return"function"==typeof e[Symbol.asyncIterator]}},8415:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return(0,i.default)(r.default,e,t)};var i=s(n(3409)),r=s(n(667));function s(e){return e&&e.__esModule?e:{default:e}}e.exports=t.default},7529:e=>{var t=-1,n=1,i=0;function r(e,g,m,v,b){if(e===g)return e?[[i,e]]:[];if(null!=m){var w=function(e,t,n){var i="number"==typeof n?{index:n,length:0}:n.oldRange,r="number"==typeof n?null:n.newRange,s=e.length,o=t.length;if(0===i.length&&(null===r||0===r.length)){var a=i.index,c=e.slice(0,a),l=e.slice(a),u=r?r.index:null,h=a+o-s;if((null===u||u===h)&&!(h<0||h>o)){var d=t.slice(0,h);if((g=t.slice(h))===l){var f=Math.min(a,h);if((v=c.slice(0,f))===(w=d.slice(0,f)))return y(v,c.slice(f),d.slice(f),l)}}if(null===u||u===a){var p=a,g=(d=t.slice(0,p),t.slice(p));if(d===c){var m=Math.min(s-p,o-p);if((b=l.slice(l.length-m))===(_=g.slice(g.length-m)))return y(c,l.slice(0,l.length-m),g.slice(0,g.length-m),b)}}}if(i.length>0&&r&&0===r.length){var v=e.slice(0,i.index),b=e.slice(i.index+i.length);if(!(o<(f=v.length)+(m=b.length))){var w=t.slice(0,f),_=t.slice(o-m);if(v===w&&b===_)return y(v,e.slice(f,s-m),t.slice(f,o-m),b)}}return null}(e,g,m);if(w)return w}var _=o(e,g),x=e.substring(0,_);_=c(e=e.substring(_),g=g.substring(_));var E=e.substring(e.length-_),S=function(e,a){var l;if(!e)return[[n,a]];if(!a)return[[t,e]];var u=e.length>a.length?e:a,h=e.length>a.length?a:e,d=u.indexOf(h);if(-1!==d)return l=[[n,u.substring(0,d)],[i,h],[n,u.substring(d+h.length)]],e.length>a.length&&(l[0][0]=l[2][0]=t),l;if(1===h.length)return[[t,e],[n,a]];var f=function(e,t){var n=e.length>t.length?e:t,i=e.length>t.length?t:e;if(n.length<4||2*i.length<n.length)return null;function r(e,t,n){for(var i,r,s,a,l=e.substring(n,n+Math.floor(e.length/4)),u=-1,h="";-1!==(u=t.indexOf(l,u+1));){var d=o(e.substring(n),t.substring(u)),f=c(e.substring(0,n),t.substring(0,u));h.length<f+d&&(h=t.substring(u-f,u)+t.substring(u,u+d),i=e.substring(0,n-f),r=e.substring(n+d),s=t.substring(0,u-f),a=t.substring(u+d))}return 2*h.length>=e.length?[i,r,s,a,h]:null}var s,a,l,u,h,d=r(n,i,Math.ceil(n.length/4)),f=r(n,i,Math.ceil(n.length/2));return d||f?(s=f?d&&d[4].length>f[4].length?d:f:d,e.length>t.length?(a=s[0],l=s[1],u=s[2],h=s[3]):(u=s[0],h=s[1],a=s[2],l=s[3]),[a,l,u,h,s[4]]):null}(e,a);if(f){var p=f[0],g=f[1],m=f[2],v=f[3],b=f[4],y=r(p,m),w=r(g,v);return y.concat([[i,b]],w)}return function(e,i){for(var r=e.length,o=i.length,a=Math.ceil((r+o)/2),c=a,l=2*a,u=new Array(l),h=new Array(l),d=0;d<l;d++)u[d]=-1,h[d]=-1;u[c+1]=0,h[c+1]=0;for(var f=r-o,p=f%2!=0,g=0,m=0,v=0,b=0,y=0;y<a;y++){for(var w=-y+g;w<=y-m;w+=2){for(var _=c+w,x=(T=w===-y||w!==y&&u[_-1]<u[_+1]?u[_+1]:u[_-1]+1)-w;T<r&&x<o&&e.charAt(T)===i.charAt(x);)T++,x++;if(u[_]=T,T>r)m+=2;else if(x>o)g+=2;else if(p&&(C=c+f-w)>=0&&C<l&&-1!==h[C]&&T>=(S=r-h[C]))return s(e,i,T,x)}for(var E=-y+v;E<=y-b;E+=2){for(var S,C=c+E,M=(S=E===-y||E!==y&&h[C-1]<h[C+1]?h[C+1]:h[C-1]+1)-E;S<r&&M<o&&e.charAt(r-S-1)===i.charAt(o-M-1);)S++,M++;if(h[C]=S,S>r)b+=2;else if(M>o)v+=2;else if(!p){var T;if((_=c+f-E)>=0&&_<l&&-1!==u[_])if(x=c+(T=u[_])-_,T>=(S=r-S))return s(e,i,T,x)}}}return[[t,e],[n,i]]}(e,a)}(e=e.substring(0,e.length-_),g=g.substring(0,g.length-_));return x&&S.unshift([i,x]),E&&S.push([i,E]),p(S,b),v&&function(e){for(var r=!1,s=[],o=0,g=null,m=0,v=0,b=0,y=0,w=0;m<e.length;)e[m][0]==i?(s[o++]=m,v=y,b=w,y=0,w=0,g=e[m][1]):(e[m][0]==n?y+=e[m][1].length:w+=e[m][1].length,g&&g.length<=Math.max(v,b)&&g.length<=Math.max(y,w)&&(e.splice(s[o-1],0,[t,g]),e[s[o-1]+1][0]=n,o--,m=--o>0?s[o-1]:-1,v=0,b=0,y=0,w=0,g=null,r=!0)),m++;for(r&&p(e),function(e){function t(e,t){if(!e||!t)return 6;var n=e.charAt(e.length-1),i=t.charAt(0),r=n.match(l),s=i.match(l),o=r&&n.match(u),a=s&&i.match(u),c=o&&n.match(h),p=a&&i.match(h),g=c&&e.match(d),m=p&&t.match(f);return g||m?5:c||p?4:r&&!o&&a?3:o||a?2:r||s?1:0}for(var n=1;n<e.length-1;){if(e[n-1][0]==i&&e[n+1][0]==i){var r=e[n-1][1],s=e[n][1],o=e[n+1][1],a=c(r,s);if(a){var p=s.substring(s.length-a);r=r.substring(0,r.length-a),s=p+s.substring(0,s.length-a),o=p+o}for(var g=r,m=s,v=o,b=t(r,s)+t(s,o);s.charAt(0)===o.charAt(0);){r+=s.charAt(0),s=s.substring(1)+o.charAt(0),o=o.substring(1);var y=t(r,s)+t(s,o);y>=b&&(b=y,g=r,m=s,v=o)}e[n-1][1]!=g&&(g?e[n-1][1]=g:(e.splice(n-1,1),n--),e[n][1]=m,v?e[n+1][1]=v:(e.splice(n+1,1),n--))}n++}}(e),m=1;m<e.length;){if(e[m-1][0]==t&&e[m][0]==n){var _=e[m-1][1],x=e[m][1],E=a(_,x),S=a(x,_);E>=S?(E>=_.length/2||E>=x.length/2)&&(e.splice(m,0,[i,x.substring(0,E)]),e[m-1][1]=_.substring(0,_.length-E),e[m+1][1]=x.substring(E),m++):(S>=_.length/2||S>=x.length/2)&&(e.splice(m,0,[i,_.substring(0,S)]),e[m-1][0]=n,e[m-1][1]=x.substring(0,x.length-S),e[m+1][0]=t,e[m+1][1]=_.substring(S),m++),m++}m++}}(S),S}function s(e,t,n,i){var s=e.substring(0,n),o=t.substring(0,i),a=e.substring(n),c=t.substring(i),l=r(s,o),u=r(a,c);return l.concat(u)}function o(e,t){if(!e||!t||e.charAt(0)!==t.charAt(0))return 0;for(var n=0,i=Math.min(e.length,t.length),r=i,s=0;n<r;)e.substring(s,r)==t.substring(s,r)?s=n=r:i=r,r=Math.floor((i-n)/2+n);return g(e.charCodeAt(r-1))&&r--,r}function a(e,t){var n=e.length,i=t.length;if(0==n||0==i)return 0;n>i?e=e.substring(n-i):n<i&&(t=t.substring(0,n));var r=Math.min(n,i);if(e==t)return r;for(var s=0,o=1;;){var a=e.substring(r-o),c=t.indexOf(a);if(-1==c)return s;o+=c,0!=c&&e.substring(r-o)!=t.substring(0,o)||(s=o,o++)}}function c(e,t){if(!e||!t||e.slice(-1)!==t.slice(-1))return 0;for(var n=0,i=Math.min(e.length,t.length),r=i,s=0;n<r;)e.substring(e.length-r,e.length-s)==t.substring(t.length-r,t.length-s)?s=n=r:i=r,r=Math.floor((i-n)/2+n);return m(e.charCodeAt(e.length-r))&&r--,r}var l=/[^a-zA-Z0-9]/,u=/\s/,h=/[\r\n]/,d=/\n\r?\n$/,f=/^\r?\n\r?\n/;function p(e,r){e.push([i,""]);for(var s,a=0,l=0,u=0,h="",d="";a<e.length;)if(a<e.length-1&&!e[a][1])e.splice(a,1);else switch(e[a][0]){case n:u++,d+=e[a][1],a++;break;case t:l++,h+=e[a][1],a++;break;case i:var f=a-u-l-1;if(r){if(f>=0&&b(e[f][1])){var g=e[f][1].slice(-1);if(e[f][1]=e[f][1].slice(0,-1),h=g+h,d=g+d,!e[f][1]){e.splice(f,1),a--;var m=f-1;e[m]&&e[m][0]===n&&(u++,d=e[m][1]+d,m--),e[m]&&e[m][0]===t&&(l++,h=e[m][1]+h,m--),f=m}}v(e[a][1])&&(g=e[a][1].charAt(0),e[a][1]=e[a][1].slice(1),h+=g,d+=g)}if(a<e.length-1&&!e[a][1]){e.splice(a,1);break}if(h.length>0||d.length>0){h.length>0&&d.length>0&&(0!==(s=o(d,h))&&(f>=0?e[f][1]+=d.substring(0,s):(e.splice(0,0,[i,d.substring(0,s)]),a++),d=d.substring(s),h=h.substring(s)),0!==(s=c(d,h))&&(e[a][1]=d.substring(d.length-s)+e[a][1],d=d.substring(0,d.length-s),h=h.substring(0,h.length-s)));var y=u+l;0===h.length&&0===d.length?(e.splice(a-y,y),a-=y):0===h.length?(e.splice(a-y,y,[n,d]),a=a-y+1):0===d.length?(e.splice(a-y,y,[t,h]),a=a-y+1):(e.splice(a-y,y,[t,h],[n,d]),a=a-y+2)}0!==a&&e[a-1][0]===i?(e[a-1][1]+=e[a][1],e.splice(a,1)):a++,u=0,l=0,h="",d=""}""===e[e.length-1][1]&&e.pop();var w=!1;for(a=1;a<e.length-1;)e[a-1][0]===i&&e[a+1][0]===i&&(e[a][1].substring(e[a][1].length-e[a-1][1].length)===e[a-1][1]?(e[a][1]=e[a-1][1]+e[a][1].substring(0,e[a][1].length-e[a-1][1].length),e[a+1][1]=e[a-1][1]+e[a+1][1],e.splice(a-1,1),w=!0):e[a][1].substring(0,e[a+1][1].length)==e[a+1][1]&&(e[a-1][1]+=e[a+1][1],e[a][1]=e[a][1].substring(e[a+1][1].length)+e[a+1][1],e.splice(a+1,1),w=!0)),a++;w&&p(e,r)}function g(e){return e>=55296&&e<=56319}function m(e){return e>=56320&&e<=57343}function v(e){return m(e.charCodeAt(0))}function b(e){return g(e.charCodeAt(e.length-1))}function y(e,r,s,o){return b(e)||v(o)?null:function(e){for(var t=[],n=0;n<e.length;n++)e[n][1].length>0&&t.push(e[n]);return t}([[i,e],[t,r],[n,s],[i,o]])}function w(e,t,n,i){return r(e,t,n,i,!0)}w.INSERT=n,w.DELETE=t,w.EQUAL=i,e.exports=w},9432:(e,t,n)=>{"use strict";n.r(t),n.d(t,{assign:()=>u,default:()=>k,defaultI18n:()=>p,format:()=>$,parse:()=>O,setGlobalDateI18n:()=>m,setGlobalDateMasks:()=>T});var i=/d{1,4}|M{1,4}|YY(?:YY)?|S{1,3}|Do|ZZ|Z|([HhMsDm])\1?|[aA]|"[^"]*"|'[^']*'/g,r="\\d\\d?",s="\\d\\d",o="[^\\s]+",a=/\[([^]*?)\]/gm;function c(e,t){for(var n=[],i=0,r=e.length;i<r;i++)n.push(e[i].substr(0,t));return n}var l=function(e){return function(t,n){var i=n[e].map((function(e){return e.toLowerCase()})),r=i.indexOf(t.toLowerCase());return r>-1?r:null}};function u(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var i=0,r=t;i<r.length;i++){var s=r[i];for(var o in s)e[o]=s[o]}return e}var h=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],d=["January","February","March","April","May","June","July","August","September","October","November","December"],f=c(d,3),p={dayNamesShort:c(h,3),dayNames:h,monthNamesShort:f,monthNames:d,amPm:["am","pm"],DoFn:function(e){return e+["th","st","nd","rd"][e%10>3?0:(e-e%10!=10?1:0)*e%10]}},g=u({},p),m=function(e){return g=u(g,e)},v=function(e){return e.replace(/[|\\{()[^$+*?.-]/g,"\\$&")},b=function(e,t){for(void 0===t&&(t=2),e=String(e);e.length<t;)e="0"+e;return e},y={D:function(e){return String(e.getDate())},DD:function(e){return b(e.getDate())},Do:function(e,t){return t.DoFn(e.getDate())},d:function(e){return String(e.getDay())},dd:function(e){return b(e.getDay())},ddd:function(e,t){return t.dayNamesShort[e.getDay()]},dddd:function(e,t){return t.dayNames[e.getDay()]},M:function(e){return String(e.getMonth()+1)},MM:function(e){return b(e.getMonth()+1)},MMM:function(e,t){return t.monthNamesShort[e.getMonth()]},MMMM:function(e,t){return t.monthNames[e.getMonth()]},YY:function(e){return b(String(e.getFullYear()),4).substr(2)},YYYY:function(e){return b(e.getFullYear(),4)},h:function(e){return String(e.getHours()%12||12)},hh:function(e){return b(e.getHours()%12||12)},H:function(e){return String(e.getHours())},HH:function(e){return b(e.getHours())},m:function(e){return String(e.getMinutes())},mm:function(e){return b(e.getMinutes())},s:function(e){return String(e.getSeconds())},ss:function(e){return b(e.getSeconds())},S:function(e){return String(Math.round(e.getMilliseconds()/100))},SS:function(e){return b(Math.round(e.getMilliseconds()/10),2)},SSS:function(e){return b(e.getMilliseconds(),3)},a:function(e,t){return e.getHours()<12?t.amPm[0]:t.amPm[1]},A:function(e,t){return e.getHours()<12?t.amPm[0].toUpperCase():t.amPm[1].toUpperCase()},ZZ:function(e){var t=e.getTimezoneOffset();return(t>0?"-":"+")+b(100*Math.floor(Math.abs(t)/60)+Math.abs(t)%60,4)},Z:function(e){var t=e.getTimezoneOffset();return(t>0?"-":"+")+b(Math.floor(Math.abs(t)/60),2)+":"+b(Math.abs(t)%60,2)}},w=function(e){return+e-1},_=[null,r],x=[null,o],E=["isPm",o,function(e,t){var n=e.toLowerCase();return n===t.amPm[0]?0:n===t.amPm[1]?1:null}],S=["timezoneOffset","[^\\s]*?[\\+\\-]\\d\\d:?\\d\\d|[^\\s]*?Z?",function(e){var t=(e+"").match(/([+-]|\d\d)/gi);if(t){var n=60*+t[1]+parseInt(t[2],10);return"+"===t[0]?n:-n}return 0}],C={D:["day",r],DD:["day",s],Do:["day",r+o,function(e){return parseInt(e,10)}],M:["month",r,w],MM:["month",s,w],YY:["year",s,function(e){var t=+(""+(new Date).getFullYear()).substr(0,2);return+(""+(+e>68?t-1:t)+e)}],h:["hour",r,void 0,"isPm"],hh:["hour",s,void 0,"isPm"],H:["hour",r],HH:["hour",s],m:["minute",r],mm:["minute",s],s:["second",r],ss:["second",s],YYYY:["year","\\d{4}"],S:["millisecond","\\d",function(e){return 100*+e}],SS:["millisecond",s,function(e){return 10*+e}],SSS:["millisecond","\\d{3}"],d:_,dd:_,ddd:x,dddd:x,MMM:["month",o,l("monthNamesShort")],MMMM:["month",o,l("monthNames")],a:E,A:E,ZZ:S,Z:S},M={default:"ddd MMM DD YYYY HH:mm:ss",shortDate:"M/D/YY",mediumDate:"MMM D, YYYY",longDate:"MMMM D, YYYY",fullDate:"dddd, MMMM D, YYYY",isoDate:"YYYY-MM-DD",isoDateTime:"YYYY-MM-DDTHH:mm:ssZ",shortTime:"HH:mm",mediumTime:"HH:mm:ss",longTime:"HH:mm:ss.SSS"},T=function(e){return u(M,e)},$=function(e,t,n){if(void 0===t&&(t=M.default),void 0===n&&(n={}),"number"==typeof e&&(e=new Date(e)),"[object Date]"!==Object.prototype.toString.call(e)||isNaN(e.getTime()))throw new Error("Invalid Date pass to format");t=M[t]||t;var r=[];t=t.replace(a,(function(e,t){return r.push(t),"@@@"}));var s=u(u({},g),n);return(t=t.replace(i,(function(t){return y[t](e,s)}))).replace(/@@@/g,(function(){return r.shift()}))};function O(e,t,n){if(void 0===n&&(n={}),"string"!=typeof t)throw new Error("Invalid format in fecha parse");if(t=M[t]||t,e.length>1e3)return null;var r={year:(new Date).getFullYear(),month:0,day:1,hour:0,minute:0,second:0,millisecond:0,isPm:null,timezoneOffset:null},s=[],o=[],c=t.replace(a,(function(e,t){return o.push(v(t)),"@@@"})),l={},h={};c=v(c).replace(i,(function(e){var t=C[e],n=t[0],i=t[1],r=t[3];if(l[n])throw new Error("Invalid format. "+n+" specified twice in format");return l[n]=!0,r&&(h[r]=!0),s.push(t),"("+i+")"})),Object.keys(h).forEach((function(e){if(!l[e])throw new Error("Invalid format. "+e+" is required in specified format")})),c=c.replace(/@@@/g,(function(){return o.shift()}));var d=e.match(new RegExp(c,"i"));if(!d)return null;for(var f,p=u(u({},g),n),m=1;m<d.length;m++){var b=s[m-1],y=b[0],w=b[2],_=w?w(d[m],p):+d[m];if(null==_)return null;r[y]=_}if(1===r.isPm&&null!=r.hour&&12!=+r.hour?r.hour=+r.hour+12:0===r.isPm&&12==+r.hour&&(r.hour=0),null==r.timezoneOffset){f=new Date(r.year,r.month,r.day,r.hour,r.minute,r.second,r.millisecond);for(var x=[["month","getMonth"],["day","getDate"],["hour","getHours"],["minute","getMinutes"],["second","getSeconds"]],E=(m=0,x.length);m<E;m++)if(l[x[m][0]]&&r[x[m][0]]!==f[x[m][1]]())return null}else if(f=new Date(Date.UTC(r.year,r.month,r.day,r.hour,r.minute-r.timezoneOffset,r.second,r.millisecond)),r.month>11||r.month<0||r.day>31||r.day<1||r.hour>23||r.hour<0||r.minute>59||r.minute<0||r.second>59||r.second<0)return null;return f}const k={format:$,parse:O,defaultI18n:p,setGlobalDateI18n:m,setGlobalDateMasks:T}},2296:e=>{"use strict";var t=Object.prototype.toString;e.exports=function(e){if("string"==typeof e.displayName&&e.constructor.name)return e.displayName;if("string"==typeof e.name&&e.name)return e.name;if("object"==typeof e&&e.constructor&&"string"==typeof e.constructor.name)return e.constructor.name;var n=e.toString(),i=t.call(e).slice(8,-1);return(n="Function"===i?n.substring(n.indexOf("(")+1,n.indexOf(")")):i)||"anonymous"}},4378:(e,t,n)=>{try{var i=n(3837);if("function"!=typeof i.inherits)throw"";e.exports=i.inherits}catch(t){e.exports=n(5717)}},5717:e=>{"function"==typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}}},4970:e=>{"use strict";const t=e=>null!==e&&"object"==typeof e&&"function"==typeof e.pipe;t.writable=e=>t(e)&&!1!==e.writable&&"function"==typeof e._write&&"object"==typeof e._writableState,t.readable=e=>t(e)&&!1!==e.readable&&"function"==typeof e._read&&"object"==typeof e._readableState,t.duplex=e=>t.writable(e)&&t.readable(e),t.transform=e=>t.duplex(e)&&"function"==typeof e._transform,e.exports=t},6281:(e,t,n)=>{"use strict";const i=n(9235);e.exports=i((e=>(e.message=`\t${e.message}`,e)))},153:(e,t,n)=>{"use strict";const{Colorizer:i}=n(8580),{Padder:r}=n(6566),{configs:s,MESSAGE:o}=n(5396);class a{constructor(e={}){e.levels||(e.levels=s.cli.levels),this.colorizer=new i(e),this.padder=new r(e),this.options=e}transform(e,t){return this.colorizer.transform(this.padder.transform(e,t),t),e[o]=`${e.level}:${e.message}`,e}}e.exports=e=>new a(e),e.exports.Format=a},8580:(e,t,n)=>{"use strict";const i=n(3645),{LEVEL:r,MESSAGE:s}=n(5396);i.enabled=!0;const o=/\s+/;class a{constructor(e={}){e.colors&&this.addColors(e.colors),this.options=e}static addColors(e){const t=Object.keys(e).reduce(((t,n)=>(t[n]=o.test(e[n])?e[n].split(o):e[n],t)),{});return a.allColors=Object.assign({},a.allColors||{},t),a.allColors}addColors(e){return a.addColors(e)}colorize(e,t,n){if(void 0===n&&(n=t),!Array.isArray(a.allColors[e]))return i[a.allColors[e]](n);for(let t=0,r=a.allColors[e].length;t<r;t++)n=i[a.allColors[e][t]](n);return n}transform(e,t){return t.all&&"string"==typeof e[s]&&(e[s]=this.colorize(e[r],e.level,e[s])),(t.level||t.all||!t.message)&&(e.level=this.colorize(e[r],e.level)),(t.all||t.message)&&(e.message=this.colorize(e[r],e.level,e.message)),e}}e.exports=e=>new a(e),e.exports.Colorizer=e.exports.Format=a},2390:(e,t,n)=>{"use strict";const i=n(9235);function r(e){if(e.every(s))return t=>{let n=t;for(let t=0;t<e.length;t++)if(n=e[t].transform(n,e[t].options),!n)return!1;return n}}function s(e){if("function"!=typeof e.transform)throw new Error(["No transform function found on format. Did you create a format instance?","const myFormat = format(formatFn);","const instance = myFormat();"].join("\n"));return!0}e.exports=(...e)=>{const t=i(r(e)),n=t();return n.Format=t.Format,n},e.exports.cascade=r},1648:(e,t,n)=>{"use strict";const i=n(9235),{LEVEL:r,MESSAGE:s}=n(5396);e.exports=i(((e,{stack:t})=>{if(e instanceof Error){const n=Object.assign({},e,{level:e.level,[r]:e[r]||e.level,message:e.message,[s]:e[s]||e.message});return t&&(n.stack=e.stack),n}if(!(e.message instanceof Error))return e;const n=e.message;return Object.assign(e,n),e.message=n.message,e[s]=n.message,t&&(e.stack=n.stack),e}))},9235:e=>{"use strict";class t extends Error{constructor(e){super(`Format functions must be synchronous taking a two arguments: (info, opts)\nFound: ${e.toString().split("\n")[0]}\n`),Error.captureStackTrace(this,t)}}e.exports=e=>{if(e.length>2)throw new t(e);function n(e={}){this.options=e}function i(e){return new n(e)}return n.prototype.transform=e,i.Format=n,i}},562:(e,t,n)=>{"use strict";const i=t.format=n(9235);function r(e,t){Object.defineProperty(i,e,{get:()=>t(),configurable:!0})}t.levels=n(7823),r("align",(function(){return n(6281)})),r("errors",(function(){return n(1648)})),r("cli",(function(){return n(153)})),r("combine",(function(){return n(2390)})),r("colorize",(function(){return n(8580)})),r("json",(function(){return n(3922)})),r("label",(function(){return n(3084)})),r("logstash",(function(){return n(3388)})),r("metadata",(function(){return n(2523)})),r("ms",(function(){return n(7560)})),r("padLevels",(function(){return n(6566)})),r("prettyPrint",(function(){return n(5894)})),r("printf",(function(){return n(8242)})),r("simple",(function(){return n(459)})),r("splat",(function(){return n(8102)})),r("timestamp",(function(){return n(6645)})),r("uncolorize",(function(){return n(9095)}))},3922:(e,t,n)=>{"use strict";const i=n(9235),{MESSAGE:r}=n(5396),s=n(7668);function o(e,t){return"bigint"==typeof t?t.toString():t}e.exports=i(((e,t)=>{const n=s.configure(t);return e[r]=n(e,t.replacer||o,t.space),e}))},3084:(e,t,n)=>{"use strict";const i=n(9235);e.exports=i(((e,t)=>t.message?(e.message=`[${t.label}] ${e.message}`,e):(e.label=t.label,e)))},7823:(e,t,n)=>{"use strict";const{Colorizer:i}=n(8580);e.exports=e=>(i.addColors(e.colors||e),e)},3388:(e,t,n)=>{"use strict";const i=n(9235),{MESSAGE:r}=n(5396),s=n(7668);e.exports=i((e=>{const t={};return e.message&&(t["@message"]=e.message,delete e.message),e.timestamp&&(t["@timestamp"]=e.timestamp,delete e.timestamp),t["@fields"]=e,e[r]=s(t),e}))},2523:(e,t,n)=>{"use strict";const i=n(9235);e.exports=i(((e,t={})=>{let n="metadata";t.key&&(n=t.key);let i=[];return t.fillExcept||t.fillWith||(i.push("level"),i.push("message")),t.fillExcept&&(i=t.fillExcept),i.length>0?function(e,t,n){const i=t.reduce(((t,n)=>(t[n]=e[n],delete e[n],t)),{}),r=Object.keys(e).reduce(((t,n)=>(t[n]=e[n],delete e[n],t)),{});return Object.assign(e,i,{[n]:r}),e}(e,i,n):t.fillWith?function(e,t,n){return e[n]=t.reduce(((t,n)=>(t[n]=e[n],delete e[n],t)),{}),e}(e,t.fillWith,n):e}))},7560:function(e,t,n){"use strict";const i=n(9235),r=n(7824);e.exports=i((e=>{const t=+new Date;return this.diff=t-(this.prevTime||t),this.prevTime=t,e.ms=`+${r(this.diff)}`,e}))},6566:(e,t,n)=>{"use strict";const{configs:i,LEVEL:r,MESSAGE:s}=n(5396);class o{constructor(e={levels:i.npm.levels}){this.paddings=o.paddingForLevels(e.levels,e.filler),this.options=e}static getLongestLevel(e){const t=Object.keys(e).map((e=>e.length));return Math.max(...t)}static paddingForLevel(e,t,n){const i=n+1-e.length,r=Math.floor(i/t.length);return`${t}${t.repeat(r)}`.slice(0,i)}static paddingForLevels(e,t=" "){const n=o.getLongestLevel(e);return Object.keys(e).reduce(((e,i)=>(e[i]=o.paddingForLevel(i,t,n),e)),{})}transform(e,t){return e.message=`${this.paddings[e[r]]}${e.message}`,e[s]&&(e[s]=`${this.paddings[e[r]]}${e[s]}`),e}}e.exports=e=>new o(e),e.exports.Padder=e.exports.Format=o},5894:(e,t,n)=>{"use strict";const i=n(3837).inspect,r=n(9235),{LEVEL:s,MESSAGE:o,SPLAT:a}=n(5396);e.exports=r(((e,t={})=>{const n=Object.assign({},e);return delete n[s],delete n[o],delete n[a],e[o]=i(n,!1,t.depth||null,t.colorize),e}))},8242:(e,t,n)=>{"use strict";const{MESSAGE:i}=n(5396);class r{constructor(e){this.template=e}transform(e){return e[i]=this.template(e),e}}e.exports=e=>new r(e),e.exports.Printf=e.exports.Format=r},459:(e,t,n)=>{"use strict";const i=n(9235),{MESSAGE:r}=n(5396),s=n(7668);e.exports=i((e=>{const t=s(Object.assign({},e,{level:void 0,message:void 0,splat:void 0})),n=e.padding&&e.padding[e.level]||"";return e[r]="{}"!==t?`${e.level}:${n} ${e.message} ${t}`:`${e.level}:${n} ${e.message}`,e}))},8102:(e,t,n)=>{"use strict";const i=n(3837),{SPLAT:r}=n(5396),s=/%[scdjifoO%]/g,o=/%%/g;class a{constructor(e){this.options=e}_splat(e,t){const n=e.message,s=e[r]||e.splat||[],a=n.match(o),c=a&&a.length||0,l=t.length-c-s.length,u=l<0?s.splice(l,-1*l):[],h=u.length;if(h)for(let t=0;t<h;t++)Object.assign(e,u[t]);return e.message=i.format(n,...s),e}transform(e){const t=e.message,n=e[r]||e.splat;if(!n||!n.length)return e;const i=t&&t.match&&t.match(s);if(!i&&(n||n.length)){const t=n.length>1?n.splice(0):n,i=t.length;if(i)for(let n=0;n<i;n++)Object.assign(e,t[n]);return e}return i?this._splat(e,i):e}}e.exports=e=>new a(e)},6645:(e,t,n)=>{"use strict";const i=n(9432),r=n(9235);e.exports=r(((e,t={})=>(t.format&&(e.timestamp="function"==typeof t.format?t.format():i.format(new Date,t.format)),e.timestamp||(e.timestamp=(new Date).toISOString()),t.alias&&(e[t.alias]=e.timestamp),e)))},9095:(e,t,n)=>{"use strict";const i=n(3645),r=n(9235),{MESSAGE:s}=n(5396);e.exports=r(((e,t)=>(!1!==t.level&&(e.level=i.strip(e.level)),!1!==t.message&&(e.message=i.strip(String(e.message))),!1!==t.raw&&e[s]&&(e[s]=i.strip(String(e[s]))),e)))},7824:e=>{var t=1e3,n=60*t,i=60*n,r=24*i;function s(e,t,n,i){var r=t>=1.5*n;return Math.round(e/n)+" "+i+(r?"s":"")}e.exports=function(e,o){o=o||{};var a,c,l=typeof e;if("string"===l&&e.length>0)return function(e){if(!((e=String(e)).length>100)){var s=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(s){var o=parseFloat(s[1]);switch((s[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*o;case"weeks":case"week":case"w":return 6048e5*o;case"days":case"day":case"d":return o*r;case"hours":case"hour":case"hrs":case"hr":case"h":return o*i;case"minutes":case"minute":case"mins":case"min":case"m":return o*n;case"seconds":case"second":case"secs":case"sec":case"s":return o*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return o;default:return}}}}(e);if("number"===l&&isFinite(e))return o.long?(a=e,(c=Math.abs(a))>=r?s(a,c,r,"day"):c>=i?s(a,c,i,"hour"):c>=n?s(a,c,n,"minute"):c>=t?s(a,c,t,"second"):a+" ms"):function(e){var s=Math.abs(e);return s>=r?Math.round(e/r)+"d":s>=i?Math.round(e/i)+"h":s>=n?Math.round(e/n)+"m":s>=t?Math.round(e/t)+"s":e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},3437:function(e,t,n){"use strict";var i,r=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.BaseApi=void 0;const s=n(2361),o=Symbol("DO_REQUEST");class a extends s.EventEmitter{constructor({transport:e,data:t,logger:r,metadata:s,client:o}){super(),this[i]=(e,t=[])=>new Promise(((n,i)=>{this.transport.request(e,t,((t,r)=>{this.logger.debug(`response -> neovim.api.${e}: ${r}`),t?i(new Error(`${e}: ${t[1]}`)):n(r)}))})),this.setTransport(e),this.data=t,this.logger=r||n(311).logger,this.client=o,s&&Object.defineProperty(this,"metadata",{value:s})}setTransport(e){this.transport=e}equals(e){try{return String(this.data)===String(e.data)}catch(e){return!1}}asyncRequest(e,t=[],n){return r(this,void 0,void 0,(function*(){return yield this._isReady,this.logger.debug(`request -> neovim.api.${e}`),this[o](e,t).catch((t=>{const i=new Error(t.message);throw i.stack=n,this.logger.error(`Error making request to ${e}`,i),i}))}))}request(e,t=[]){const n=new Error(`Error making request to ${e}`);return this.asyncRequest(e,t,n.stack)}_getArgsByPrefix(...e){const t=[];return"nvim_"!==this.prefix&&t.push(this),t.concat(e)}getVar(e){return r(this,void 0,void 0,(function*(){const t=this._getArgsByPrefix(e);return this.request(`${this.prefix}get_var`,t).then((e=>e),(e=>{if(e&&e.message&&e.message.includes("not found"))return null;throw e}))}))}setVar(e,t){const n=this._getArgsByPrefix(e,t);return this.request(`${this.prefix}set_var`,n)}deleteVar(e){const t=this._getArgsByPrefix(e);return this.request(`${this.prefix}del_var`,t)}getOption(e){const t=this._getArgsByPrefix(e);return this.request(`${this.prefix}get_option`,t)}setOption(e,t){const n=this._getArgsByPrefix(e,t);return this.request(`${this.prefix}set_option`,n)}notify(e,t){this.logger.debug(`notify -> neovim.api.${e}`),this.transport.notify(e,t)}}t.BaseApi=a,i=o},1810:function(e,t,n){"use strict";var i,r,s=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Buffer=t.ATTACH=t.DETACH=void 0;const o=n(3437),a=n(94);t.DETACH=Symbol("detachBuffer"),t.ATTACH=Symbol("attachBuffer");class c extends o.BaseApi{constructor(){super(...arguments),this.prefix=a.Metadata[a.ExtType.Buffer].prefix,this[i]=(e=!1,t={})=>s(this,void 0,void 0,(function*(){return!!this.client.isAttached(this)||this.request(`${this.prefix}attach`,[this,e,t])})),this[r]=()=>this.request(`${this.prefix}detach`,[this])}get isAttached(){return this.client.isAttached(this)}get id(){return this.data}get length(){return this.request(`${this.prefix}line_count`,[this])}get lines(){return this.getLines()}get changedtick(){return this.request(`${this.prefix}get_changedtick`,[this])}get commands(){return this.getCommands()}getCommands(e={}){return this.request(`${this.prefix}get_commands`,[this,e])}getLines({start:e,end:t,strictIndexing:n}={start:0,end:-1,strictIndexing:!0}){const i=void 0===n||n;return this.request(`${this.prefix}get_lines`,[this,e,t,i])}setLines(e,{start:t,end:n,strictIndexing:i}={strictIndexing:!0}){const r=void 0===i||i,s="string"==typeof e?[e]:e,o=void 0!==n?n:t+1;return this.request(`${this.prefix}set_lines`,[this,t,o,r,s])}insert(e,t){return this.setLines(e,{start:t,end:t,strictIndexing:!0})}replace(e,t){const n="string"==typeof e?[e]:e;return this.setLines(n,{start:t,end:t+n.length,strictIndexing:!1})}remove(e,t,n){return this.setLines([],{start:e,end:t,strictIndexing:n})}append(e){return this.setLines(e,{start:-1,end:-1,strictIndexing:!1})}get name(){return this.request(`${this.prefix}get_name`,[this])}set name(e){this.request(`${this.prefix}set_name`,[this,e])}get valid(){return this.request(`${this.prefix}is_valid`,[this])}mark(e){return this.request(`${this.prefix}get_mark`,[this,e])}getKeymap(e){return this.request(`${this.prefix}get_keymap`,[this,e])}get loaded(){return this.request(`${this.prefix}is_loaded`,[this])}getOffset(e){return this.request(`${this.prefix}get_offset`,[this,e])}addHighlight({hlGroup:e,line:t,colStart:n,colEnd:i,srcId:r}){const s=void 0!==e?e:"",o=void 0!==i?i:-1,a=void 0!==n?n:-0,c=void 0!==r?r:-1;return this.request(`${this.prefix}add_highlight`,[this,c,s,t,a,o])}clearHighlight(e={}){console.warn("`clearHighlight` is deprecated, use ``clearNamespace()` instead");const{srcId:t,lineStart:n,lineEnd:i}=Object.assign(Object.assign({},{srcId:-1,lineStart:0,lineEnd:-1}),e);return this.request(`${this.prefix}clear_highlight`,[this,t,n,i])}clearNamespace(e){const{nsId:t,lineStart:n,lineEnd:i}=Object.assign(Object.assign({},{nsId:-1,lineStart:0,lineEnd:-1}),e);this.request(`${this.prefix}clear_namespace`,[this,t,n,i])}setVirtualText(e,t,n,i={}){return this.request(`${this.prefix}set_virtual_text`,[this,e,t,n,i])}listen(e,n){return this.isAttached||this[t.ATTACH]().then((t=>{t||this.unlisten(e,n)})),this.client.attachBuffer(this,e,n),()=>{this.unlisten(e,n)}}unlisten(e,n){this.isAttached&&this.client.detachBuffer(this,e,n)&&this[t.DETACH]()}}t.Buffer=c,i=t.ATTACH,r=t.DETACH},2203:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Neovim=void 0;const i=n(3437),r=n(2348),s=n(1810),o=n(4637),a=n(5720);class c extends i.BaseApi{constructor(){super(...arguments),this.prefix="nvim_",this.Buffer=s.Buffer,this.Window=a.Window,this.Tabpage=o.Tabpage}get apiInfo(){return this.request(`${this.prefix}get_api_info`)}get buffers(){return this.request(`${this.prefix}list_bufs`)}get buffer(){return r.createChainableApi.call(this,"Buffer",s.Buffer,(()=>this.request(`${this.prefix}get_current_buf`)))}set buffer(e){this.request(`${this.prefix}set_current_buf`,[e])}get chans(){return this.request(`${this.prefix}list_chans`)}getChanInfo(e){return this.request(`${this.prefix}get_chan_info`,[e])}get commands(){return this.getCommands()}getCommands(e={}){return this.request(`${this.prefix}get_commands`,[e])}get tabpages(){return this.request(`${this.prefix}list_tabpages`)}get tabpage(){return r.createChainableApi.call(this,"Tabpage",o.Tabpage,(()=>this.request(`${this.prefix}get_current_tabpage`)))}set tabpage(e){this.request(`${this.prefix}set_current_tabpage`,[e])}get windows(){return this.getWindows()}get window(){return this.getWindow()}set window(e){this.setWindow(e)}getWindows(){return this.request(`${this.prefix}list_wins`)}getWindow(){return r.createChainableApi.call(this,"Window",a.Window,(()=>this.request(`${this.prefix}get_current_win`)))}setWindow(e){return this.request(`${this.prefix}set_current_win`,[e])}get runtimePaths(){return this.request(`${this.prefix}list_runtime_paths`)}set dir(e){this.request(`${this.prefix}set_current_dir`,[e])}get line(){return this.getLine()}set line(e){"string"==typeof e&&this.setLine(e)}getLine(){return this.request(`${this.prefix}get_current_line`)}setLine(e){return this.request(`${this.prefix}set_current_line`,[e])}getKeymap(e){return this.request(`${this.prefix}get_keymap`,[e])}get mode(){return this.request(`${this.prefix}get_mode`)}get colorMap(){return this.request(`${this.prefix}get_color_map`)}getColorByName(e){return this.request(`${this.prefix}get_color_by_name`,[e])}getHighlight(e,t=!0){const n="string"==typeof e?"by_name":"by_id";return this.request(`${this.prefix}get_hl_${n}`,[e,t])}getHighlightByName(e,t=!0){return this.request(`${this.prefix}get_hl_by_name`,[e,t])}getHighlightById(e,t=!0){return this.request(`${this.prefix}get_hl_by_id`,[e,t])}deleteCurrentLine(){return this.request(`${this.prefix}del_current_line`)}eval(e){return this.request(`${this.prefix}eval`,[e])}lua(e,t=[]){const n=Array.isArray(t)?t:[t];return this.request(`${this.prefix}execute_lua`,[e,n])}executeLua(e,t=[]){return this.lua(e,t)}callDictFunction(e,t,n=[]){const i=Array.isArray(n)?n:[n];return this.request(`${this.prefix}call_dict_function`,[e,t,i])}call(e,t=[]){const n=Array.isArray(t)?t:[t];return this.request(`${this.prefix}call_function`,[e,n])}callFunction(e,t=[]){return this.call(e,t)}callAtomic(e){return this.request(`${this.prefix}call_atomic`,[e])}command(e){return this.request(`${this.prefix}command`,[e])}commandOutput(e){return this.request(`${this.prefix}command_output`,[e])}getVvar(e){return this.request(`${this.prefix}get_vvar`,[e])}setVvar(e,t){return this.request(`${this.prefix}set_vvar`,[e,t])}feedKeys(e,t,n){return this.request(`${this.prefix}feedkeys`,[e,t,n])}input(e){return this.request(`${this.prefix}input`,[e])}inputMouse(e,t,n,i,r,s){return this.request(`${this.prefix}input_mouse`,[e,t,n,i,r,s])}parseExpression(e,t,n){return this.request(`${this.prefix}parse_expression`,[e,t,n])}getProc(e){return this.request(`${this.prefix}get_proc`,[e])}getProcChildren(e){return this.request(`${this.prefix}get_proc_children`,[e])}replaceTermcodes(e,t,n,i){return this.request(`${this.prefix}replace_termcodes`,[e,t,n,i])}strWidth(e){return this.request(`${this.prefix}strwidth`,[e])}outWrite(e){return this.request(`${this.prefix}out_write`,[e])}outWriteLine(e){return this.outWrite(`${e}\n`)}errWrite(e){return this.request(`${this.prefix}err_write`,[e])}errWriteLine(e){return this.request(`${this.prefix}err_writeln`,[e])}get uis(){return this.request(`${this.prefix}list_uis`)}uiAttach(e,t,n){return this.request(`${this.prefix}ui_attach`,[e,t,n])}uiDetach(){return this.request(`${this.prefix}ui_detach`,[])}uiTryResize(e,t){return this.request(`${this.prefix}ui_try_resize`,[e,t])}uiTryResizeGrid(e,t,n){return this.request(`${this.prefix}ui_try_resize_grid`,[e,t,n])}uiSetOption(e,t){return this.request(`${this.prefix}ui_set_option`,[e,t])}subscribe(e){return this.request(`${this.prefix}subscribe`,[e])}unsubscribe(e){return this.request(`${this.prefix}unsubscribe`,[e])}setClientInfo(e,t,n,i,r){this.request(`${this.prefix}set_client_info`,[e,t,n,i,r])}createNamespace(e=""){return this.request(`${this.prefix}create_namespace`,[e])}get namespaces(){return this.getNamespaces()}getNamespaces(){return this.request(`${this.prefix}get_namespaces`)}selectPopupmenuItem(e,t,n,i={}){return this.request(`${this.prefix}select_popupmenu_item`,[e,t,n,i])}createBuf(e,t){return this.request(`${this.prefix}create_buf`,[e,t])}createBuffer(e,t){return this.createBuf(e,t)}openWin(e,t,n){return this.request(`${this.prefix}open_win`,[e,t,n])}openWindow(e,t,n){return this.openWin(e,t,n)}winConfig(e,t={}){return e.config(t)}windowConfig(e,t={}){return this.winConfig(e,t)}winClose(e,t){return e.close(t)}windowClose(e,t){return this.winClose(e,t)}quit(){this.command("qa!")}}t.Neovim=c},4637:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Tabpage=void 0;const i=n(3437),r=n(94),s=n(2348),o=n(5720);class a extends i.BaseApi{constructor(){super(...arguments),this.prefix=r.Metadata[r.ExtType.Tabpage].prefix}get windows(){return this.request(`${this.prefix}list_wins`,[this])}get window(){return s.createChainableApi.call(this,"Window",o.Window,(()=>this.request(`${this.prefix}get_win`,[this])))}get valid(){return this.request(`${this.prefix}is_valid`,[this])}get number(){return this.request(`${this.prefix}get_number`,[this])}getOption(){this.logger.error("Tabpage does not have `getOption`")}setOption(){this.logger.error("Tabpage does not have `setOption`")}}t.Tabpage=a},5720:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Window=void 0;const i=n(3437),r=n(94),s=n(2348),o=n(4637),a=n(1810);class c extends i.BaseApi{constructor(){super(...arguments),this.prefix=r.Metadata[r.ExtType.Window].prefix}get id(){return this.data}get buffer(){return s.createChainableApi.call(this,"Buffer",a.Buffer,(()=>this.request(`${this.prefix}get_buf`,[this])))}get tabpage(){return s.createChainableApi.call(this,"Tabpage",o.Tabpage,(()=>this.request(`${this.prefix}get_tabpage`,[this])))}get cursor(){return this.request(`${this.prefix}get_cursor`,[this])}set cursor(e){this.request(`${this.prefix}set_cursor`,[this,e])}get height(){return this.request(`${this.prefix}get_height`,[this])}set height(e){this.request(`${this.prefix}set_height`,[this,e])}get width(){return this.request(`${this.prefix}get_width`,[this])}set width(e){this.request(`${this.prefix}set_width`,[this,e])}get position(){return this.request(`${this.prefix}get_position`,[this])}get row(){return this.request(`${this.prefix}get_position`,[this]).then((e=>e[0]))}get col(){return this.request(`${this.prefix}get_position`,[this]).then((e=>e[1]))}get valid(){return this.request(`${this.prefix}is_valid`,[this])}get number(){return this.request(`${this.prefix}get_number`,[this])}close(e=!1){return this.request(`${this.prefix}close`,[this,e])}config(e={}){return this.request(`${this.prefix}set_config`,[this,e])}}t.Window=c},4606:function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.NeovimClient=void 0;const r=n(138),s=n(2203);class o extends s.Neovim{constructor(e={}){super({logger:e.logger}),this.attachedBuffers=new Map;const t=e.transport||new r.Transport;this.setTransport(t),this.requestQueue=[],this.transportAttached=!1,this.handleRequest=this.handleRequest.bind(this),this.handleNotification=this.handleNotification.bind(this)}attach({reader:e,writer:t}){this.transport.attach(t,e,this),this.transportAttached=!0,this.setupTransport()}get isApiReady(){return this.transportAttached&&void 0!==this._channelId}get channelId(){return(()=>i(this,void 0,void 0,(function*(){return yield this._isReady,this._channelId})))()}isAttached(e){const t=`${e.data}`;return this.attachedBuffers.has(t)}handleRequest(e,t,n,...i){this.logger.info("handleRequest: ",e),this.isApiReady||"specs"===e?this.emit("request",e,t,n):this.requestQueue.push({type:"request",args:[e,t,n,...i]})}emitNotification(e,t){if(e.endsWith("_event")){if(!e.startsWith("nvim_buf_"))return void this.logger.error("Unhandled event: ",e);const n=e.replace(/nvim_buf_(.*)_event/,"$1"),[i]=t,r=`${i.data}`;if(!this.attachedBuffers.has(r))return;(this.attachedBuffers.get(r).get(n)||[]).forEach((e=>e(...t))),"detach"===n&&this.attachedBuffers.delete(r)}else this.emit("notification",e,t)}handleNotification(e,t,...n){this.logger.info("handleNotification: ",e),this.isApiReady?this.emitNotification(e,t):this.requestQueue.push({type:"notification",args:[e,t,...n]})}setupTransport(){if(!this.transportAttached)throw new Error("Not attached to input/output");this.transport.on("request",this.handleRequest),this.transport.on("notification",this.handleNotification),this.transport.on("detach",(()=>{this.emit("disconnect"),this.transport.removeAllListeners("request"),this.transport.removeAllListeners("notification"),this.transport.removeAllListeners("detach")})),this._isReady=this.generateApi()}requestApi(){return new Promise(((e,t)=>{this.transport.request("nvim_get_api_info",[],((n,i)=>{n?t(n):e(i)}))}))}generateApi(){return i(this,void 0,void 0,(function*(){let e;try{e=yield this.requestApi()}catch(e){this.logger.error("Could not get vim api results"),this.logger.error(e)}if(e)try{const[t]=e;return this._channelId=t,this.requestQueue.forEach((e=>{"notification"===e.type?this.emitNotification(e.args[0],e.args[1]):this.emit(e.type,...e.args)})),this.requestQueue=[],!0}catch(e){return this.logger.error(`Could not dynamically generate neovim API: ${e}`,{error:e}),this.logger.error(e.stack),null}return null}))}attachBuffer(e,t,n){const i=`${e.data}`;this.attachedBuffers.has(i)||this.attachedBuffers.set(i,new Map);const r=this.attachedBuffers.get(i);r.get(t)||r.set(t,[]);const s=r.get(t);return-1!==s.indexOf(n)||(s.push(n),r.set(t,s),this.attachedBuffers.set(i,r)),n}detachBuffer(e,t,n){const i=`${e.data}`,r=this.attachedBuffers.get(i);if(!r)return!1;const s=(r.get(t)||[]).filter((e=>e!==n));return s.length?r.set(t,s):r.delete(t),!r.size&&(this.attachedBuffers.delete(i),!0)}}t.NeovimClient=o},2348:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createChainableApi=void 0;const i=n(3437),r=Object.getOwnPropertyNames(i.BaseApi.prototype);t.createChainableApi=function(e,t,n,s){if(this[`${e}Promise`]&&0===this[`${e}Promise`].status&&this[`${e}Proxy`])return this[`${e}Proxy`];this[`${e}Promise`]=n(),[...r,...Object.getOwnPropertyNames(t.prototype)].forEach((t=>{Object.defineProperty(this[`${e}Promise`],t,{enumerable:!0,writable:!0,configurable:!0})}));const o={get:(n,r)=>{const o=Object.prototype.hasOwnProperty.call(t.prototype,r)||Object.prototype.hasOwnProperty.call(i.BaseApi.prototype,r),a=Object.getOwnPropertyDescriptor(t.prototype,r)||Object.getOwnPropertyDescriptor(i.BaseApi.prototype,r),c=a&&(void 0!==a.get||void 0!==a.set);return t&&o?o&&!c&&(r in t.prototype&&"function"==typeof t.prototype[r]||r in i.BaseApi.prototype&&"function"==typeof i.BaseApi.prototype[r])?(...t)=>this[`${e}Promise`].then((e=>e[r].call(e,...t))):s&&s()||this[`${e}Promise`].then((e=>e[r])):r in n?"function"==typeof n[r]?n[r].bind(n):n[r]:null},set:(e,t,n,i)=>(i&&(i instanceof Promise||"then"in i)?i.then((e=>{t in e&&(e[t]=n)})):e[t]=n,!0)};return this[`${e}Proxy`]=new Proxy(this[`${e}Promise`],o),this[`${e}Proxy`]}},6017:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Tabpage=t.Window=t.Buffer=t.NeovimClient=t.Neovim=void 0;var i=n(2203);Object.defineProperty(t,"Neovim",{enumerable:!0,get:function(){return i.Neovim}});var r=n(4606);Object.defineProperty(t,"NeovimClient",{enumerable:!0,get:function(){return r.NeovimClient}});var s=n(1810);Object.defineProperty(t,"Buffer",{enumerable:!0,get:function(){return s.Buffer}});var o=n(5720);Object.defineProperty(t,"Window",{enumerable:!0,get:function(){return o.Window}});var a=n(4637);Object.defineProperty(t,"Tabpage",{enumerable:!0,get:function(){return a.Tabpage}})},94:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Metadata=t.ExtType=void 0;const i=n(1810),r=n(5720),s=n(4637);var o;(o=t.ExtType||(t.ExtType={}))[o.Buffer=0]="Buffer",o[o.Window=1]="Window",o[o.Tabpage=2]="Tabpage",t.Metadata=[{constructor:i.Buffer,name:"Buffer",prefix:"nvim_buf_"},{constructor:r.Window,name:"Window",prefix:"nvim_win_"},{constructor:s.Tabpage,name:"Tabpage",prefix:"nvim_tabpage_"}]},3286:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.attach=void 0;var i=n(1291);Object.defineProperty(t,"attach",{enumerable:!0,get:function(){return i.attach}})},1291:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.attach=void 0;const i=n(1808),r=n(4606);t.attach=function({reader:e,writer:t,proc:s,socket:o,options:a={}}){let c,l;if(o){const e=(0,i.createConnection)(o);c=e,l=e}else e&&t?(c=t,l=e):s&&(c=s.stdin,l=s.stdout);if(c&&l){const e=a.logger||n(311).logger,t=new r.NeovimClient({logger:e});return t.attach({writer:c,reader:l}),t}throw new Error("Invalid arguments, could not attach")}},3596:function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.NvimPlugin=t.callable=void 0;const r=n(311);function s(e){if("function"==typeof e)return e;if(Array.isArray(e)&&2===e.length)return function(...t){return e[1].apply(e[0],t)};throw new Error}t.callable=s,t.NvimPlugin=class{constructor(e,t,n){this.filename=e,this.nvim=n,this.dev=!1,this.alwaysInit=!1,this.autocmds={},this.commands={},this.functions={};try{this.instance=new t(this)}catch(e){if(!(e instanceof TypeError))throw e;this.instance=t(this)}}setOptions(e){this.dev=void 0===e.dev?this.dev:e.dev,this.alwaysInit=e.alwaysInit}get shouldCacheModule(){return!this.dev}registerAutocmd(e,t,n){if(!n.pattern)return void r.logger.error(`registerAutocmd expected pattern option for ${e}`);const i={type:"autocmd",name:e,sync:n&&!!n.sync,opts:{}};["pattern","eval"].forEach((e=>{n&&void 0!==n[e]&&(i.opts[e]=n[e])}));try{this.autocmds[`${e} ${n.pattern}`]={fn:s(t),spec:i}}catch(t){r.logger.error(`registerAutocmd expected callable argument for ${e}`)}}registerCommand(e,t,n){const i={type:"command",name:e,sync:n&&!!n.sync,opts:{}};["range","nargs","complete"].forEach((e=>{n&&void 0!==n[e]&&(i.opts[e]=n[e])}));try{this.commands[e]={fn:s(t),spec:i}}catch(t){r.logger.error(`registerCommand expected callable argument for ${e}`)}}registerFunction(e,t,n){const i={type:"function",name:e,sync:n&&!!n.sync,opts:{}};["range","eval"].forEach((e=>{n&&void 0!==n[e]&&(i.opts[e]=n[e])}));try{this.functions[e]={fn:s(t),spec:i}}catch(t){r.logger.error(`registerFunction expected callable argument for ${e}`)}}get specs(){const e=Object.keys(this.autocmds).map((e=>this.autocmds[e].spec)),t=Object.keys(this.commands).map((e=>this.commands[e].spec)),n=Object.keys(this.functions).map((e=>this.functions[e].spec));return e.concat(t).concat(n)}handleRequest(e,t,n){return i(this,void 0,void 0,(function*(){let i;switch(t){case"autocmd":i=this.autocmds;break;case"command":i=this.commands;break;case"function":i=this.functions;break;default:const n=`No handler for unknown type ${t}: "${e}" in ${this.filename}`;throw r.logger.error(n),new Error(n)}if(!i.hasOwnProperty(e)){const n=`Missing handler for ${t}: "${e}" in ${this.filename}`;throw r.logger.error(n),new Error(n)}{const s=i[e];try{return s.spec.sync?s.fn(...n):yield s.fn(...n)}catch(n){const i=`Error in plugin for ${t}:${e}: ${n.message}`;throw r.logger.error(`${i} (file: ${this.filename}, stack: ${n.stack})`),new Error(n)}}}))}}},7570:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return r(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.loadPlugin=void 0;const o=s(n(1017)),a=n(8188),c=n(311),l=n(3596);t.loadPlugin=function(e,t,i={}){try{return function(e,t,i={}){try{if(c.logger.debug(`createPlugin.${e}.clearCache: ${i&&!i.cache}`),i&&!i.cache)try{delete a._cache[n(9071).resolve(e)]}catch(e){}const r=n(9071)(e),s=r&&r.default||r;if("function"==typeof s)return new l.NvimPlugin(e,s,t)}catch(t){const n=o.basename(e);c.logger.error(`[${n}] ${t.stack}`),c.logger.error(`[${n}] Error loading child ChildPlugin ${e}`)}return null}(e,t,i)}catch(e){return null}}},9071:e=>{function t(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=9071,e.exports=t},9562:(e,t,n)=>{"use strict";t.ub=void 0;var i=n(3286);Object.defineProperty(t,"ub",{enumerable:!0,get:function(){return i.attach}});n(6017),n(1114),n(3596),n(7570)},1114:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Command=t.Autocmd=t.Function=t.Plugin=void 0;var i=n(9111);Object.defineProperty(t,"Plugin",{enumerable:!0,get:function(){return i.Plugin}}),Object.defineProperty(t,"Function",{enumerable:!0,get:function(){return i.Function}}),Object.defineProperty(t,"Autocmd",{enumerable:!0,get:function(){return i.Autocmd}}),Object.defineProperty(t,"Command",{enumerable:!0,get:function(){return i.Command}})},9155:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.autocmd=void 0;const i=n(5042);t.autocmd=function(e,t){return function(n,r){const s=t&&!!t.sync,o="string"==typeof r,a=o?n[r]:n,c={pattern:""};["pattern","eval"].forEach((e=>{t&&void 0!==t[e]&&(c[e]=t[e])}));const l=`${e}${t.pattern?`:${t.pattern}`:""}`;return Object.defineProperty(a,i.NVIM_METHOD_NAME,{value:`autocmd:${l}`}),Object.defineProperty(a,i.NVIM_SYNC,{value:!!s}),Object.defineProperty(a,i.NVIM_SPEC,{value:{type:"autocmd",name:e,sync:!!s,opts:c}}),o&&(n[r]=a),n}}},7856:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.command=void 0;const i=n(5042);t.command=function(e,t){return function(n,r){const s=t&&!!t.sync,o="string"==typeof r,a=o?n[r]:n,c={};return["range","nargs","complete"].forEach((e=>{t&&void 0!==t[e]&&(c[e]=t[e])})),Object.defineProperty(a,i.NVIM_METHOD_NAME,{value:`command:${e}`}),Object.defineProperty(a,i.NVIM_SYNC,{value:!!s}),Object.defineProperty(a,i.NVIM_SPEC,{value:{type:"command",name:e,sync:!!s,opts:c}}),o&&(n[r]=a),n}}},3936:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.nvimFunction=void 0;const i=n(5042);t.nvimFunction=function(e,t={}){return function(n,r){const s=t&&!!t.sync,o="string"==typeof r,a=o?n[r]:n,c={};return t&&t.range&&(c.range=t.range),t&&t.eval&&(c.eval=t.eval),Object.defineProperty(a,i.NVIM_METHOD_NAME,{value:`function:${e}`}),Object.defineProperty(a,i.NVIM_SYNC,{value:!!s}),Object.defineProperty(a,i.NVIM_SPEC,{value:{type:"function",name:e,sync:!!s,opts:c}}),o&&(n[r]=a),n}}},9111:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Command=t.Autocmd=t.Function=t.Plugin=void 0;var i=n(8772);Object.defineProperty(t,"Plugin",{enumerable:!0,get:function(){return i.plugin}});var r=n(3936);Object.defineProperty(t,"Function",{enumerable:!0,get:function(){return r.nvimFunction}});var s=n(9155);Object.defineProperty(t,"Autocmd",{enumerable:!0,get:function(){return s.autocmd}});var o=n(7856);Object.defineProperty(t,"Command",{enumerable:!0,get:function(){return o.command}})},8772:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.plugin=t.NvimPlugin=t.Neovim=void 0;const i=n(311),r=n(5042),s=n(2203);Object.defineProperty(t,"Neovim",{enumerable:!0,get:function(){return s.Neovim}});const o=n(3596);function a(e,t){return i.logger.info(`Decorating class ${e}`),class extends e{constructor(...n){const s=n[0];super(s.nvim,s),this.setApi(s.nvim),t&&s.setOptions(t),Object.getOwnPropertyNames(e.prototype).forEach((t=>{i.logger.info(`Method name ${t}`),i.logger.info(`${e.prototype[t]} ${typeof e.prototype[t]}`),i.logger.info(`${this} ${typeof this}`);const n=e.prototype[t];if(n&&n[r.NVIM_SPEC]){const e=n[r.NVIM_SPEC];switch(e.type){case"autocmd":const t={pattern:e.opts.pattern,sync:e.sync};void 0!==e.opts.eval&&(t.eval=e.opts.eval),s.registerAutocmd(e.name,[this,n],t);break;case"command":const i={sync:e.sync};void 0!==e.opts.range&&(i.range=e.opts.range),void 0!==e.opts.nargs&&(i.nargs=e.opts.nargs),void 0!==e.opts.complete&&(i.complete=e.opts.complete),s.registerCommand(e.name,[this,n],i);break;case"function":const r={sync:e.sync};void 0!==e.opts.range&&(r.range=e.opts.range),void 0!==e.opts.eval&&(r.eval=e.opts.eval),s.registerFunction(e.name,[this,n],r)}}}))}setApi(e){this.nvim=e}}}Object.defineProperty(t,"NvimPlugin",{enumerable:!0,get:function(){return o.NvimPlugin}}),t.plugin=function(e){return"function"!=typeof e?t=>a(t,e):a(e)}},5042:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NVIM_METHOD_NAME=t.NVIM_SYNC=t.NVIM_SPEC=t.NVIM_DEV_MODE=t.NVIM_PLUGIN=void 0,t.NVIM_PLUGIN="_nvim_plugin",t.NVIM_DEV_MODE="_nvim_dev_mode",t.NVIM_SPEC="_nvim_rpc_spec",t.NVIM_SYNC="_nvim_rpc_sync",t.NVIM_METHOD_NAME="_nvim_rpc_method_name"},311:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return r(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.logger=void 0;const o=s(n(1440)),a="error";t.logger=function(){const e=o.createLogger({level:a});return process.env.NVIM_NODE_LOG_FILE&&e.add(new o.transports.File({filename:process.env.NVIM_NODE_LOG_FILE,level:a})),e.add(new o.transports.Console({format:o.format.simple()})),process.env.NVIM_NODE_LOG_FILE,e}()},138:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Transport=void 0;const i=n(2361),r=n(9676),s=n(94);class o{constructor(e,t){this.encoder=e,this.requestId=t}send(e,t){if(this.sent)throw new Error(`Response to id ${this.requestId} already sent`);const n=(0,r.encode)([1,this.requestId,t?e:null,t?null:e]);this.encoder.write(Buffer.from(n.buffer,n.byteOffset,n.byteLength)),this.sent=!0}}class a extends i.EventEmitter{constructor(){super(...arguments),this.pending=new Map,this.nextRequestId=1,this.extensionCodec=this.initializeExtensionCodec()}initializeExtensionCodec(){const e=new r.ExtensionCodec;return s.Metadata.forEach((({constructor:t},n)=>{e.register({type:n,encode:e=>e instanceof t?(0,r.encode)(e.data):null,decode:e=>new t({transport:this,client:this.client,data:(0,r.decode)(e)})})})),e}encodeToBuffer(e){const t=(0,r.encode)(e,{extensionCodec:this.extensionCodec});return Buffer.from(t.buffer,t.byteOffset,t.byteLength)}attach(e,t,n){this.writer=e,this.reader=t,this.client=n,this.reader.on("end",(()=>{this.emit("detach")}));const i=(0,r.decodeMultiStream)(this.reader,{extensionCodec:this.extensionCodec}),s=e=>{e.next().then((t=>t.done?Promise.resolve():(this.parseMessage(t.value),s(e))))};s(i)}request(e,t,n){this.nextRequestId=this.nextRequestId+1,this.writer.write(this.encodeToBuffer([0,this.nextRequestId,e,t])),this.pending.set(this.nextRequestId,n)}notify(e,t){this.writer.write(this.encodeToBuffer([2,e,t]))}parseMessage(e){const t=e[0];if(0===t)this.emit("request",e[2].toString(),e[3],new o(this.writer,e[1]));else if(1===t){const t=e[1],n=this.pending.get(t);this.pending.delete(t),n(e[2],e[3])}else 2===t?this.emit("notification",e[1].toString(),e[2]):this.writer.write(this.encodeToBuffer([1,0,"Invalid message type",null]))}}t.Transport=a},3138:(e,t,n)=>{"use strict";var i=n(2296);e.exports=function(e){var t,n=0;function r(){return n||(n=1,t=e.apply(this,arguments),e=null),t}return r.displayName=i(e),r}},7668:(e,t)=>{"use strict";const n=g();n.configure=g,n.stringify=n,n.default=n,t.stringify=n,t.configure=g,e.exports=n;const i=/[\u0000-\u001f\u0022\u005c\ud800-\udfff]|[\ud800-\udbff](?![\udc00-\udfff])|(?:[^\ud800-\udbff]|^)[\udc00-\udfff]/,r=/[\u0000-\u001f\u0022\u005c\ud800-\udfff]|[\ud800-\udbff](?![\udc00-\udfff])|(?:[^\ud800-\udbff]|^)[\udc00-\udfff]/g,s=["\\u0000","\\u0001","\\u0002","\\u0003","\\u0004","\\u0005","\\u0006","\\u0007","\\b","\\t","\\n","\\u000b","\\f","\\r","\\u000e","\\u000f","\\u0010","\\u0011","\\u0012","\\u0013","\\u0014","\\u0015","\\u0016","\\u0017","\\u0018","\\u0019","\\u001a","\\u001b","\\u001c","\\u001d","\\u001e","\\u001f","","",'\\"',"","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","\\\\"];function o(e){if(2===e.length){const t=e.charCodeAt(1);return`${e[0]}\\u${t.toString(16)}`}const t=e.charCodeAt(0);return s.length>t?s[t]:`\\u${t.toString(16)}`}function a(e){if(e.length<5e3&&!i.test(e))return e;if(e.length>100)return e.replace(r,o);let t="",n=0;for(let i=0;i<e.length;i++){const r=e.charCodeAt(i);if(34===r||92===r||r<32)t+=`${e.slice(n,i)}${s[r]}`,n=i+1;else if(r>=55296&&r<=57343){if(r<=56319&&i+1<e.length){const t=e.charCodeAt(i+1);if(t>=56320&&t<=57343){i++;continue}}t+=`${e.slice(n,i)}\\u${r.toString(16)}`,n=i+1}}return t+=e.slice(n),t}function c(e){if(e.length>200)return e.sort();for(let t=1;t<e.length;t++){const n=e[t];let i=t;for(;0!==i&&e[i-1]>n;)e[i]=e[i-1],i--;e[i]=n}return e}const l=Object.getOwnPropertyDescriptor(Object.getPrototypeOf(Object.getPrototypeOf(new Uint8Array)),Symbol.toStringTag).get;function u(e){return void 0!==l.call(e)&&0!==e.length}function h(e,t,n){e.length<n&&(n=e.length);const i=","===t?"":" ";let r=`"0":${i}${e[0]}`;for(let s=1;s<n;s++)r+=`${t}"${s}":${i}${e[s]}`;return r}function d(e,t){if(e&&Object.prototype.hasOwnProperty.call(e,t)){var n=e[t];if("boolean"!=typeof n)throw new TypeError(`The "${t}" argument must be of type boolean`)}return void 0===n||n}function f(e,t){if(e&&Object.prototype.hasOwnProperty.call(e,t)){var n=e[t];if("number"!=typeof n)throw new TypeError(`The "${t}" argument must be of type number`);if(!Number.isInteger(n))throw new TypeError(`The "${t}" argument must be an integer`);if(n<1)throw new RangeError(`The "${t}" argument must be >= 1`)}return void 0===n?1/0:n}function p(e){return 1===e?"1 item":`${e} items`}function g(e){const t=function(e){if(e&&Object.prototype.hasOwnProperty.call(e,"circularValue")){var t=e.circularValue;if("string"==typeof t)return`"${t}"`;if(null==t)return t;if(t===Error||t===TypeError)return{toString(){throw new TypeError("Converting circular structure to JSON")}};throw new TypeError('The "circularValue" argument must be of type string or the value null or undefined')}return'"[Circular]"'}(e),n=d(e,"bigint"),i=d(e,"deterministic"),r=f(e,"maximumDepth"),s=f(e,"maximumBreadth");function o(e,l,d,f,g,m){let v=l[e];switch("object"==typeof v&&null!==v&&"function"==typeof v.toJSON&&(v=v.toJSON(e)),v=f.call(l,e,v),typeof v){case"string":return`"${a(v)}"`;case"object":{if(null===v)return"null";if(-1!==d.indexOf(v))return t;let e="",n=",";const l=m;if(Array.isArray(v)){if(0===v.length)return"[]";if(r<d.length+1)return'"[Array]"';d.push(v),""!==g&&(e+=`\n${m+=g}`,n=`,\n${m}`);const t=Math.min(v.length,s);let i=0;for(;i<t-1;i++){const t=o(i,v,d,f,g,m);e+=void 0!==t?t:"null",e+=n}const a=o(i,v,d,f,g,m);return e+=void 0!==a?a:"null",v.length-1>s&&(e+=`${n}"... ${p(v.length-s-1)} not stringified"`),""!==g&&(e+=`\n${l}`),d.pop(),`[${e}]`}let b=Object.keys(v);const y=b.length;if(0===y)return"{}";if(r<d.length+1)return'"[Object]"';let w="",_="";""!==g&&(n=`,\n${m+=g}`,w=" ");let x=Math.min(y,s);u(v)&&(e+=h(v,n,s),b=b.slice(v.length),x-=v.length,_=n),i&&(b=c(b)),d.push(v);for(let t=0;t<x;t++){const i=b[t],r=o(i,v,d,f,g,m);void 0!==r&&(e+=`${_}"${a(i)}":${w}${r}`,_=n)}return y>s&&(e+=`${_}"...":${w}"${p(y-s)} not stringified"`,_=n),""!==g&&_.length>1&&(e=`\n${m}${e}\n${l}`),d.pop(),`{${e}}`}case"number":return isFinite(v)?String(v):"null";case"boolean":return!0===v?"true":"false";case"bigint":return n?String(v):void 0}}function l(e,i,o,c,u,h){switch("object"==typeof i&&null!==i&&"function"==typeof i.toJSON&&(i=i.toJSON(e)),typeof i){case"string":return`"${a(i)}"`;case"object":{if(null===i)return"null";if(-1!==o.indexOf(i))return t;const e=h;let n="",d=",";if(Array.isArray(i)){if(0===i.length)return"[]";if(r<o.length+1)return'"[Array]"';o.push(i),""!==u&&(n+=`\n${h+=u}`,d=`,\n${h}`);const t=Math.min(i.length,s);let a=0;for(;a<t-1;a++){const e=l(a,i[a],o,c,u,h);n+=void 0!==e?e:"null",n+=d}const f=l(a,i[a],o,c,u,h);return n+=void 0!==f?f:"null",i.length-1>s&&(n+=`${d}"... ${p(i.length-s-1)} not stringified"`),""!==u&&(n+=`\n${e}`),o.pop(),`[${n}]`}if(0===c.size)return"{}";o.push(i);let f="";""!==u&&(d=`,\n${h+=u}`,f=" ");let g="";for(const e of c){const t=l(e,i[e],o,c,u,h);void 0!==t&&(n+=`${g}"${a(e)}":${f}${t}`,g=d)}return""!==u&&g.length>1&&(n=`\n${h}${n}\n${e}`),o.pop(),`{${n}}`}case"number":return isFinite(i)?String(i):"null";case"boolean":return!0===i?"true":"false";case"bigint":return n?String(i):void 0}}function g(e,o,l,d,f){switch(typeof o){case"string":return`"${a(o)}"`;case"object":{if(null===o)return"null";if("function"==typeof o.toJSON){if("object"!=typeof(o=o.toJSON(e)))return g(e,o,l,d,f);if(null===o)return"null"}if(-1!==l.indexOf(o))return t;const n=f;if(Array.isArray(o)){if(0===o.length)return"[]";if(r<l.length+1)return'"[Array]"';l.push(o);let e=`\n${f+=d}`;const t=`,\n${f}`,i=Math.min(o.length,s);let a=0;for(;a<i-1;a++){const n=g(a,o[a],l,d,f);e+=void 0!==n?n:"null",e+=t}const c=g(a,o[a],l,d,f);return e+=void 0!==c?c:"null",o.length-1>s&&(e+=`${t}"... ${p(o.length-s-1)} not stringified"`),e+=`\n${n}`,l.pop(),`[${e}]`}let m=Object.keys(o);const v=m.length;if(0===v)return"{}";if(r<l.length+1)return'"[Object]"';const b=`,\n${f+=d}`;let y="",w="",_=Math.min(v,s);u(o)&&(y+=h(o,b,s),m=m.slice(o.length),_-=o.length,w=b),i&&(m=c(m)),l.push(o);for(let e=0;e<_;e++){const t=m[e],n=g(t,o[t],l,d,f);void 0!==n&&(y+=`${w}"${a(t)}": ${n}`,w=b)}return v>s&&(y+=`${w}"...": "${p(v-s)} not stringified"`,w=b),""!==w&&(y=`\n${f}${y}\n${n}`),l.pop(),`{${y}}`}case"number":return isFinite(o)?String(o):"null";case"boolean":return!0===o?"true":"false";case"bigint":return n?String(o):void 0}}function m(e,o,l){switch(typeof o){case"string":return`"${a(o)}"`;case"object":{if(null===o)return"null";if("function"==typeof o.toJSON){if("object"!=typeof(o=o.toJSON(e)))return m(e,o,l);if(null===o)return"null"}if(-1!==l.indexOf(o))return t;let n="";if(Array.isArray(o)){if(0===o.length)return"[]";if(r<l.length+1)return'"[Array]"';l.push(o);const e=Math.min(o.length,s);let t=0;for(;t<e-1;t++){const e=m(t,o[t],l);n+=void 0!==e?e:"null",n+=","}const i=m(t,o[t],l);return n+=void 0!==i?i:"null",o.length-1>s&&(n+=`,"... ${p(o.length-s-1)} not stringified"`),l.pop(),`[${n}]`}let d=Object.keys(o);const f=d.length;if(0===f)return"{}";if(r<l.length+1)return'"[Object]"';let g="",v=Math.min(f,s);u(o)&&(n+=h(o,",",s),d=d.slice(o.length),v-=o.length,g=","),i&&(d=c(d)),l.push(o);for(let e=0;e<v;e++){const t=d[e],i=m(t,o[t],l);void 0!==i&&(n+=`${g}"${a(t)}":${i}`,g=",")}return f>s&&(n+=`${g}"...":"${p(f-s)} not stringified"`),l.pop(),`{${n}}`}case"number":return isFinite(o)?String(o):"null";case"boolean":return!0===o?"true":"false";case"bigint":return n?String(o):void 0}}return function(e,t,n){if(arguments.length>1){let i="";if("number"==typeof n?i=" ".repeat(Math.min(n,10)):"string"==typeof n&&(i=n.slice(0,10)),null!=t){if("function"==typeof t)return o("",{"":e},[],t,i,"");if(Array.isArray(t))return l("",e,[],function(e){const t=new Set;for(const n of e)"string"==typeof n?t.add(n):"number"==typeof n&&t.add(String(n));return t}(t),i,"")}if(0!==i.length)return g("",e,[],i,"")}return m("",e,[])}}},7911:(e,t)=>{function n(e){for(var t in e)this[t]=e[t]}t.get=function(e){var n=Error.stackTraceLimit;Error.stackTraceLimit=1/0;var i={},r=Error.prepareStackTrace;Error.prepareStackTrace=function(e,t){return t},Error.captureStackTrace(i,e||t.get);var s=i.stack;return Error.prepareStackTrace=r,Error.stackTraceLimit=n,s},t.parse=function(e){if(!e.stack)return[];var t=this;return e.stack.split("\n").slice(1).map((function(e){if(e.match(/^\s*[-]{4,}$/))return t._createParsedCallSite({fileName:e,lineNumber:null,functionName:null,typeName:null,methodName:null,columnNumber:null,native:null});var n=e.match(/at (?:(.+)\s+\()?(?:(.+?):(\d+)(?::(\d+))?|([^)]+))\)?/);if(n){var i=null,r=null,s=null,o=null,a=null,c="native"===n[5];if(n[1]){var l=(s=n[1]).lastIndexOf(".");if("."==s[l-1]&&l--,l>0){i=s.substr(0,l),r=s.substr(l+1);var u=i.indexOf(".Module");u>0&&(s=s.substr(u+1),i=i.substr(0,u))}o=null}r&&(o=i,a=r),"<anonymous>"===r&&(a=null,s=null);var h={fileName:n[2]||null,lineNumber:parseInt(n[3],10)||null,functionName:s,typeName:o,methodName:a,columnNumber:parseInt(n[4],10)||null,native:c};return t._createParsedCallSite(h)}})).filter((function(e){return!!e}))},["this","typeName","functionName","methodName","fileName","lineNumber","columnNumber","function","evalOrigin"].forEach((function(e){n.prototype[e]=null,n.prototype["get"+e[0].toUpperCase()+e.substr(1)]=function(){return this[e]}})),["topLevel","eval","native","constructor"].forEach((function(e){n.prototype[e]=!1,n.prototype["is"+e[0].toUpperCase()+e.substr(1)]=function(){return this[e]}})),t._createParsedCallSite=function(e){return new n(e)}},2553:(e,t,n)=>{"use strict";var i=n(396).Buffer,r=i.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function s(e){var t;switch(this.encoding=function(e){var t=function(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}(e);if("string"!=typeof t&&(i.isEncoding===r||!r(e)))throw new Error("Unknown encoding: "+e);return t||e}(e),this.encoding){case"utf16le":this.text=c,this.end=l,t=4;break;case"utf8":this.fillLast=a,t=4;break;case"base64":this.text=u,this.end=h,t=3;break;default:return this.write=d,void(this.end=f)}this.lastNeed=0,this.lastTotal=0,this.lastChar=i.allocUnsafe(t)}function o(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function a(e){var t=this.lastTotal-this.lastNeed,n=function(e,t,n){if(128!=(192&t[0]))return e.lastNeed=0,"�";if(e.lastNeed>1&&t.length>1){if(128!=(192&t[1]))return e.lastNeed=1,"�";if(e.lastNeed>2&&t.length>2&&128!=(192&t[2]))return e.lastNeed=2,"�"}}(this,e);return void 0!==n?n:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length))}function c(e,t){if((e.length-t)%2==0){var n=e.toString("utf16le",t);if(n){var i=n.charCodeAt(n.length-1);if(i>=55296&&i<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],n.slice(0,-1)}return n}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function l(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var n=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,n)}return t}function u(e,t){var n=(e.length-t)%3;return 0===n?e.toString("base64",t):(this.lastNeed=3-n,this.lastTotal=3,1===n?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-n))}function h(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function d(e){return e.toString(this.encoding)}function f(e){return e&&e.length?this.write(e):""}t.s=s,s.prototype.write=function(e){if(0===e.length)return"";var t,n;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";n=this.lastNeed,this.lastNeed=0}else n=0;return n<e.length?t?t+this.text(e,n):this.text(e,n):t||""},s.prototype.end=function(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"�":t},s.prototype.text=function(e,t){var n=function(e,t,n){var i=t.length-1;if(i<n)return 0;var r=o(t[i]);return r>=0?(r>0&&(e.lastNeed=r-1),r):--i<n||-2===r?0:(r=o(t[i]))>=0?(r>0&&(e.lastNeed=r-2),r):--i<n||-2===r?0:(r=o(t[i]))>=0?(r>0&&(2===r?r=0:e.lastNeed=r-3),r):0}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=n;var i=e.length-(n-this.lastNeed);return e.copy(this.lastChar,0,i),e.toString("utf8",t,i)},s.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length}},396:(e,t,n)=>{var i=n(4300),r=i.Buffer;function s(e,t){for(var n in e)t[n]=e[n]}function o(e,t,n){return r(e,t,n)}r.from&&r.alloc&&r.allocUnsafe&&r.allocUnsafeSlow?e.exports=i:(s(i,t),t.Buffer=o),s(r,o),o.from=function(e,t,n){if("number"==typeof e)throw new TypeError("Argument must not be a number");return r(e,t,n)},o.alloc=function(e,t,n){if("number"!=typeof e)throw new TypeError("Argument must be a number");var i=r(e);return void 0!==t?"string"==typeof n?i.fill(t,n):i.fill(t):i.fill(0),i},o.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return r(e)},o.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return i.SlowBuffer(e)}},9273:(e,t)=>{"use strict";t.levels={error:0,warn:1,help:2,data:3,info:4,debug:5,prompt:6,verbose:7,input:8,silly:9},t.colors={error:"red",warn:"yellow",help:"cyan",data:"grey",info:"green",debug:"blue",prompt:"grey",verbose:"cyan",input:"grey",silly:"magenta"}},5243:(e,t,n)=>{"use strict";Object.defineProperty(t,"cli",{value:n(9273)}),Object.defineProperty(t,"npm",{value:n(2459)}),Object.defineProperty(t,"syslog",{value:n(1945)})},2459:(e,t)=>{"use strict";t.levels={error:0,warn:1,info:2,http:3,verbose:4,debug:5,silly:6},t.colors={error:"red",warn:"yellow",info:"green",http:"green",verbose:"cyan",debug:"blue",silly:"magenta"}},1945:(e,t)=>{"use strict";t.levels={emerg:0,alert:1,crit:2,error:3,warning:4,notice:5,info:6,debug:7},t.colors={emerg:"red",alert:"yellow",crit:"red",error:"red",warning:"red",notice:"yellow",info:"green",debug:"blue"}},5396:(e,t,n)=>{"use strict";Object.defineProperty(t,"LEVEL",{value:Symbol.for("level")}),Object.defineProperty(t,"MESSAGE",{value:Symbol.for("message")}),Object.defineProperty(t,"SPLAT",{value:Symbol.for("splat")}),Object.defineProperty(t,"configs",{value:n(5243)})},1159:(e,t,n)=>{e.exports=n(3837).deprecate},1037:(e,t,n)=>{"use strict";const i=n(3837),r=n(8890),{LEVEL:s}=n(5396),o=e.exports=function(e={}){r.call(this,{objectMode:!0,highWaterMark:e.highWaterMark}),this.format=e.format,this.level=e.level,this.handleExceptions=e.handleExceptions,this.handleRejections=e.handleRejections,this.silent=e.silent,e.log&&(this.log=e.log),e.logv&&(this.logv=e.logv),e.close&&(this.close=e.close),this.once("pipe",(e=>{this.levels=e.levels,this.parent=e})),this.once("unpipe",(e=>{e===this.parent&&(this.parent=null,this.close&&this.close())}))};i.inherits(o,r),o.prototype._write=function(e,t,n){if(this.silent||!0===e.exception&&!this.handleExceptions)return n(null);const i=this.level||this.parent&&this.parent.level;if(!i||this.levels[i]>=this.levels[e[s]]){if(e&&!this.format)return this.log(e,n);let t,i;try{i=this.format.transform(Object.assign({},e),this.format.options)}catch(e){t=e}if(t||!i){if(n(),t)throw t;return}return this.log(i,n)}return this._writableState.sync=!1,n(null)},o.prototype._writev=function(e,t){if(this.logv){const n=e.filter(this._accept,this);return n.length?this.logv(n,t):t(null)}for(let n=0;n<e.length;n++){if(!this._accept(e[n]))continue;if(e[n].chunk&&!this.format){this.log(e[n].chunk,e[n].callback);continue}let i,r;try{r=this.format.transform(Object.assign({},e[n].chunk),this.format.options)}catch(e){i=e}if(i||!r){if(e[n].callback(),i)throw t(null),i}else this.log(r,e[n].callback)}return t(null)},o.prototype._accept=function(e){const t=e.chunk;if(this.silent)return!1;const n=this.level||this.parent&&this.parent.level;return!(!0!==t.exception&&n&&!(this.levels[n]>=this.levels[t[s]])||!this.handleExceptions&&!0===t.exception)},o.prototype._nop=function(){},e.exports.LegacyTransportStream=n(4201)},4201:(e,t,n)=>{"use strict";const i=n(3837),{LEVEL:r}=n(5396),s=n(1037),o=e.exports=function(e={}){if(s.call(this,e),!e.transport||"function"!=typeof e.transport.log)throw new Error("Invalid transport, must be an object with a log method.");this.transport=e.transport,this.level=this.level||e.transport.level,this.handleExceptions=this.handleExceptions||e.transport.handleExceptions,this._deprecated(),this.transport.__winstonError||(this.transport.__winstonError=function(e){this.emit("error",e,this.transport)}.bind(this),this.transport.on("error",this.transport.__winstonError))};i.inherits(o,s),o.prototype._write=function(e,t,n){if(this.silent||!0===e.exception&&!this.handleExceptions)return n(null);(!this.level||this.levels[this.level]>=this.levels[e[r]])&&this.transport.log(e[r],e.message,e,this._nop),n(null)},o.prototype._writev=function(e,t){for(let t=0;t<e.length;t++)this._accept(e[t])&&(this.transport.log(e[t].chunk[r],e[t].chunk.message,e[t].chunk,this._nop),e[t].callback());return t(null)},o.prototype._deprecated=function(){console.error([`${this.transport.name} is a legacy winston transport. Consider upgrading: `,"- Upgrade docs: https://github.com/winstonjs/winston/blob/master/UPGRADE-3.0.md"].join("\n"))},o.prototype.close=function(){this.transport.close&&this.transport.close(),this.transport.__winstonError&&(this.transport.removeListener("error",this.transport.__winstonError),this.transport.__winstonError=null)}},4826:e=>{"use strict";const t={};function n(e,n,i){i||(i=Error);class r extends i{constructor(e,t,i){super(function(e,t,i){return"string"==typeof n?n:n(e,t,i)}(e,t,i))}}r.prototype.name=i.name,r.prototype.code=e,t[e]=r}function i(e,t){if(Array.isArray(e)){const n=e.length;return e=e.map((e=>String(e))),n>2?`one of ${t} ${e.slice(0,n-1).join(", ")}, or `+e[n-1]:2===n?`one of ${t} ${e[0]} or ${e[1]}`:`of ${t} ${e[0]}`}return`of ${t} ${String(e)}`}n("ERR_INVALID_OPT_VALUE",(function(e,t){return'The value "'+t+'" is invalid for option "'+e+'"'}),TypeError),n("ERR_INVALID_ARG_TYPE",(function(e,t,n){let r;var s;let o;if("string"==typeof t&&(s="not ",t.substr(0,4)===s)?(r="must not be",t=t.replace(/^not /,"")):r="must be",function(e,t,n){return(void 0===n||n>e.length)&&(n=e.length),e.substring(n-9,n)===t}(e," argument"))o=`The ${e} ${r} ${i(t,"type")}`;else{o=`The "${e}" ${"number"!=typeof c&&(c=0),c+1>(a=e).length||-1===a.indexOf(".",c)?"argument":"property"} ${r} ${i(t,"type")}`}var a,c;return o+=". Received type "+typeof n,o}),TypeError),n("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),n("ERR_METHOD_NOT_IMPLEMENTED",(function(e){return"The "+e+" method is not implemented"})),n("ERR_STREAM_PREMATURE_CLOSE","Premature close"),n("ERR_STREAM_DESTROYED",(function(e){return"Cannot call "+e+" after a stream was destroyed"})),n("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),n("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),n("ERR_STREAM_WRITE_AFTER_END","write after end"),n("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),n("ERR_UNKNOWN_ENCODING",(function(e){return"Unknown encoding: "+e}),TypeError),n("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),e.exports.q=t},1653:(e,t,n)=>{"use strict";var i=Object.keys||function(e){var t=[];for(var n in e)t.push(n);return t};e.exports=l;var r=n(7807),s=n(8890);n(4378)(l,r);for(var o=i(s.prototype),a=0;a<o.length;a++){var c=o[a];l.prototype[c]||(l.prototype[c]=s.prototype[c])}function l(e){if(!(this instanceof l))return new l(e);r.call(this,e),s.call(this,e),this.allowHalfOpen=!0,e&&(!1===e.readable&&(this.readable=!1),!1===e.writable&&(this.writable=!1),!1===e.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",u)))}function u(){this._writableState.ended||process.nextTick(h,this)}function h(e){e.end()}Object.defineProperty(l.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(l.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(l.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(l.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}})},7807:(e,t,n)=>{"use strict";var i;e.exports=S,S.ReadableState=E,n(2361).EventEmitter;var r,s=function(e,t){return e.listeners(t).length},o=n(3340),a=n(4300).Buffer,c=global.Uint8Array||function(){},l=n(3837);r=l&&l.debuglog?l.debuglog("stream"):function(){};var u,h,d,f=n(2138),p=n(7557),g=n(1155).getHighWaterMark,m=n(4826).q,v=m.ERR_INVALID_ARG_TYPE,b=m.ERR_STREAM_PUSH_AFTER_EOF,y=m.ERR_METHOD_NOT_IMPLEMENTED,w=m.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;n(4378)(S,o);var _=p.errorOrDestroy,x=["error","close","destroy","pause","resume"];function E(e,t,r){i=i||n(1653),e=e||{},"boolean"!=typeof r&&(r=t instanceof i),this.objectMode=!!e.objectMode,r&&(this.objectMode=this.objectMode||!!e.readableObjectMode),this.highWaterMark=g(this,e,"readableHighWaterMark",r),this.buffer=new f,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(u||(u=n(2553).s),this.decoder=new u(e.encoding),this.encoding=e.encoding)}function S(e){if(i=i||n(1653),!(this instanceof S))return new S(e);var t=this instanceof i;this._readableState=new E(e,this,t),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy)),o.call(this)}function C(e,t,n,i,s){r("readableAddChunk",t);var o,l=e._readableState;if(null===t)l.reading=!1,function(e,t){if(r("onEofChunk"),!t.ended){if(t.decoder){var n=t.decoder.end();n&&n.length&&(t.buffer.push(n),t.length+=t.objectMode?1:n.length)}t.ended=!0,t.sync?O(e):(t.needReadable=!1,t.emittedReadable||(t.emittedReadable=!0,k(e)))}}(e,l);else if(s||(o=function(e,t){var n,i;return i=t,a.isBuffer(i)||i instanceof c||"string"==typeof t||void 0===t||e.objectMode||(n=new v("chunk",["string","Buffer","Uint8Array"],t)),n}(l,t)),o)_(e,o);else if(l.objectMode||t&&t.length>0)if("string"==typeof t||l.objectMode||Object.getPrototypeOf(t)===a.prototype||(t=function(e){return a.from(e)}(t)),i)l.endEmitted?_(e,new w):M(e,l,t,!0);else if(l.ended)_(e,new b);else{if(l.destroyed)return!1;l.reading=!1,l.decoder&&!n?(t=l.decoder.write(t),l.objectMode||0!==t.length?M(e,l,t,!1):P(e,l)):M(e,l,t,!1)}else i||(l.reading=!1,P(e,l));return!l.ended&&(l.length<l.highWaterMark||0===l.length)}function M(e,t,n,i){t.flowing&&0===t.length&&!t.sync?(t.awaitDrain=0,e.emit("data",n)):(t.length+=t.objectMode?1:n.length,i?t.buffer.unshift(n):t.buffer.push(n),t.needReadable&&O(e)),P(e,t)}Object.defineProperty(S.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),S.prototype.destroy=p.destroy,S.prototype._undestroy=p.undestroy,S.prototype._destroy=function(e,t){t(e)},S.prototype.push=function(e,t){var n,i=this._readableState;return i.objectMode?n=!0:"string"==typeof e&&((t=t||i.defaultEncoding)!==i.encoding&&(e=a.from(e,t),t=""),n=!0),C(this,e,t,!1,n)},S.prototype.unshift=function(e){return C(this,e,null,!0,!1)},S.prototype.isPaused=function(){return!1===this._readableState.flowing},S.prototype.setEncoding=function(e){u||(u=n(2553).s);var t=new u(e);this._readableState.decoder=t,this._readableState.encoding=this._readableState.decoder.encoding;for(var i=this._readableState.buffer.head,r="";null!==i;)r+=t.write(i.data),i=i.next;return this._readableState.buffer.clear(),""!==r&&this._readableState.buffer.push(r),this._readableState.length=r.length,this};var T=1073741824;function $(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=T?e=T:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function O(e){var t=e._readableState;r("emitReadable",t.needReadable,t.emittedReadable),t.needReadable=!1,t.emittedReadable||(r("emitReadable",t.flowing),t.emittedReadable=!0,process.nextTick(k,e))}function k(e){var t=e._readableState;r("emitReadable_",t.destroyed,t.length,t.ended),t.destroyed||!t.length&&!t.ended||(e.emit("readable"),t.emittedReadable=!1),t.needReadable=!t.flowing&&!t.ended&&t.length<=t.highWaterMark,L(e)}function P(e,t){t.readingMore||(t.readingMore=!0,process.nextTick(R,e,t))}function R(e,t){for(;!t.reading&&!t.ended&&(t.length<t.highWaterMark||t.flowing&&0===t.length);){var n=t.length;if(r("maybeReadMore read 0"),e.read(0),n===t.length)break}t.readingMore=!1}function A(e){var t=e._readableState;t.readableListening=e.listenerCount("readable")>0,t.resumeScheduled&&!t.paused?t.flowing=!0:e.listenerCount("data")>0&&e.resume()}function I(e){r("readable nexttick read 0"),e.read(0)}function j(e,t){r("resume",t.reading),t.reading||e.read(0),t.resumeScheduled=!1,e.emit("resume"),L(e),t.flowing&&!t.reading&&e.read(0)}function L(e){var t=e._readableState;for(r("flow",t.flowing);t.flowing&&null!==e.read(););}function D(e,t){return 0===t.length?null:(t.objectMode?n=t.buffer.shift():!e||e>=t.length?(n=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.first():t.buffer.concat(t.length),t.buffer.clear()):n=t.buffer.consume(e,t.decoder),n);var n}function N(e){var t=e._readableState;r("endReadable",t.endEmitted),t.endEmitted||(t.ended=!0,process.nextTick(B,t,e))}function B(e,t){if(r("endReadableNT",e.endEmitted,e.length),!e.endEmitted&&0===e.length&&(e.endEmitted=!0,t.readable=!1,t.emit("end"),e.autoDestroy)){var n=t._writableState;(!n||n.autoDestroy&&n.finished)&&t.destroy()}}function U(e,t){for(var n=0,i=e.length;n<i;n++)if(e[n]===t)return n;return-1}S.prototype.read=function(e){r("read",e),e=parseInt(e,10);var t=this._readableState,n=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&((0!==t.highWaterMark?t.length>=t.highWaterMark:t.length>0)||t.ended))return r("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?N(this):O(this),null;if(0===(e=$(e,t))&&t.ended)return 0===t.length&&N(this),null;var i,s=t.needReadable;return r("need readable",s),(0===t.length||t.length-e<t.highWaterMark)&&r("length less than watermark",s=!0),t.ended||t.reading?r("reading or ended",s=!1):s&&(r("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=$(n,t))),null===(i=e>0?D(e,t):null)?(t.needReadable=t.length<=t.highWaterMark,e=0):(t.length-=e,t.awaitDrain=0),0===t.length&&(t.ended||(t.needReadable=!0),n!==e&&t.ended&&N(this)),null!==i&&this.emit("data",i),i},S.prototype._read=function(e){_(this,new y("_read()"))},S.prototype.pipe=function(e,t){var n=this,i=this._readableState;switch(i.pipesCount){case 0:i.pipes=e;break;case 1:i.pipes=[i.pipes,e];break;default:i.pipes.push(e)}i.pipesCount+=1,r("pipe count=%d opts=%j",i.pipesCount,t);var o=t&&!1===t.end||e===process.stdout||e===process.stderr?p:a;function a(){r("onend"),e.end()}i.endEmitted?process.nextTick(o):n.once("end",o),e.on("unpipe",(function t(s,o){r("onunpipe"),s===n&&o&&!1===o.hasUnpiped&&(o.hasUnpiped=!0,r("cleanup"),e.removeListener("close",d),e.removeListener("finish",f),e.removeListener("drain",c),e.removeListener("error",h),e.removeListener("unpipe",t),n.removeListener("end",a),n.removeListener("end",p),n.removeListener("data",u),l=!0,!i.awaitDrain||e._writableState&&!e._writableState.needDrain||c())}));var c=function(e){return function(){var t=e._readableState;r("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&s(e,"data")&&(t.flowing=!0,L(e))}}(n);e.on("drain",c);var l=!1;function u(t){r("ondata");var s=e.write(t);r("dest.write",s),!1===s&&((1===i.pipesCount&&i.pipes===e||i.pipesCount>1&&-1!==U(i.pipes,e))&&!l&&(r("false write response, pause",i.awaitDrain),i.awaitDrain++),n.pause())}function h(t){r("onerror",t),p(),e.removeListener("error",h),0===s(e,"error")&&_(e,t)}function d(){e.removeListener("finish",f),p()}function f(){r("onfinish"),e.removeListener("close",d),p()}function p(){r("unpipe"),n.unpipe(e)}return n.on("data",u),function(e,t,n){if("function"==typeof e.prependListener)return e.prependListener(t,n);e._events&&e._events[t]?Array.isArray(e._events[t])?e._events[t].unshift(n):e._events[t]=[n,e._events[t]]:e.on(t,n)}(e,"error",h),e.once("close",d),e.once("finish",f),e.emit("pipe",n),i.flowing||(r("pipe resume"),n.resume()),e},S.prototype.unpipe=function(e){var t=this._readableState,n={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,n)),this;if(!e){var i=t.pipes,r=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var s=0;s<r;s++)i[s].emit("unpipe",this,{hasUnpiped:!1});return this}var o=U(t.pipes,e);return-1===o||(t.pipes.splice(o,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,n)),this},S.prototype.on=function(e,t){var n=o.prototype.on.call(this,e,t),i=this._readableState;return"data"===e?(i.readableListening=this.listenerCount("readable")>0,!1!==i.flowing&&this.resume()):"readable"===e&&(i.endEmitted||i.readableListening||(i.readableListening=i.needReadable=!0,i.flowing=!1,i.emittedReadable=!1,r("on readable",i.length,i.reading),i.length?O(this):i.reading||process.nextTick(I,this))),n},S.prototype.addListener=S.prototype.on,S.prototype.removeListener=function(e,t){var n=o.prototype.removeListener.call(this,e,t);return"readable"===e&&process.nextTick(A,this),n},S.prototype.removeAllListeners=function(e){var t=o.prototype.removeAllListeners.apply(this,arguments);return"readable"!==e&&void 0!==e||process.nextTick(A,this),t},S.prototype.resume=function(){var e=this._readableState;return e.flowing||(r("resume"),e.flowing=!e.readableListening,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,process.nextTick(j,e,t))}(this,e)),e.paused=!1,this},S.prototype.pause=function(){return r("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(r("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},S.prototype.wrap=function(e){var t=this,n=this._readableState,i=!1;for(var s in e.on("end",(function(){if(r("wrapped end"),n.decoder&&!n.ended){var e=n.decoder.end();e&&e.length&&t.push(e)}t.push(null)})),e.on("data",(function(s){r("wrapped data"),n.decoder&&(s=n.decoder.write(s)),n.objectMode&&null==s||(n.objectMode||s&&s.length)&&(t.push(s)||(i=!0,e.pause()))})),e)void 0===this[s]&&"function"==typeof e[s]&&(this[s]=function(t){return function(){return e[t].apply(e,arguments)}}(s));for(var o=0;o<x.length;o++)e.on(x[o],this.emit.bind(this,x[o]));return this._read=function(t){r("wrapped _read",t),i&&(i=!1,e.resume())},this},"function"==typeof Symbol&&(S.prototype[Symbol.asyncIterator]=function(){return void 0===h&&(h=n(8048)),h(this)}),Object.defineProperty(S.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(S.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(S.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}}),S._fromList=D,Object.defineProperty(S.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"==typeof Symbol&&(S.from=function(e,t){return void 0===d&&(d=n(805)),d(S,e,t)})},8890:(e,t,n)=>{"use strict";function i(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,n){var i=e.entry;for(e.entry=null;i;){var r=i.callback;t.pendingcb--,r(undefined),i=i.next}t.corkedRequestsFree.next=e}(t,e)}}var r;e.exports=S,S.WritableState=E;var s,o={deprecate:n(1159)},a=n(3340),c=n(4300).Buffer,l=global.Uint8Array||function(){},u=n(7557),h=n(1155).getHighWaterMark,d=n(4826).q,f=d.ERR_INVALID_ARG_TYPE,p=d.ERR_METHOD_NOT_IMPLEMENTED,g=d.ERR_MULTIPLE_CALLBACK,m=d.ERR_STREAM_CANNOT_PIPE,v=d.ERR_STREAM_DESTROYED,b=d.ERR_STREAM_NULL_VALUES,y=d.ERR_STREAM_WRITE_AFTER_END,w=d.ERR_UNKNOWN_ENCODING,_=u.errorOrDestroy;function x(){}function E(e,t,s){r=r||n(1653),e=e||{},"boolean"!=typeof s&&(s=t instanceof r),this.objectMode=!!e.objectMode,s&&(this.objectMode=this.objectMode||!!e.writableObjectMode),this.highWaterMark=h(this,e,"writableHighWaterMark",s),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var o=!1===e.decodeStrings;this.decodeStrings=!o,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var n=e._writableState,i=n.sync,r=n.writecb;if("function"!=typeof r)throw new g;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(n),t)!function(e,t,n,i,r){--t.pendingcb,n?(process.nextTick(r,i),process.nextTick(k,e,t),e._writableState.errorEmitted=!0,_(e,i)):(r(i),e._writableState.errorEmitted=!0,_(e,i),k(e,t))}(e,n,i,t,r);else{var s=$(n)||e.destroyed;s||n.corked||n.bufferProcessing||!n.bufferedRequest||T(e,n),i?process.nextTick(M,e,n,s,r):M(e,n,s,r)}}(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new i(this)}function S(e){var t=this instanceof(r=r||n(1653));if(!t&&!s.call(S,this))return new S(e);this._writableState=new E(e,this,t),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),a.call(this)}function C(e,t,n,i,r,s,o){t.writelen=i,t.writecb=o,t.writing=!0,t.sync=!0,t.destroyed?t.onwrite(new v("write")):n?e._writev(r,t.onwrite):e._write(r,s,t.onwrite),t.sync=!1}function M(e,t,n,i){n||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,i(),k(e,t)}function T(e,t){t.bufferProcessing=!0;var n=t.bufferedRequest;if(e._writev&&n&&n.next){var r=t.bufferedRequestCount,s=new Array(r),o=t.corkedRequestsFree;o.entry=n;for(var a=0,c=!0;n;)s[a]=n,n.isBuf||(c=!1),n=n.next,a+=1;s.allBuffers=c,C(e,t,!0,t.length,s,"",o.finish),t.pendingcb++,t.lastBufferedRequest=null,o.next?(t.corkedRequestsFree=o.next,o.next=null):t.corkedRequestsFree=new i(t),t.bufferedRequestCount=0}else{for(;n;){var l=n.chunk,u=n.encoding,h=n.callback;if(C(e,t,!1,t.objectMode?1:l.length,l,u,h),n=n.next,t.bufferedRequestCount--,t.writing)break}null===n&&(t.lastBufferedRequest=null)}t.bufferedRequest=n,t.bufferProcessing=!1}function $(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function O(e,t){e._final((function(n){t.pendingcb--,n&&_(e,n),t.prefinished=!0,e.emit("prefinish"),k(e,t)}))}function k(e,t){var n=$(t);if(n&&(function(e,t){t.prefinished||t.finalCalled||("function"!=typeof e._final||t.destroyed?(t.prefinished=!0,e.emit("prefinish")):(t.pendingcb++,t.finalCalled=!0,process.nextTick(O,e,t)))}(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"),t.autoDestroy))){var i=e._readableState;(!i||i.autoDestroy&&i.endEmitted)&&e.destroy()}return n}n(4378)(S,a),E.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(E.prototype,"buffer",{get:o.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(s=Function.prototype[Symbol.hasInstance],Object.defineProperty(S,Symbol.hasInstance,{value:function(e){return!!s.call(this,e)||this===S&&e&&e._writableState instanceof E}})):s=function(e){return e instanceof this},S.prototype.pipe=function(){_(this,new m)},S.prototype.write=function(e,t,n){var i,r=this._writableState,s=!1,o=!r.objectMode&&(i=e,c.isBuffer(i)||i instanceof l);return o&&!c.isBuffer(e)&&(e=function(e){return c.from(e)}(e)),"function"==typeof t&&(n=t,t=null),o?t="buffer":t||(t=r.defaultEncoding),"function"!=typeof n&&(n=x),r.ending?function(e,t){var n=new y;_(e,n),process.nextTick(t,n)}(this,n):(o||function(e,t,n,i){var r;return null===n?r=new b:"string"==typeof n||t.objectMode||(r=new f("chunk",["string","Buffer"],n)),!r||(_(e,r),process.nextTick(i,r),!1)}(this,r,e,n))&&(r.pendingcb++,s=function(e,t,n,i,r,s){if(!n){var o=function(e,t,n){return e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=c.from(t,n)),t}(t,i,r);i!==o&&(n=!0,r="buffer",i=o)}var a=t.objectMode?1:i.length;t.length+=a;var l=t.length<t.highWaterMark;if(l||(t.needDrain=!0),t.writing||t.corked){var u=t.lastBufferedRequest;t.lastBufferedRequest={chunk:i,encoding:r,isBuf:n,callback:s,next:null},u?u.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else C(e,t,!1,a,i,r,s);return l}(this,r,o,e,t,n)),s},S.prototype.cork=function(){this._writableState.corked++},S.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.bufferProcessing||!e.bufferedRequest||T(this,e))},S.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new w(e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(S.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(S.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),S.prototype._write=function(e,t,n){n(new p("_write()"))},S.prototype._writev=null,S.prototype.end=function(e,t,n){var i=this._writableState;return"function"==typeof e?(n=e,e=null,t=null):"function"==typeof t&&(n=t,t=null),null!=e&&this.write(e,t),i.corked&&(i.corked=1,this.uncork()),i.ending||function(e,t,n){t.ending=!0,k(e,t),n&&(t.finished?process.nextTick(n):e.once("finish",n)),t.ended=!0,e.writable=!1}(this,i,n),this},Object.defineProperty(S.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(S.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),S.prototype.destroy=u.destroy,S.prototype._undestroy=u.undestroy,S.prototype._destroy=function(e,t){t(e)}},8048:(e,t,n)=>{"use strict";var i;function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var s=n(6373),o=Symbol("lastResolve"),a=Symbol("lastReject"),c=Symbol("error"),l=Symbol("ended"),u=Symbol("lastPromise"),h=Symbol("handlePromise"),d=Symbol("stream");function f(e,t){return{value:e,done:t}}function p(e){var t=e[o];if(null!==t){var n=e[d].read();null!==n&&(e[u]=null,e[o]=null,e[a]=null,t(f(n,!1)))}}function g(e){process.nextTick(p,e)}var m=Object.getPrototypeOf((function(){})),v=Object.setPrototypeOf((r(i={get stream(){return this[d]},next:function(){var e=this,t=this[c];if(null!==t)return Promise.reject(t);if(this[l])return Promise.resolve(f(void 0,!0));if(this[d].destroyed)return new Promise((function(t,n){process.nextTick((function(){e[c]?n(e[c]):t(f(void 0,!0))}))}));var n,i=this[u];if(i)n=new Promise(function(e,t){return function(n,i){e.then((function(){t[l]?n(f(void 0,!0)):t[h](n,i)}),i)}}(i,this));else{var r=this[d].read();if(null!==r)return Promise.resolve(f(r,!1));n=new Promise(this[h])}return this[u]=n,n}},Symbol.asyncIterator,(function(){return this})),r(i,"return",(function(){var e=this;return new Promise((function(t,n){e[d].destroy(null,(function(e){e?n(e):t(f(void 0,!0))}))}))})),i),m);e.exports=function(e){var t,n=Object.create(v,(r(t={},d,{value:e,writable:!0}),r(t,o,{value:null,writable:!0}),r(t,a,{value:null,writable:!0}),r(t,c,{value:null,writable:!0}),r(t,l,{value:e._readableState.endEmitted,writable:!0}),r(t,h,{value:function(e,t){var i=n[d].read();i?(n[u]=null,n[o]=null,n[a]=null,e(f(i,!1))):(n[o]=e,n[a]=t)},writable:!0}),t));return n[u]=null,s(e,(function(e){if(e&&"ERR_STREAM_PREMATURE_CLOSE"!==e.code){var t=n[a];return null!==t&&(n[u]=null,n[o]=null,n[a]=null,t(e)),void(n[c]=e)}var i=n[o];null!==i&&(n[u]=null,n[o]=null,n[a]=null,i(f(void 0,!0))),n[l]=!0})),e.on("readable",g.bind(null,n)),n}},2138:(e,t,n)=>{"use strict";function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var o=n(4300).Buffer,a=n(3837).inspect,c=a&&a.custom||"inspect";e.exports=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.head=null,this.tail=null,this.length=0}var t,n;return t=e,n=[{key:"push",value:function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length}},{key:"unshift",value:function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length}},{key:"shift",value:function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(e){if(0===this.length)return"";for(var t=this.head,n=""+t.data;t=t.next;)n+=e+t.data;return n}},{key:"concat",value:function(e){if(0===this.length)return o.alloc(0);for(var t,n,i,r=o.allocUnsafe(e>>>0),s=this.head,a=0;s;)t=s.data,n=r,i=a,o.prototype.copy.call(t,n,i),a+=s.data.length,s=s.next;return r}},{key:"consume",value:function(e,t){var n;return e<this.head.data.length?(n=this.head.data.slice(0,e),this.head.data=this.head.data.slice(e)):n=e===this.head.data.length?this.shift():t?this._getString(e):this._getBuffer(e),n}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(e){var t=this.head,n=1,i=t.data;for(e-=i.length;t=t.next;){var r=t.data,s=e>r.length?r.length:e;if(s===r.length?i+=r:i+=r.slice(0,e),0==(e-=s)){s===r.length?(++n,t.next?this.head=t.next:this.head=this.tail=null):(this.head=t,t.data=r.slice(s));break}++n}return this.length-=n,i}},{key:"_getBuffer",value:function(e){var t=o.allocUnsafe(e),n=this.head,i=1;for(n.data.copy(t),e-=n.data.length;n=n.next;){var r=n.data,s=e>r.length?r.length:e;if(r.copy(t,t.length-e,0,s),0==(e-=s)){s===r.length?(++i,n.next?this.head=n.next:this.head=this.tail=null):(this.head=n,n.data=r.slice(s));break}++i}return this.length-=i,t}},{key:c,value:function(e,t){return a(this,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},t,{depth:0,customInspect:!1}))}}],n&&s(t.prototype,n),e}()},7557:e=>{"use strict";function t(e,t){i(e,t),n(e)}function n(e){e._writableState&&!e._writableState.emitClose||e._readableState&&!e._readableState.emitClose||e.emit("close")}function i(e,t){e.emit("error",t)}e.exports={destroy:function(e,r){var s=this,o=this._readableState&&this._readableState.destroyed,a=this._writableState&&this._writableState.destroyed;return o||a?(r?r(e):e&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,process.nextTick(i,this,e)):process.nextTick(i,this,e)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,(function(e){!r&&e?s._writableState?s._writableState.errorEmitted?process.nextTick(n,s):(s._writableState.errorEmitted=!0,process.nextTick(t,s,e)):process.nextTick(t,s,e):r?(process.nextTick(n,s),r(e)):process.nextTick(n,s)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(e,t){var n=e._readableState,i=e._writableState;n&&n.autoDestroy||i&&i.autoDestroy?e.destroy(t):e.emit("error",t)}}},6373:(e,t,n)=>{"use strict";var i=n(4826).q.ERR_STREAM_PREMATURE_CLOSE;function r(){}e.exports=function e(t,n,s){if("function"==typeof n)return e(t,null,n);n||(n={}),s=function(e){var t=!1;return function(){if(!t){t=!0;for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];e.apply(this,i)}}}(s||r);var o=n.readable||!1!==n.readable&&t.readable,a=n.writable||!1!==n.writable&&t.writable,c=function(){t.writable||u()},l=t._writableState&&t._writableState.finished,u=function(){a=!1,l=!0,o||s.call(t)},h=t._readableState&&t._readableState.endEmitted,d=function(){o=!1,h=!0,a||s.call(t)},f=function(e){s.call(t,e)},p=function(){var e;return o&&!h?(t._readableState&&t._readableState.ended||(e=new i),s.call(t,e)):a&&!l?(t._writableState&&t._writableState.ended||(e=new i),s.call(t,e)):void 0},g=function(){t.req.on("finish",u)};return function(e){return e.setHeader&&"function"==typeof e.abort}(t)?(t.on("complete",u),t.on("abort",p),t.req?g():t.on("request",g)):a&&!t._writableState&&(t.on("end",c),t.on("close",c)),t.on("end",d),t.on("finish",u),!1!==n.error&&t.on("error",f),t.on("close",p),function(){t.removeListener("complete",u),t.removeListener("abort",p),t.removeListener("request",g),t.req&&t.req.removeListener("finish",u),t.removeListener("end",c),t.removeListener("close",c),t.removeListener("finish",u),t.removeListener("end",d),t.removeListener("error",f),t.removeListener("close",p)}}},805:(e,t,n)=>{"use strict";function i(e,t,n,i,r,s,o){try{var a=e[s](o),c=a.value}catch(e){return void n(e)}a.done?t(c):Promise.resolve(c).then(i,r)}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var o=n(4826).q.ERR_INVALID_ARG_TYPE;e.exports=function(e,t,n){var a;if(t&&"function"==typeof t.next)a=t;else if(t&&t[Symbol.asyncIterator])a=t[Symbol.asyncIterator]();else{if(!t||!t[Symbol.iterator])throw new o("iterable",["Iterable"],t);a=t[Symbol.iterator]()}var c=new e(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({objectMode:!0},n)),l=!1;function u(){return h.apply(this,arguments)}function h(){var e;return e=function*(){try{var e=yield a.next(),t=e.value;e.done?c.push(null):c.push(yield t)?u():l=!1}catch(e){c.destroy(e)}},h=function(){var t=this,n=arguments;return new Promise((function(r,s){var o=e.apply(t,n);function a(e){i(o,r,s,a,c,"next",e)}function c(e){i(o,r,s,a,c,"throw",e)}a(void 0)}))},h.apply(this,arguments)}return c._read=function(){l||(l=!0,u())},c}},1155:(e,t,n)=>{"use strict";var i=n(4826).q.ERR_INVALID_OPT_VALUE;e.exports={getHighWaterMark:function(e,t,n,r){var s=function(e,t,n){return null!=e.highWaterMark?e.highWaterMark:t?e[n]:null}(t,r,n);if(null!=s){if(!isFinite(s)||Math.floor(s)!==s||s<0)throw new i(r?n:"highWaterMark",s);return Math.floor(s)}return e.objectMode?16:16384}}},3340:(e,t,n)=>{e.exports=n(2781)},1440:(e,t,n)=>{"use strict";const i=n(562),{warn:r}=n(2850),s=t;s.version=n(2561).i8,s.transports=n(9840),s.config=n(448),s.addColors=i.levels,s.format=i.format,s.createLogger=n(5658),s.ExceptionHandler=n(5120),s.RejectionHandler=n(5724),s.Container=n(6099),s.Transport=n(1037),s.loggers=new s.Container;const o=s.createLogger();Object.keys(s.config.npm.levels).concat(["log","query","stream","add","remove","clear","profile","startTimer","handleExceptions","unhandleExceptions","handleRejections","unhandleRejections","configure","child"]).forEach((e=>s[e]=(...t)=>o[e](...t))),Object.defineProperty(s,"level",{get:()=>o.level,set(e){o.level=e}}),Object.defineProperty(s,"exceptions",{get:()=>o.exceptions}),["exitOnError"].forEach((e=>{Object.defineProperty(s,e,{get:()=>o[e],set(t){o[e]=t}})})),Object.defineProperty(s,"default",{get:()=>({exceptionHandlers:o.exceptionHandlers,rejectionHandlers:o.rejectionHandlers,transports:o.transports})}),r.deprecated(s,"setLevels"),r.forFunctions(s,"useFormat",["cli"]),r.forProperties(s,"useFormat",["padLevels","stripColors"]),r.forFunctions(s,"deprecated",["addRewriter","addFilter","clone","extend"]),r.forProperties(s,"deprecated",["emitErrs","levelLength"]),r.moved(s,"createLogger","Logger")},2850:(e,t,n)=>{"use strict";const{format:i}=n(3837);t.warn={deprecated:e=>()=>{throw new Error(i("{ %s } was removed in winston@3.0.0.",e))},useFormat:e=>()=>{throw new Error([i("{ %s } was removed in winston@3.0.0.",e),"Use a custom winston.format = winston.format(function) instead."].join("\n"))},forFunctions(e,n,i){i.forEach((i=>{e[i]=t.warn[n](i)}))},moved(e,t,n){function r(){return()=>{throw new Error([i("winston.%s was moved in winston@3.0.0.",n),i("Use a winston.%s instead.",t)].join("\n"))}}Object.defineProperty(e,n,{get:r,set:r})},forProperties(e,n,i){i.forEach((i=>{const r=t.warn[n](i);Object.defineProperty(e,i,{get:r,set:r})}))}}},448:(e,t,n)=>{"use strict";const i=n(562),{configs:r}=n(5396);t.cli=i.levels(r.cli),t.npm=i.levels(r.npm),t.syslog=i.levels(r.syslog),t.addColors=i.levels},6099:(e,t,n)=>{"use strict";const i=n(5658);e.exports=class{constructor(e={}){this.loggers=new Map,this.options=e}add(e,t){if(!this.loggers.has(e)){const n=(t=Object.assign({},t||this.options)).transports||this.options.transports;t.transports=n?n.slice():[];const r=i(t);r.on("close",(()=>this._delete(e))),this.loggers.set(e,r)}return this.loggers.get(e)}get(e,t){return this.add(e,t)}has(e){return!!this.loggers.has(e)}close(e){if(e)return this._removeLogger(e);this.loggers.forEach(((e,t)=>this._removeLogger(t)))}_removeLogger(e){this.loggers.has(e)&&(this.loggers.get(e).close(),this._delete(e))}_delete(e){this.loggers.delete(e)}}},5658:(e,t,n)=>{"use strict";const{LEVEL:i}=n(5396),r=n(448),s=n(9848),o=n(3420)("winston:create-logger");e.exports=function(e={}){e.levels=e.levels||r.npm.levels;class t extends s{constructor(e){super(e)}}const n=new t(e);return Object.keys(e.levels).forEach((function(e){o('Define prototype method for "%s"',e),"log"!==e?(t.prototype[e]=function(...t){const r=this||n;if(1===t.length){const[s]=t,o=s&&s.message&&s||{message:s};return o.level=o[i]=e,r._addDefaultMeta(o),r.write(o),this||n}return 0===t.length?(r.log(e,""),r):r.log(e,...t)},t.prototype[function(e){return"is"+e.charAt(0).toUpperCase()+e.slice(1)+"Enabled"}(e)]=function(){return(this||n).isLevelEnabled(e)}):console.warn('Level "log" not defined: conflicts with the method "log". Use a different level name.')})),n}},5120:(e,t,n)=>{"use strict";const i=n(2037),r=n(8058),s=n(3420)("winston:exception"),o=n(3138),a=n(7911),c=n(5193);e.exports=class{constructor(e){if(!e)throw new Error("Logger is required to handle exceptions");this.logger=e,this.handlers=new Map}handle(...e){e.forEach((e=>{if(Array.isArray(e))return e.forEach((e=>this._addHandler(e)));this._addHandler(e)})),this.catcher||(this.catcher=this._uncaughtException.bind(this),process.on("uncaughtException",this.catcher))}unhandle(){this.catcher&&(process.removeListener("uncaughtException",this.catcher),this.catcher=!1,Array.from(this.handlers.values()).forEach((e=>this.logger.unpipe(e))))}getAllInfo(e){let{message:t}=e;return t||"string"!=typeof e||(t=e),{error:e,level:"error",message:[`uncaughtException: ${t||"(no error message)"}`,e.stack||"  No stack trace"].join("\n"),stack:e.stack,exception:!0,date:(new Date).toString(),process:this.getProcessInfo(),os:this.getOsInfo(),trace:this.getTrace(e)}}getProcessInfo(){return{pid:process.pid,uid:process.getuid?process.getuid():null,gid:process.getgid?process.getgid():null,cwd:process.cwd(),execPath:process.execPath,version:process.version,argv:process.argv,memoryUsage:process.memoryUsage()}}getOsInfo(){return{loadavg:i.loadavg(),uptime:i.uptime()}}getTrace(e){return(e?a.parse(e):a.get()).map((e=>({column:e.getColumnNumber(),file:e.getFileName(),function:e.getFunctionName(),line:e.getLineNumber(),method:e.getMethodName(),native:e.isNative()})))}_addHandler(e){if(!this.handlers.has(e)){e.handleExceptions=!0;const t=new c(e);this.handlers.set(e,t),this.logger.pipe(t)}}_uncaughtException(e){const t=this.getAllInfo(e),n=this._getExceptionHandlers();let i,a="function"==typeof this.logger.exitOnError?this.logger.exitOnError(e):this.logger.exitOnError;function c(){s("doExit",a),s("process._exiting",process._exiting),a&&!process._exiting&&(i&&clearTimeout(i),process.exit(1))}if(!n.length&&a&&(console.warn("winston: exitOnError cannot be true with no exception handlers."),console.warn("winston: not exiting process."),a=!1),!n||0===n.length)return process.nextTick(c);r(n,((e,t)=>{const n=o(t),i=e.transport||e;function r(e){return()=>{s(e),n()}}i._ending=!0,i.once("finish",r("finished")),i.once("error",r("error"))}),(()=>a&&c())),this.logger.log(t),a&&(i=setTimeout(c,3e3))}_getExceptionHandlers(){return this.logger.transports.filter((e=>(e.transport||e).handleExceptions))}}},5193:(e,t,n)=>{"use strict";const{Writable:i}=n(514);e.exports=class extends i{constructor(e){if(super({objectMode:!0}),!e)throw new Error("ExceptionStream requires a TransportStream instance.");this.handleExceptions=!0,this.transport=e}_write(e,t,n){return e.exception?this.transport.log(e,n):(n(),!0)}}},9848:(e,t,n)=>{"use strict";const{Stream:i,Transform:r}=n(514),s=n(8058),{LEVEL:o,SPLAT:a}=n(5396),c=n(4970),l=n(5120),u=n(5724),h=n(4201),d=n(46),{warn:f}=n(2850),p=n(448),g=/%[scdjifoO%]/g;class m extends r{constructor(e){super({objectMode:!0}),this.configure(e)}child(e){const t=this;return Object.create(t,{write:{value:function(n){const i=Object.assign({},e,n);n instanceof Error&&(i.stack=n.stack,i.message=n.message),t.write(i)}}})}configure({silent:e,format:t,defaultMeta:i,levels:r,level:s="info",exitOnError:o=!0,transports:a,colors:c,emitErrs:h,formatters:d,padLevels:f,rewriters:g,stripColors:m,exceptionHandlers:v,rejectionHandlers:b}={}){if(this.transports.length&&this.clear(),this.silent=e,this.format=t||this.format||n(3922)(),this.defaultMeta=i||null,this.levels=r||this.levels||p.npm.levels,this.level=s,this.exceptions=new l(this),this.rejections=new u(this),this.profilers={},this.exitOnError=o,a&&(a=Array.isArray(a)?a:[a]).forEach((e=>this.add(e))),c||h||d||f||g||m)throw new Error(["{ colors, emitErrs, formatters, padLevels, rewriters, stripColors } were removed in winston@3.0.0.","Use a custom winston.format(function) instead.","See: https://github.com/winstonjs/winston/tree/master/UPGRADE-3.0.md"].join("\n"));v&&this.exceptions.handle(v),b&&this.rejections.handle(b)}isLevelEnabled(e){const t=v(this.levels,e);if(null===t)return!1;const n=v(this.levels,this.level);return null!==n&&(this.transports&&0!==this.transports.length?-1!==this.transports.findIndex((e=>{let i=v(this.levels,e.level);return null===i&&(i=n),i>=t})):n>=t)}log(e,t,...n){if(1===arguments.length)return e[o]=e.level,this._addDefaultMeta(e),this.write(e),this;if(2===arguments.length)return t&&"object"==typeof t?(t[o]=t.level=e,this._addDefaultMeta(t),this.write(t),this):(this.write({[o]:e,level:e,message:t}),this);const[i]=n;if("object"==typeof i&&null!==i&&!(t&&t.match&&t.match(g))){const r=Object.assign({},this.defaultMeta,i,{[o]:e,[a]:n,level:e,message:t});return i.message&&(r.message=`${r.message} ${i.message}`),i.stack&&(r.stack=i.stack),this.write(r),this}return this.write(Object.assign({},this.defaultMeta,{[o]:e,[a]:n,level:e,message:t})),this}_transform(e,t,n){if(this.silent)return n();e[o]||(e[o]=e.level),this.levels[e[o]]||0===this.levels[e[o]]||console.error("[winston] Unknown logger level: %s",e[o]),this._readableState.pipes||console.error("[winston] Attempt to write logs with no transports %j",e);try{this.push(this.format.transform(e,this.format.options))}catch(e){throw e}finally{n()}}_final(e){const t=this.transports.slice();s(t,((e,t)=>{if(!e||e.finished)return setImmediate(t);e.once("finish",t),e.end()}),e)}add(e){const t=!c(e)||e.log.length>2?new h({transport:e}):e;if(!t._writableState||!t._writableState.objectMode)throw new Error("Transports must WritableStreams in objectMode. Set { objectMode: true }.");return this._onEvent("error",t),this._onEvent("warn",t),this.pipe(t),e.handleExceptions&&this.exceptions.handle(),e.handleRejections&&this.rejections.handle(),this}remove(e){if(!e)return this;let t=e;return(!c(e)||e.log.length>2)&&(t=this.transports.filter((t=>t.transport===e))[0]),t&&this.unpipe(t),this}clear(){return this.unpipe(),this}close(){return this.clear(),this.emit("close"),this}setLevels(){f.deprecated("setLevels")}query(e,t){"function"==typeof e&&(t=e,e={}),e=e||{};const n={},i=Object.assign({},e.query||{});s(this.transports.filter((e=>!!e.query)),(function(t,r){!function(t,n){e.query&&"function"==typeof t.formatQuery&&(e.query=t.formatQuery(i)),t.query(e,((i,r)=>{if(i)return n(i);"function"==typeof t.formatResults&&(r=t.formatResults(r,e.format)),n(null,r)}))}(t,((e,i)=>{r&&((i=e||i)&&(n[t.name]=i),r()),r=null}))}),(()=>t(null,n)))}stream(e={}){const t=new i,n=[];return t._streams=n,t.destroy=()=>{let e=n.length;for(;e--;)n[e].destroy()},this.transports.filter((e=>!!e.stream)).forEach((i=>{const r=i.stream(e);r&&(n.push(r),r.on("log",(e=>{e.transport=e.transport||[],e.transport.push(i.name),t.emit("log",e)})),r.on("error",(e=>{e.transport=e.transport||[],e.transport.push(i.name),t.emit("error",e)})))})),t}startTimer(){return new d(this)}profile(e,...t){const n=Date.now();if(this.profilers[e]){const i=this.profilers[e];delete this.profilers[e],"function"==typeof t[t.length-2]&&(console.warn("Callback function no longer supported as of winston@3.0.0"),t.pop());const r="object"==typeof t[t.length-1]?t.pop():{};return r.level=r.level||"info",r.durationMs=n-i,r.message=r.message||e,this.write(r)}return this.profilers[e]=n,this}handleExceptions(...e){console.warn("Deprecated: .handleExceptions() will be removed in winston@4. Use .exceptions.handle()"),this.exceptions.handle(...e)}unhandleExceptions(...e){console.warn("Deprecated: .unhandleExceptions() will be removed in winston@4. Use .exceptions.unhandle()"),this.exceptions.unhandle(...e)}cli(){throw new Error(["Logger.cli() was removed in winston@3.0.0","Use a custom winston.formats.cli() instead.","See: https://github.com/winstonjs/winston/tree/master/UPGRADE-3.0.md"].join("\n"))}_onEvent(e,t){t["__winston"+e]||(t["__winston"+e]=function(n){"error"!==e||this.transports.includes(t)||this.add(t),this.emit(e,n,t)}.bind(this),t.on(e,t["__winston"+e]))}_addDefaultMeta(e){this.defaultMeta&&Object.assign(e,this.defaultMeta)}}function v(e,t){const n=e[t];return n||0===n?n:null}Object.defineProperty(m.prototype,"transports",{configurable:!1,enumerable:!0,get(){const{pipes:e}=this._readableState;return Array.isArray(e)?e:[e].filter(Boolean)}}),e.exports=m},46:e=>{"use strict";e.exports=class{constructor(e){if(!e)throw new Error("Logger is required for profiling.");this.logger=e,this.start=Date.now()}done(...e){"function"==typeof e[e.length-1]&&(console.warn("Callback function no longer supported as of winston@3.0.0"),e.pop());const t="object"==typeof e[e.length-1]?e.pop():{};return t.level=t.level||"info",t.durationMs=Date.now()-this.start,this.logger.write(t)}}},5724:(e,t,n)=>{"use strict";const i=n(2037),r=n(8058),s=n(3420)("winston:rejection"),o=n(3138),a=n(7911),c=n(5193);e.exports=class{constructor(e){if(!e)throw new Error("Logger is required to handle rejections");this.logger=e,this.handlers=new Map}handle(...e){e.forEach((e=>{if(Array.isArray(e))return e.forEach((e=>this._addHandler(e)));this._addHandler(e)})),this.catcher||(this.catcher=this._unhandledRejection.bind(this),process.on("unhandledRejection",this.catcher))}unhandle(){this.catcher&&(process.removeListener("unhandledRejection",this.catcher),this.catcher=!1,Array.from(this.handlers.values()).forEach((e=>this.logger.unpipe(e))))}getAllInfo(e){let{message:t}=e;return t||"string"!=typeof e||(t=e),{error:e,level:"error",message:[`unhandledRejection: ${t||"(no error message)"}`,e.stack||"  No stack trace"].join("\n"),stack:e.stack,exception:!0,date:(new Date).toString(),process:this.getProcessInfo(),os:this.getOsInfo(),trace:this.getTrace(e)}}getProcessInfo(){return{pid:process.pid,uid:process.getuid?process.getuid():null,gid:process.getgid?process.getgid():null,cwd:process.cwd(),execPath:process.execPath,version:process.version,argv:process.argv,memoryUsage:process.memoryUsage()}}getOsInfo(){return{loadavg:i.loadavg(),uptime:i.uptime()}}getTrace(e){return(e?a.parse(e):a.get()).map((e=>({column:e.getColumnNumber(),file:e.getFileName(),function:e.getFunctionName(),line:e.getLineNumber(),method:e.getMethodName(),native:e.isNative()})))}_addHandler(e){if(!this.handlers.has(e)){e.handleRejections=!0;const t=new c(e);this.handlers.set(e,t),this.logger.pipe(t)}}_unhandledRejection(e){const t=this.getAllInfo(e),n=this._getRejectionHandlers();let i,a="function"==typeof this.logger.exitOnError?this.logger.exitOnError(e):this.logger.exitOnError;function c(){s("doExit",a),s("process._exiting",process._exiting),a&&!process._exiting&&(i&&clearTimeout(i),process.exit(1))}if(!n.length&&a&&(console.warn("winston: exitOnError cannot be true with no rejection handlers."),console.warn("winston: not exiting process."),a=!1),!n||0===n.length)return process.nextTick(c);r(n,((e,t)=>{const n=o(t),i=e.transport||e;function r(e){return()=>{s(e),n()}}i._ending=!0,i.once("finish",r("finished")),i.once("error",r("error"))}),(()=>a&&c())),this.logger.log(t),a&&(i=setTimeout(c,3e3))}_getRejectionHandlers(){return this.logger.transports.filter((e=>(e.transport||e).handleRejections))}}},4778:(e,t,n)=>{"use strict";const i=n(7147),{StringDecoder:r}=n(1576),{Stream:s}=n(514);function o(){}e.exports=(e,t)=>{const n=Buffer.alloc(65536),a=new r("utf8"),c=new s;let l="",u=0,h=0;return-1===e.start&&delete e.start,c.readable=!0,c.destroy=()=>{c.destroyed=!0,c.emit("end"),c.emit("close")},i.open(e.file,"a+","0644",((r,s)=>{if(r)return t?t(r):c.emit("error",r),void c.destroy();!function r(){if(!c.destroyed)return i.read(s,n,0,n.length,u,((i,s)=>{if(i)return t?t(i):c.emit("error",i),void c.destroy();if(!s)return l&&((null==e.start||h>e.start)&&(t?t(null,l):c.emit("line",l)),h++,l=""),setTimeout(r,1e3);let o=a.write(n.slice(0,s));t||c.emit("data",o),o=(l+o).split(/\n+/);const d=o.length-1;let f=0;for(;f<d;f++)(null==e.start||h>e.start)&&(t?t(null,o[f]):c.emit("line",o[f])),h++;return l=o[d],u+=s,r()}));i.close(s,o)}()})),t?c.destroy:c}},2158:(e,t,n)=>{"use strict";const i=n(2037),{LEVEL:r,MESSAGE:s}=n(5396),o=n(1037);e.exports=class extends o{constructor(e={}){super(e),this.name=e.name||"console",this.stderrLevels=this._stringArrayToSet(e.stderrLevels),this.consoleWarnLevels=this._stringArrayToSet(e.consoleWarnLevels),this.eol=e.eol||i.EOL,this.setMaxListeners(30)}log(e,t){return setImmediate((()=>this.emit("logged",e))),this.stderrLevels[e[r]]?(console._stderr?console._stderr.write(`${e[s]}${this.eol}`):console.error(e[s]),void(t&&t())):this.consoleWarnLevels[e[r]]?(console._stderr?console._stderr.write(`${e[s]}${this.eol}`):console.warn(e[s]),void(t&&t())):(console._stdout?console._stdout.write(`${e[s]}${this.eol}`):console.log(e[s]),void(t&&t()))}_stringArrayToSet(e,t){if(!e)return{};if(t=t||"Cannot make set from type other than Array of string elements",!Array.isArray(e))throw new Error(t);return e.reduce(((e,n)=>{if("string"!=typeof n)throw new Error(t);return e[n]=!0,e}),{})}}},9140:(e,t,n)=>{"use strict";const i=n(7147),r=n(1017),s=n(8415),o=n(9796),{MESSAGE:a}=n(5396),{Stream:c,PassThrough:l}=n(514),u=n(1037),h=n(3420)("winston:file"),d=n(2037),f=n(4778);e.exports=class extends u{constructor(e={}){function t(t,...n){n.slice(1).forEach((n=>{if(e[n])throw new Error(`Cannot set ${n} and ${t} together`)}))}if(super(e),this.name=e.name||"file",this._stream=new l,this._stream.setMaxListeners(30),this._onError=this._onError.bind(this),e.filename||e.dirname)t("filename or dirname","stream"),this._basename=this.filename=e.filename?r.basename(e.filename):"winston.log",this.dirname=e.dirname||r.dirname(e.filename),this.options=e.options||{flags:"a"};else{if(!e.stream)throw new Error("Cannot log to file without filename or stream.");console.warn("options.stream will be removed in winston@4. Use winston.transports.Stream"),t("stream","filename","maxsize"),this._dest=this._stream.pipe(this._setupStream(e.stream)),this.dirname=r.dirname(this._dest.path)}this.maxsize=e.maxsize||null,this.rotationFormat=e.rotationFormat||!1,this.zippedArchive=e.zippedArchive||!1,this.maxFiles=e.maxFiles||null,this.eol=e.eol||d.EOL,this.tailable=e.tailable||!1,this._size=0,this._pendingSize=0,this._created=0,this._drain=!1,this._opening=!1,this._ending=!1,this.dirname&&this._createLogDirIfNotExist(this.dirname),this.open()}finishIfEnding(){this._ending&&(this._opening?this.once("open",(()=>{this._stream.once("finish",(()=>this.emit("finish"))),setImmediate((()=>this._stream.end()))})):(this._stream.once("finish",(()=>this.emit("finish"))),setImmediate((()=>this._stream.end()))))}log(e,t=(()=>{})){if(this.silent)return t(),!0;if(this._drain)return void this._stream.once("drain",(()=>{this._drain=!1,this.log(e,t)}));if(this._rotate)return void this._stream.once("rotate",(()=>{this._rotate=!1,this.log(e,t)}));const n=`${e[a]}${this.eol}`,i=Buffer.byteLength(n);this._pendingSize+=i,this._opening&&!this.rotatedWhileOpening&&this._needsNewFile(this._size+this._pendingSize)&&(this.rotatedWhileOpening=!0);const r=this._stream.write(n,function(){this._size+=i,this._pendingSize-=i,h("logged %s %s",this._size,n),this.emit("logged",e),this._opening||this._needsNewFile()&&(this._rotate=!0,this._endStream((()=>this._rotateFile())))}.bind(this));return r?t():(this._drain=!0,this._stream.once("drain",(()=>{this._drain=!1,t()}))),h("written",r,this._drain),this.finishIfEnding(),r}query(e,t){"function"==typeof e&&(t=e,e={}),e=function(e){return(e=e||{}).rows=e.rows||e.limit||10,e.start=e.start||0,e.until=e.until||new Date,"object"!=typeof e.until&&(e.until=new Date(e.until)),e.from=e.from||e.until-864e5,"object"!=typeof e.from&&(e.from=new Date(e.from)),e.order=e.order||"desc",e}(e);const n=r.join(this.dirname,this.filename);let s="",o=[],a=0;const c=i.createReadStream(n,{encoding:"utf8"});function l(t,n){try{const n=JSON.parse(t);(function(t){if(!t)return;if("object"!=typeof t)return;const n=new Date(t.timestamp);return!(e.from&&n<e.from||e.until&&n>e.until||e.level&&e.level!==t.level)||void 0})(n)&&function(t){e.rows&&o.length>=e.rows&&"desc"!==e.order?c.readable&&c.destroy():(e.fields&&(t=e.fields.reduce(((e,n)=>(e[n]=t[n],e)),{})),"desc"===e.order&&o.length>=e.rows&&o.shift(),o.push(t))}(n)}catch(e){n||c.emit("error",e)}}c.on("error",(e=>{if(c.readable&&c.destroy(),t)return"ENOENT"!==e.code?t(e):t(null,o)})),c.on("data",(t=>{const n=(t=(s+t).split(/\n+/)).length-1;let i=0;for(;i<n;i++)(!e.start||a>=e.start)&&l(t[i]),a++;s=t[n]})),c.on("close",(()=>{s&&l(s,!0),"desc"===e.order&&(o=o.reverse()),t&&t(null,o)}))}stream(e={}){const t=r.join(this.dirname,this.filename),n=new c,i={file:t,start:e.start};return n.destroy=f(i,((e,t)=>{if(e)return n.emit("error",e);try{n.emit("data",t),t=JSON.parse(t),n.emit("log",t)}catch(e){n.emit("error",e)}})),n}open(){this.filename&&(this._opening||(this._opening=!0,this.stat(((e,t)=>{if(e)return this.emit("error",e);h("stat done: %s { size: %s }",this.filename,t),this._size=t,this._dest=this._createStream(this._stream),this._opening=!1,this.once("open",(()=>{this._stream.eventNames().includes("rotate")?this._stream.emit("rotate"):this._rotate=!1}))}))))}stat(e){const t=this._getFile(),n=r.join(this.dirname,t);i.stat(n,((i,r)=>i&&"ENOENT"===i.code?(h("ENOENT ok",n),this.filename=t,e(null,0)):i?(h(`err ${i.code} ${n}`),e(i)):!r||this._needsNewFile(r.size)?this._incFile((()=>this.stat(e))):(this.filename=t,void e(null,r.size))))}close(e){this._stream&&this._stream.end((()=>{e&&e(),this.emit("flush"),this.emit("closed")}))}_needsNewFile(e){return e=e||this._size,this.maxsize&&e>=this.maxsize}_onError(e){this.emit("error",e)}_setupStream(e){return e.on("error",this._onError),e}_cleanupStream(e){return e.removeListener("error",this._onError),e}_rotateFile(){this._incFile((()=>this.open()))}_endStream(e=(()=>{})){this._dest?(this._stream.unpipe(this._dest),this._dest.end((()=>{this._cleanupStream(this._dest),e()}))):e()}_createStream(e){const t=r.join(this.dirname,this.filename);h("create stream start",t,this.options);const n=i.createWriteStream(t,this.options).on("error",(e=>h(e))).on("close",(()=>h("close",n.path,n.bytesWritten))).on("open",(()=>{h("file open ok",t),this.emit("open",t),e.pipe(n),this.rotatedWhileOpening&&(this._stream=new l,this._stream.setMaxListeners(30),this._rotateFile(),this.rotatedWhileOpening=!1,this._cleanupStream(n),e.end())}));if(h("create stream ok",t),this.zippedArchive){const e=o.createGzip();return e.pipe(n),e}return n}_incFile(e){h("_incFile",this.filename);const t=r.extname(this._basename),n=r.basename(this._basename,t);this.tailable?this._checkMaxFilesTailable(t,n,e):(this._created+=1,this._checkMaxFilesIncrementing(t,n,e))}_getFile(){const e=r.extname(this._basename),t=r.basename(this._basename,e),n=this.rotationFormat?this.rotationFormat():this._created,i=!this.tailable&&this._created?`${t}${n}${e}`:`${t}${e}`;return this.zippedArchive&&!this.tailable?`${i}.gz`:i}_checkMaxFilesIncrementing(e,t,n){if(!this.maxFiles||this._created<this.maxFiles)return setImmediate(n);const s=this._created-this.maxFiles,o=`${t}${0!==s?s:""}${e}${this.zippedArchive?".gz":""}`,a=r.join(this.dirname,o);i.unlink(a,n)}_checkMaxFilesTailable(e,t,n){const o=[];if(!this.maxFiles)return;const a=this.zippedArchive?".gz":"";for(let n=this.maxFiles-1;n>1;n--)o.push(function(n,s){let o=`${t}${n-1}${e}${a}`;const c=r.join(this.dirname,o);i.exists(c,(l=>{if(!l)return s(null);o=`${t}${n}${e}${a}`,i.rename(c,r.join(this.dirname,o),s)}))}.bind(this,n));s(o,(()=>{i.rename(r.join(this.dirname,`${t}${e}`),r.join(this.dirname,`${t}1${e}${a}`),n)}))}_createLogDirIfNotExist(e){i.existsSync(e)||i.mkdirSync(e,{recursive:!0})}}},1734:(e,t,n)=>{"use strict";const i=n(3685),r=n(5687),{Stream:s}=n(514),o=n(1037);e.exports=class extends o{constructor(e={}){super(e),this.options=e,this.name=e.name||"http",this.ssl=!!e.ssl,this.host=e.host||"localhost",this.port=e.port,this.auth=e.auth,this.path=e.path||"",this.agent=e.agent,this.headers=e.headers||{},this.headers["content-type"]="application/json",this.port||(this.port=this.ssl?443:80)}log(e,t){this._request(e,((t,n)=>{n&&200!==n.statusCode&&(t=new Error(`Invalid HTTP Status Code: ${n.statusCode}`)),t?this.emit("warn",t):this.emit("logged",e)})),t&&setImmediate(t)}query(e,t){"function"==typeof e&&(t=e,e={}),(e={method:"query",params:this.normalizeQuery(e)}).params.path&&(e.path=e.params.path,delete e.params.path),e.params.auth&&(e.auth=e.params.auth,delete e.params.auth),this._request(e,((e,n,i)=>{if(n&&200!==n.statusCode&&(e=new Error(`Invalid HTTP Status Code: ${n.statusCode}`)),e)return t(e);if("string"==typeof i)try{i=JSON.parse(i)}catch(e){return t(e)}t(null,i)}))}stream(e={}){const t=new s;(e={method:"stream",params:e}).params.path&&(e.path=e.params.path,delete e.params.path),e.params.auth&&(e.auth=e.params.auth,delete e.params.auth);let n="";const i=this._request(e);return t.destroy=()=>i.destroy(),i.on("data",(e=>{const i=(e=(n+e).split(/\n+/)).length-1;let r=0;for(;r<i;r++)try{t.emit("log",JSON.parse(e[r]))}catch(e){t.emit("error",e)}n=e[i]})),i.on("error",(e=>t.emit("error",e))),t}_request(e,t){const n=(e=e||{}).auth||this.auth,s=e.path||this.path||"";delete e.auth,delete e.path;const o=Object.assign({},this.headers);n&&n.bearer&&(o.Authorization=`Bearer ${n.bearer}`);const a=(this.ssl?r:i).request({...this.options,method:"POST",host:this.host,port:this.port,path:`/${s.replace(/^\//,"")}`,headers:o,auth:n&&n.username&&n.password?`${n.username}:${n.password}`:"",agent:this.agent});a.on("error",t),a.on("response",(e=>e.on("end",(()=>t(null,e))).resume())),a.end(Buffer.from(JSON.stringify(e),"utf8"))}}},9840:(e,t,n)=>{"use strict";Object.defineProperty(t,"Console",{configurable:!0,enumerable:!0,get:()=>n(2158)}),Object.defineProperty(t,"File",{configurable:!0,enumerable:!0,get:()=>n(9140)}),Object.defineProperty(t,"Http",{configurable:!0,enumerable:!0,get:()=>n(1734)}),Object.defineProperty(t,"Stream",{configurable:!0,enumerable:!0,get:()=>n(4635)})},4635:(e,t,n)=>{"use strict";const i=n(4970),{MESSAGE:r}=n(5396),s=n(2037),o=n(1037);e.exports=class extends o{constructor(e={}){if(super(e),!e.stream||!i(e.stream))throw new Error("options.stream is required.");this._stream=e.stream,this._stream.setMaxListeners(1/0),this.isObjectMode=e.stream._writableState.objectMode,this.eol=e.eol||s.EOL}log(e,t){if(setImmediate((()=>this.emit("logged",e))),this.isObjectMode)return this._stream.write(e),void(t&&t());this._stream.write(`${e[r]}${this.eol}`),t&&t()}}},7897:e=>{"use strict";const t={};function n(e,n,i){i||(i=Error);class r extends i{constructor(e,t,i){super(function(e,t,i){return"string"==typeof n?n:n(e,t,i)}(e,t,i))}}r.prototype.name=i.name,r.prototype.code=e,t[e]=r}function i(e,t){if(Array.isArray(e)){const n=e.length;return e=e.map((e=>String(e))),n>2?`one of ${t} ${e.slice(0,n-1).join(", ")}, or `+e[n-1]:2===n?`one of ${t} ${e[0]} or ${e[1]}`:`of ${t} ${e[0]}`}return`of ${t} ${String(e)}`}n("ERR_INVALID_OPT_VALUE",(function(e,t){return'The value "'+t+'" is invalid for option "'+e+'"'}),TypeError),n("ERR_INVALID_ARG_TYPE",(function(e,t,n){let r;var s;let o;if("string"==typeof t&&(s="not ",t.substr(0,4)===s)?(r="must not be",t=t.replace(/^not /,"")):r="must be",function(e,t,n){return(void 0===n||n>e.length)&&(n=e.length),e.substring(n-9,n)===t}(e," argument"))o=`The ${e} ${r} ${i(t,"type")}`;else{o=`The "${e}" ${"number"!=typeof c&&(c=0),c+1>(a=e).length||-1===a.indexOf(".",c)?"argument":"property"} ${r} ${i(t,"type")}`}var a,c;return o+=". Received type "+typeof n,o}),TypeError),n("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),n("ERR_METHOD_NOT_IMPLEMENTED",(function(e){return"The "+e+" method is not implemented"})),n("ERR_STREAM_PREMATURE_CLOSE","Premature close"),n("ERR_STREAM_DESTROYED",(function(e){return"Cannot call "+e+" after a stream was destroyed"})),n("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),n("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),n("ERR_STREAM_WRITE_AFTER_END","write after end"),n("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),n("ERR_UNKNOWN_ENCODING",(function(e){return"Unknown encoding: "+e}),TypeError),n("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),e.exports.q=t},6068:(e,t,n)=>{"use strict";var i=Object.keys||function(e){var t=[];for(var n in e)t.push(n);return t};e.exports=l;var r=n(3680),s=n(3450);n(4378)(l,r);for(var o=i(s.prototype),a=0;a<o.length;a++){var c=o[a];l.prototype[c]||(l.prototype[c]=s.prototype[c])}function l(e){if(!(this instanceof l))return new l(e);r.call(this,e),s.call(this,e),this.allowHalfOpen=!0,e&&(!1===e.readable&&(this.readable=!1),!1===e.writable&&(this.writable=!1),!1===e.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",u)))}function u(){this._writableState.ended||process.nextTick(h,this)}function h(e){e.end()}Object.defineProperty(l.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(l.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(l.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(l.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}})},9812:(e,t,n)=>{"use strict";e.exports=r;var i=n(4791);function r(e){if(!(this instanceof r))return new r(e);i.call(this,e)}n(4378)(r,i),r.prototype._transform=function(e,t,n){n(null,e)}},3680:(e,t,n)=>{"use strict";var i;e.exports=S,S.ReadableState=E,n(2361).EventEmitter;var r,s=function(e,t){return e.listeners(t).length},o=n(1160),a=n(4300).Buffer,c=global.Uint8Array||function(){},l=n(3837);r=l&&l.debuglog?l.debuglog("stream"):function(){};var u,h,d,f=n(9428),p=n(502),g=n(7727).getHighWaterMark,m=n(7897).q,v=m.ERR_INVALID_ARG_TYPE,b=m.ERR_STREAM_PUSH_AFTER_EOF,y=m.ERR_METHOD_NOT_IMPLEMENTED,w=m.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;n(4378)(S,o);var _=p.errorOrDestroy,x=["error","close","destroy","pause","resume"];function E(e,t,r){i=i||n(6068),e=e||{},"boolean"!=typeof r&&(r=t instanceof i),this.objectMode=!!e.objectMode,r&&(this.objectMode=this.objectMode||!!e.readableObjectMode),this.highWaterMark=g(this,e,"readableHighWaterMark",r),this.buffer=new f,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(u||(u=n(2553).s),this.decoder=new u(e.encoding),this.encoding=e.encoding)}function S(e){if(i=i||n(6068),!(this instanceof S))return new S(e);var t=this instanceof i;this._readableState=new E(e,this,t),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy)),o.call(this)}function C(e,t,n,i,s){r("readableAddChunk",t);var o,l=e._readableState;if(null===t)l.reading=!1,function(e,t){if(r("onEofChunk"),!t.ended){if(t.decoder){var n=t.decoder.end();n&&n.length&&(t.buffer.push(n),t.length+=t.objectMode?1:n.length)}t.ended=!0,t.sync?O(e):(t.needReadable=!1,t.emittedReadable||(t.emittedReadable=!0,k(e)))}}(e,l);else if(s||(o=function(e,t){var n,i;return i=t,a.isBuffer(i)||i instanceof c||"string"==typeof t||void 0===t||e.objectMode||(n=new v("chunk",["string","Buffer","Uint8Array"],t)),n}(l,t)),o)_(e,o);else if(l.objectMode||t&&t.length>0)if("string"==typeof t||l.objectMode||Object.getPrototypeOf(t)===a.prototype||(t=function(e){return a.from(e)}(t)),i)l.endEmitted?_(e,new w):M(e,l,t,!0);else if(l.ended)_(e,new b);else{if(l.destroyed)return!1;l.reading=!1,l.decoder&&!n?(t=l.decoder.write(t),l.objectMode||0!==t.length?M(e,l,t,!1):P(e,l)):M(e,l,t,!1)}else i||(l.reading=!1,P(e,l));return!l.ended&&(l.length<l.highWaterMark||0===l.length)}function M(e,t,n,i){t.flowing&&0===t.length&&!t.sync?(t.awaitDrain=0,e.emit("data",n)):(t.length+=t.objectMode?1:n.length,i?t.buffer.unshift(n):t.buffer.push(n),t.needReadable&&O(e)),P(e,t)}Object.defineProperty(S.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),S.prototype.destroy=p.destroy,S.prototype._undestroy=p.undestroy,S.prototype._destroy=function(e,t){t(e)},S.prototype.push=function(e,t){var n,i=this._readableState;return i.objectMode?n=!0:"string"==typeof e&&((t=t||i.defaultEncoding)!==i.encoding&&(e=a.from(e,t),t=""),n=!0),C(this,e,t,!1,n)},S.prototype.unshift=function(e){return C(this,e,null,!0,!1)},S.prototype.isPaused=function(){return!1===this._readableState.flowing},S.prototype.setEncoding=function(e){u||(u=n(2553).s);var t=new u(e);this._readableState.decoder=t,this._readableState.encoding=this._readableState.decoder.encoding;for(var i=this._readableState.buffer.head,r="";null!==i;)r+=t.write(i.data),i=i.next;return this._readableState.buffer.clear(),""!==r&&this._readableState.buffer.push(r),this._readableState.length=r.length,this};var T=1073741824;function $(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=T?e=T:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function O(e){var t=e._readableState;r("emitReadable",t.needReadable,t.emittedReadable),t.needReadable=!1,t.emittedReadable||(r("emitReadable",t.flowing),t.emittedReadable=!0,process.nextTick(k,e))}function k(e){var t=e._readableState;r("emitReadable_",t.destroyed,t.length,t.ended),t.destroyed||!t.length&&!t.ended||(e.emit("readable"),t.emittedReadable=!1),t.needReadable=!t.flowing&&!t.ended&&t.length<=t.highWaterMark,L(e)}function P(e,t){t.readingMore||(t.readingMore=!0,process.nextTick(R,e,t))}function R(e,t){for(;!t.reading&&!t.ended&&(t.length<t.highWaterMark||t.flowing&&0===t.length);){var n=t.length;if(r("maybeReadMore read 0"),e.read(0),n===t.length)break}t.readingMore=!1}function A(e){var t=e._readableState;t.readableListening=e.listenerCount("readable")>0,t.resumeScheduled&&!t.paused?t.flowing=!0:e.listenerCount("data")>0&&e.resume()}function I(e){r("readable nexttick read 0"),e.read(0)}function j(e,t){r("resume",t.reading),t.reading||e.read(0),t.resumeScheduled=!1,e.emit("resume"),L(e),t.flowing&&!t.reading&&e.read(0)}function L(e){var t=e._readableState;for(r("flow",t.flowing);t.flowing&&null!==e.read(););}function D(e,t){return 0===t.length?null:(t.objectMode?n=t.buffer.shift():!e||e>=t.length?(n=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.first():t.buffer.concat(t.length),t.buffer.clear()):n=t.buffer.consume(e,t.decoder),n);var n}function N(e){var t=e._readableState;r("endReadable",t.endEmitted),t.endEmitted||(t.ended=!0,process.nextTick(B,t,e))}function B(e,t){if(r("endReadableNT",e.endEmitted,e.length),!e.endEmitted&&0===e.length&&(e.endEmitted=!0,t.readable=!1,t.emit("end"),e.autoDestroy)){var n=t._writableState;(!n||n.autoDestroy&&n.finished)&&t.destroy()}}function U(e,t){for(var n=0,i=e.length;n<i;n++)if(e[n]===t)return n;return-1}S.prototype.read=function(e){r("read",e),e=parseInt(e,10);var t=this._readableState,n=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&((0!==t.highWaterMark?t.length>=t.highWaterMark:t.length>0)||t.ended))return r("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?N(this):O(this),null;if(0===(e=$(e,t))&&t.ended)return 0===t.length&&N(this),null;var i,s=t.needReadable;return r("need readable",s),(0===t.length||t.length-e<t.highWaterMark)&&r("length less than watermark",s=!0),t.ended||t.reading?r("reading or ended",s=!1):s&&(r("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=$(n,t))),null===(i=e>0?D(e,t):null)?(t.needReadable=t.length<=t.highWaterMark,e=0):(t.length-=e,t.awaitDrain=0),0===t.length&&(t.ended||(t.needReadable=!0),n!==e&&t.ended&&N(this)),null!==i&&this.emit("data",i),i},S.prototype._read=function(e){_(this,new y("_read()"))},S.prototype.pipe=function(e,t){var n=this,i=this._readableState;switch(i.pipesCount){case 0:i.pipes=e;break;case 1:i.pipes=[i.pipes,e];break;default:i.pipes.push(e)}i.pipesCount+=1,r("pipe count=%d opts=%j",i.pipesCount,t);var o=t&&!1===t.end||e===process.stdout||e===process.stderr?p:a;function a(){r("onend"),e.end()}i.endEmitted?process.nextTick(o):n.once("end",o),e.on("unpipe",(function t(s,o){r("onunpipe"),s===n&&o&&!1===o.hasUnpiped&&(o.hasUnpiped=!0,r("cleanup"),e.removeListener("close",d),e.removeListener("finish",f),e.removeListener("drain",c),e.removeListener("error",h),e.removeListener("unpipe",t),n.removeListener("end",a),n.removeListener("end",p),n.removeListener("data",u),l=!0,!i.awaitDrain||e._writableState&&!e._writableState.needDrain||c())}));var c=function(e){return function(){var t=e._readableState;r("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&s(e,"data")&&(t.flowing=!0,L(e))}}(n);e.on("drain",c);var l=!1;function u(t){r("ondata");var s=e.write(t);r("dest.write",s),!1===s&&((1===i.pipesCount&&i.pipes===e||i.pipesCount>1&&-1!==U(i.pipes,e))&&!l&&(r("false write response, pause",i.awaitDrain),i.awaitDrain++),n.pause())}function h(t){r("onerror",t),p(),e.removeListener("error",h),0===s(e,"error")&&_(e,t)}function d(){e.removeListener("finish",f),p()}function f(){r("onfinish"),e.removeListener("close",d),p()}function p(){r("unpipe"),n.unpipe(e)}return n.on("data",u),function(e,t,n){if("function"==typeof e.prependListener)return e.prependListener(t,n);e._events&&e._events[t]?Array.isArray(e._events[t])?e._events[t].unshift(n):e._events[t]=[n,e._events[t]]:e.on(t,n)}(e,"error",h),e.once("close",d),e.once("finish",f),e.emit("pipe",n),i.flowing||(r("pipe resume"),n.resume()),e},S.prototype.unpipe=function(e){var t=this._readableState,n={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,n)),this;if(!e){var i=t.pipes,r=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var s=0;s<r;s++)i[s].emit("unpipe",this,{hasUnpiped:!1});return this}var o=U(t.pipes,e);return-1===o||(t.pipes.splice(o,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,n)),this},S.prototype.on=function(e,t){var n=o.prototype.on.call(this,e,t),i=this._readableState;return"data"===e?(i.readableListening=this.listenerCount("readable")>0,!1!==i.flowing&&this.resume()):"readable"===e&&(i.endEmitted||i.readableListening||(i.readableListening=i.needReadable=!0,i.flowing=!1,i.emittedReadable=!1,r("on readable",i.length,i.reading),i.length?O(this):i.reading||process.nextTick(I,this))),n},S.prototype.addListener=S.prototype.on,S.prototype.removeListener=function(e,t){var n=o.prototype.removeListener.call(this,e,t);return"readable"===e&&process.nextTick(A,this),n},S.prototype.removeAllListeners=function(e){var t=o.prototype.removeAllListeners.apply(this,arguments);return"readable"!==e&&void 0!==e||process.nextTick(A,this),t},S.prototype.resume=function(){var e=this._readableState;return e.flowing||(r("resume"),e.flowing=!e.readableListening,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,process.nextTick(j,e,t))}(this,e)),e.paused=!1,this},S.prototype.pause=function(){return r("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(r("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},S.prototype.wrap=function(e){var t=this,n=this._readableState,i=!1;for(var s in e.on("end",(function(){if(r("wrapped end"),n.decoder&&!n.ended){var e=n.decoder.end();e&&e.length&&t.push(e)}t.push(null)})),e.on("data",(function(s){r("wrapped data"),n.decoder&&(s=n.decoder.write(s)),n.objectMode&&null==s||(n.objectMode||s&&s.length)&&(t.push(s)||(i=!0,e.pause()))})),e)void 0===this[s]&&"function"==typeof e[s]&&(this[s]=function(t){return function(){return e[t].apply(e,arguments)}}(s));for(var o=0;o<x.length;o++)e.on(x[o],this.emit.bind(this,x[o]));return this._read=function(t){r("wrapped _read",t),i&&(i=!1,e.resume())},this},"function"==typeof Symbol&&(S.prototype[Symbol.asyncIterator]=function(){return void 0===h&&(h=n(5604)),h(this)}),Object.defineProperty(S.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(S.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(S.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}}),S._fromList=D,Object.defineProperty(S.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"==typeof Symbol&&(S.from=function(e,t){return void 0===d&&(d=n(7285)),d(S,e,t)})},4791:(e,t,n)=>{"use strict";e.exports=u;var i=n(7897).q,r=i.ERR_METHOD_NOT_IMPLEMENTED,s=i.ERR_MULTIPLE_CALLBACK,o=i.ERR_TRANSFORM_ALREADY_TRANSFORMING,a=i.ERR_TRANSFORM_WITH_LENGTH_0,c=n(6068);function l(e,t){var n=this._transformState;n.transforming=!1;var i=n.writecb;if(null===i)return this.emit("error",new s);n.writechunk=null,n.writecb=null,null!=t&&this.push(t),i(e);var r=this._readableState;r.reading=!1,(r.needReadable||r.length<r.highWaterMark)&&this._read(r.highWaterMark)}function u(e){if(!(this instanceof u))return new u(e);c.call(this,e),this._transformState={afterTransform:l.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",h)}function h(){var e=this;"function"!=typeof this._flush||this._readableState.destroyed?d(this,null,null):this._flush((function(t,n){d(e,t,n)}))}function d(e,t,n){if(t)return e.emit("error",t);if(null!=n&&e.push(n),e._writableState.length)throw new a;if(e._transformState.transforming)throw new o;return e.push(null)}n(4378)(u,c),u.prototype.push=function(e,t){return this._transformState.needTransform=!1,c.prototype.push.call(this,e,t)},u.prototype._transform=function(e,t,n){n(new r("_transform()"))},u.prototype._write=function(e,t,n){var i=this._transformState;if(i.writecb=n,i.writechunk=e,i.writeencoding=t,!i.transforming){var r=this._readableState;(i.needTransform||r.needReadable||r.length<r.highWaterMark)&&this._read(r.highWaterMark)}},u.prototype._read=function(e){var t=this._transformState;null===t.writechunk||t.transforming?t.needTransform=!0:(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform))},u.prototype._destroy=function(e,t){c.prototype._destroy.call(this,e,(function(e){t(e)}))}},3450:(e,t,n)=>{"use strict";function i(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,n){var i=e.entry;for(e.entry=null;i;){var r=i.callback;t.pendingcb--,r(undefined),i=i.next}t.corkedRequestsFree.next=e}(t,e)}}var r;e.exports=S,S.WritableState=E;var s,o={deprecate:n(1159)},a=n(1160),c=n(4300).Buffer,l=global.Uint8Array||function(){},u=n(502),h=n(7727).getHighWaterMark,d=n(7897).q,f=d.ERR_INVALID_ARG_TYPE,p=d.ERR_METHOD_NOT_IMPLEMENTED,g=d.ERR_MULTIPLE_CALLBACK,m=d.ERR_STREAM_CANNOT_PIPE,v=d.ERR_STREAM_DESTROYED,b=d.ERR_STREAM_NULL_VALUES,y=d.ERR_STREAM_WRITE_AFTER_END,w=d.ERR_UNKNOWN_ENCODING,_=u.errorOrDestroy;function x(){}function E(e,t,s){r=r||n(6068),e=e||{},"boolean"!=typeof s&&(s=t instanceof r),this.objectMode=!!e.objectMode,s&&(this.objectMode=this.objectMode||!!e.writableObjectMode),this.highWaterMark=h(this,e,"writableHighWaterMark",s),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var o=!1===e.decodeStrings;this.decodeStrings=!o,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var n=e._writableState,i=n.sync,r=n.writecb;if("function"!=typeof r)throw new g;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(n),t)!function(e,t,n,i,r){--t.pendingcb,n?(process.nextTick(r,i),process.nextTick(k,e,t),e._writableState.errorEmitted=!0,_(e,i)):(r(i),e._writableState.errorEmitted=!0,_(e,i),k(e,t))}(e,n,i,t,r);else{var s=$(n)||e.destroyed;s||n.corked||n.bufferProcessing||!n.bufferedRequest||T(e,n),i?process.nextTick(M,e,n,s,r):M(e,n,s,r)}}(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new i(this)}function S(e){var t=this instanceof(r=r||n(6068));if(!t&&!s.call(S,this))return new S(e);this._writableState=new E(e,this,t),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),a.call(this)}function C(e,t,n,i,r,s,o){t.writelen=i,t.writecb=o,t.writing=!0,t.sync=!0,t.destroyed?t.onwrite(new v("write")):n?e._writev(r,t.onwrite):e._write(r,s,t.onwrite),t.sync=!1}function M(e,t,n,i){n||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,i(),k(e,t)}function T(e,t){t.bufferProcessing=!0;var n=t.bufferedRequest;if(e._writev&&n&&n.next){var r=t.bufferedRequestCount,s=new Array(r),o=t.corkedRequestsFree;o.entry=n;for(var a=0,c=!0;n;)s[a]=n,n.isBuf||(c=!1),n=n.next,a+=1;s.allBuffers=c,C(e,t,!0,t.length,s,"",o.finish),t.pendingcb++,t.lastBufferedRequest=null,o.next?(t.corkedRequestsFree=o.next,o.next=null):t.corkedRequestsFree=new i(t),t.bufferedRequestCount=0}else{for(;n;){var l=n.chunk,u=n.encoding,h=n.callback;if(C(e,t,!1,t.objectMode?1:l.length,l,u,h),n=n.next,t.bufferedRequestCount--,t.writing)break}null===n&&(t.lastBufferedRequest=null)}t.bufferedRequest=n,t.bufferProcessing=!1}function $(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function O(e,t){e._final((function(n){t.pendingcb--,n&&_(e,n),t.prefinished=!0,e.emit("prefinish"),k(e,t)}))}function k(e,t){var n=$(t);if(n&&(function(e,t){t.prefinished||t.finalCalled||("function"!=typeof e._final||t.destroyed?(t.prefinished=!0,e.emit("prefinish")):(t.pendingcb++,t.finalCalled=!0,process.nextTick(O,e,t)))}(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"),t.autoDestroy))){var i=e._readableState;(!i||i.autoDestroy&&i.endEmitted)&&e.destroy()}return n}n(4378)(S,a),E.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(E.prototype,"buffer",{get:o.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(s=Function.prototype[Symbol.hasInstance],Object.defineProperty(S,Symbol.hasInstance,{value:function(e){return!!s.call(this,e)||this===S&&e&&e._writableState instanceof E}})):s=function(e){return e instanceof this},S.prototype.pipe=function(){_(this,new m)},S.prototype.write=function(e,t,n){var i,r=this._writableState,s=!1,o=!r.objectMode&&(i=e,c.isBuffer(i)||i instanceof l);return o&&!c.isBuffer(e)&&(e=function(e){return c.from(e)}(e)),"function"==typeof t&&(n=t,t=null),o?t="buffer":t||(t=r.defaultEncoding),"function"!=typeof n&&(n=x),r.ending?function(e,t){var n=new y;_(e,n),process.nextTick(t,n)}(this,n):(o||function(e,t,n,i){var r;return null===n?r=new b:"string"==typeof n||t.objectMode||(r=new f("chunk",["string","Buffer"],n)),!r||(_(e,r),process.nextTick(i,r),!1)}(this,r,e,n))&&(r.pendingcb++,s=function(e,t,n,i,r,s){if(!n){var o=function(e,t,n){return e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=c.from(t,n)),t}(t,i,r);i!==o&&(n=!0,r="buffer",i=o)}var a=t.objectMode?1:i.length;t.length+=a;var l=t.length<t.highWaterMark;if(l||(t.needDrain=!0),t.writing||t.corked){var u=t.lastBufferedRequest;t.lastBufferedRequest={chunk:i,encoding:r,isBuf:n,callback:s,next:null},u?u.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else C(e,t,!1,a,i,r,s);return l}(this,r,o,e,t,n)),s},S.prototype.cork=function(){this._writableState.corked++},S.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.bufferProcessing||!e.bufferedRequest||T(this,e))},S.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new w(e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(S.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(S.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),S.prototype._write=function(e,t,n){n(new p("_write()"))},S.prototype._writev=null,S.prototype.end=function(e,t,n){var i=this._writableState;return"function"==typeof e?(n=e,e=null,t=null):"function"==typeof t&&(n=t,t=null),null!=e&&this.write(e,t),i.corked&&(i.corked=1,this.uncork()),i.ending||function(e,t,n){t.ending=!0,k(e,t),n&&(t.finished?process.nextTick(n):e.once("finish",n)),t.ended=!0,e.writable=!1}(this,i,n),this},Object.defineProperty(S.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(S.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),S.prototype.destroy=u.destroy,S.prototype._undestroy=u.undestroy,S.prototype._destroy=function(e,t){t(e)}},5604:(e,t,n)=>{"use strict";var i;function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var s=n(6706),o=Symbol("lastResolve"),a=Symbol("lastReject"),c=Symbol("error"),l=Symbol("ended"),u=Symbol("lastPromise"),h=Symbol("handlePromise"),d=Symbol("stream");function f(e,t){return{value:e,done:t}}function p(e){var t=e[o];if(null!==t){var n=e[d].read();null!==n&&(e[u]=null,e[o]=null,e[a]=null,t(f(n,!1)))}}function g(e){process.nextTick(p,e)}var m=Object.getPrototypeOf((function(){})),v=Object.setPrototypeOf((r(i={get stream(){return this[d]},next:function(){var e=this,t=this[c];if(null!==t)return Promise.reject(t);if(this[l])return Promise.resolve(f(void 0,!0));if(this[d].destroyed)return new Promise((function(t,n){process.nextTick((function(){e[c]?n(e[c]):t(f(void 0,!0))}))}));var n,i=this[u];if(i)n=new Promise(function(e,t){return function(n,i){e.then((function(){t[l]?n(f(void 0,!0)):t[h](n,i)}),i)}}(i,this));else{var r=this[d].read();if(null!==r)return Promise.resolve(f(r,!1));n=new Promise(this[h])}return this[u]=n,n}},Symbol.asyncIterator,(function(){return this})),r(i,"return",(function(){var e=this;return new Promise((function(t,n){e[d].destroy(null,(function(e){e?n(e):t(f(void 0,!0))}))}))})),i),m);e.exports=function(e){var t,n=Object.create(v,(r(t={},d,{value:e,writable:!0}),r(t,o,{value:null,writable:!0}),r(t,a,{value:null,writable:!0}),r(t,c,{value:null,writable:!0}),r(t,l,{value:e._readableState.endEmitted,writable:!0}),r(t,h,{value:function(e,t){var i=n[d].read();i?(n[u]=null,n[o]=null,n[a]=null,e(f(i,!1))):(n[o]=e,n[a]=t)},writable:!0}),t));return n[u]=null,s(e,(function(e){if(e&&"ERR_STREAM_PREMATURE_CLOSE"!==e.code){var t=n[a];return null!==t&&(n[u]=null,n[o]=null,n[a]=null,t(e)),void(n[c]=e)}var i=n[o];null!==i&&(n[u]=null,n[o]=null,n[a]=null,i(f(void 0,!0))),n[l]=!0})),e.on("readable",g.bind(null,n)),n}},9428:(e,t,n)=>{"use strict";function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var o=n(4300).Buffer,a=n(3837).inspect,c=a&&a.custom||"inspect";e.exports=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.head=null,this.tail=null,this.length=0}var t,n;return t=e,n=[{key:"push",value:function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length}},{key:"unshift",value:function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length}},{key:"shift",value:function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(e){if(0===this.length)return"";for(var t=this.head,n=""+t.data;t=t.next;)n+=e+t.data;return n}},{key:"concat",value:function(e){if(0===this.length)return o.alloc(0);for(var t,n,i,r=o.allocUnsafe(e>>>0),s=this.head,a=0;s;)t=s.data,n=r,i=a,o.prototype.copy.call(t,n,i),a+=s.data.length,s=s.next;return r}},{key:"consume",value:function(e,t){var n;return e<this.head.data.length?(n=this.head.data.slice(0,e),this.head.data=this.head.data.slice(e)):n=e===this.head.data.length?this.shift():t?this._getString(e):this._getBuffer(e),n}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(e){var t=this.head,n=1,i=t.data;for(e-=i.length;t=t.next;){var r=t.data,s=e>r.length?r.length:e;if(s===r.length?i+=r:i+=r.slice(0,e),0==(e-=s)){s===r.length?(++n,t.next?this.head=t.next:this.head=this.tail=null):(this.head=t,t.data=r.slice(s));break}++n}return this.length-=n,i}},{key:"_getBuffer",value:function(e){var t=o.allocUnsafe(e),n=this.head,i=1;for(n.data.copy(t),e-=n.data.length;n=n.next;){var r=n.data,s=e>r.length?r.length:e;if(r.copy(t,t.length-e,0,s),0==(e-=s)){s===r.length?(++i,n.next?this.head=n.next:this.head=this.tail=null):(this.head=n,n.data=r.slice(s));break}++i}return this.length-=i,t}},{key:c,value:function(e,t){return a(this,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},t,{depth:0,customInspect:!1}))}}],n&&s(t.prototype,n),e}()},502:e=>{"use strict";function t(e,t){i(e,t),n(e)}function n(e){e._writableState&&!e._writableState.emitClose||e._readableState&&!e._readableState.emitClose||e.emit("close")}function i(e,t){e.emit("error",t)}e.exports={destroy:function(e,r){var s=this,o=this._readableState&&this._readableState.destroyed,a=this._writableState&&this._writableState.destroyed;return o||a?(r?r(e):e&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,process.nextTick(i,this,e)):process.nextTick(i,this,e)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,(function(e){!r&&e?s._writableState?s._writableState.errorEmitted?process.nextTick(n,s):(s._writableState.errorEmitted=!0,process.nextTick(t,s,e)):process.nextTick(t,s,e):r?(process.nextTick(n,s),r(e)):process.nextTick(n,s)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(e,t){var n=e._readableState,i=e._writableState;n&&n.autoDestroy||i&&i.autoDestroy?e.destroy(t):e.emit("error",t)}}},6706:(e,t,n)=>{"use strict";var i=n(7897).q.ERR_STREAM_PREMATURE_CLOSE;function r(){}e.exports=function e(t,n,s){if("function"==typeof n)return e(t,null,n);n||(n={}),s=function(e){var t=!1;return function(){if(!t){t=!0;for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];e.apply(this,i)}}}(s||r);var o=n.readable||!1!==n.readable&&t.readable,a=n.writable||!1!==n.writable&&t.writable,c=function(){t.writable||u()},l=t._writableState&&t._writableState.finished,u=function(){a=!1,l=!0,o||s.call(t)},h=t._readableState&&t._readableState.endEmitted,d=function(){o=!1,h=!0,a||s.call(t)},f=function(e){s.call(t,e)},p=function(){var e;return o&&!h?(t._readableState&&t._readableState.ended||(e=new i),s.call(t,e)):a&&!l?(t._writableState&&t._writableState.ended||(e=new i),s.call(t,e)):void 0},g=function(){t.req.on("finish",u)};return function(e){return e.setHeader&&"function"==typeof e.abort}(t)?(t.on("complete",u),t.on("abort",p),t.req?g():t.on("request",g)):a&&!t._writableState&&(t.on("end",c),t.on("close",c)),t.on("end",d),t.on("finish",u),!1!==n.error&&t.on("error",f),t.on("close",p),function(){t.removeListener("complete",u),t.removeListener("abort",p),t.removeListener("request",g),t.req&&t.req.removeListener("finish",u),t.removeListener("end",c),t.removeListener("close",c),t.removeListener("finish",u),t.removeListener("end",d),t.removeListener("error",f),t.removeListener("close",p)}}},7285:(e,t,n)=>{"use strict";function i(e,t,n,i,r,s,o){try{var a=e[s](o),c=a.value}catch(e){return void n(e)}a.done?t(c):Promise.resolve(c).then(i,r)}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var o=n(7897).q.ERR_INVALID_ARG_TYPE;e.exports=function(e,t,n){var a;if(t&&"function"==typeof t.next)a=t;else if(t&&t[Symbol.asyncIterator])a=t[Symbol.asyncIterator]();else{if(!t||!t[Symbol.iterator])throw new o("iterable",["Iterable"],t);a=t[Symbol.iterator]()}var c=new e(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({objectMode:!0},n)),l=!1;function u(){return h.apply(this,arguments)}function h(){var e;return e=function*(){try{var e=yield a.next(),t=e.value;e.done?c.push(null):c.push(yield t)?u():l=!1}catch(e){c.destroy(e)}},h=function(){var t=this,n=arguments;return new Promise((function(r,s){var o=e.apply(t,n);function a(e){i(o,r,s,a,c,"next",e)}function c(e){i(o,r,s,a,c,"throw",e)}a(void 0)}))},h.apply(this,arguments)}return c._read=function(){l||(l=!0,u())},c}},3967:(e,t,n)=>{"use strict";var i,r=n(7897).q,s=r.ERR_MISSING_ARGS,o=r.ERR_STREAM_DESTROYED;function a(e){if(e)throw e}function c(e){e()}function l(e,t){return e.pipe(t)}e.exports=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var u,h=function(e){return e.length?"function"!=typeof e[e.length-1]?a:e.pop():a}(t);if(Array.isArray(t[0])&&(t=t[0]),t.length<2)throw new s("streams");var d=t.map((function(e,r){var s=r<t.length-1;return function(e,t,r,s){s=function(e){var t=!1;return function(){t||(t=!0,e.apply(void 0,arguments))}}(s);var a=!1;e.on("close",(function(){a=!0})),void 0===i&&(i=n(6706)),i(e,{readable:t,writable:r},(function(e){if(e)return s(e);a=!0,s()}));var c=!1;return function(t){if(!a&&!c)return c=!0,function(e){return e.setHeader&&"function"==typeof e.abort}(e)?e.abort():"function"==typeof e.destroy?e.destroy():void s(t||new o("pipe"))}}(e,s,r>0,(function(e){u||(u=e),e&&d.forEach(c),s||(d.forEach(c),h(u))}))}));return t.reduce(l)}},7727:(e,t,n)=>{"use strict";var i=n(7897).q.ERR_INVALID_OPT_VALUE;e.exports={getHighWaterMark:function(e,t,n,r){var s=function(e,t,n){return null!=e.highWaterMark?e.highWaterMark:t?e[n]:null}(t,r,n);if(null!=s){if(!isFinite(s)||Math.floor(s)!==s||s<0)throw new i(r?n:"highWaterMark",s);return Math.floor(s)}return e.objectMode?16:16384}}},1160:(e,t,n)=>{e.exports=n(2781)},514:(e,t,n)=>{var i=n(2781);"disable"===process.env.READABLE_STREAM&&i?(e.exports=i.Readable,Object.assign(e.exports,i),e.exports.Stream=i):((t=e.exports=n(3680)).Stream=i||t,t.Readable=t,t.Writable=n(3450),t.Duplex=n(6068),t.Transform=n(4791),t.PassThrough=n(9812),t.finished=n(6706),t.pipeline=n(3967))},4300:e=>{"use strict";e.exports=require("buffer")},2361:e=>{"use strict";e.exports=require("events")},7147:e=>{"use strict";e.exports=require("fs")},3685:e=>{"use strict";e.exports=require("http")},5687:e=>{"use strict";e.exports=require("https")},8188:e=>{"use strict";e.exports=require("module")},1808:e=>{"use strict";e.exports=require("net")},2037:e=>{"use strict";e.exports=require("os")},1017:e=>{"use strict";e.exports=require("path")},2781:e=>{"use strict";e.exports=require("stream")},1576:e=>{"use strict";e.exports=require("string_decoder")},3837:e=>{"use strict";e.exports=require("util")},9796:e=>{"use strict";e.exports=require("zlib")},9676:(e,t,n)=>{"use strict";n.r(t),n.d(t,{DataViewIndexOutOfBoundsError:()=>F,DecodeError:()=>w,Decoder:()=>H,EXT_TIMESTAMP:()=>_,Encoder:()=>R,ExtData:()=>b,ExtensionCodec:()=>k,decode:()=>G,decodeArrayStream:()=>ne,decodeAsync:()=>te,decodeMulti:()=>Y,decodeMultiStream:()=>ie,decodeStream:()=>re,decodeTimestampExtension:()=>$,decodeTimestampToTimeSpec:()=>T,encode:()=>I,encodeDateToTimeSpec:()=>C,encodeTimeSpecToTimestamp:()=>S,encodeTimestampExtension:()=>M});var i,r,s,o=4294967295;function a(e,t,n){var i=Math.floor(n/4294967296),r=n;e.setUint32(t,i),e.setUint32(t+4,r)}function c(e,t){return 4294967296*e.getInt32(t)+e.getUint32(t+4)}var l=("undefined"==typeof process||"never"!==(null===(i=null===process||void 0===process?void 0:process.env)||void 0===i?void 0:i.TEXT_ENCODING))&&"undefined"!=typeof TextEncoder&&"undefined"!=typeof TextDecoder;function u(e){for(var t=e.length,n=0,i=0;i<t;){var r=e.charCodeAt(i++);if(0!=(4294967168&r))if(0==(4294965248&r))n+=2;else{if(r>=55296&&r<=56319&&i<t){var s=e.charCodeAt(i);56320==(64512&s)&&(++i,r=((1023&r)<<10)+(1023&s)+65536)}n+=0==(4294901760&r)?3:4}else n++}return n}var h=l?new TextEncoder:void 0,d=l?"undefined"!=typeof process&&"force"!==(null===(r=null===process||void 0===process?void 0:process.env)||void 0===r?void 0:r.TEXT_ENCODING)?200:0:o,f=(null==h?void 0:h.encodeInto)?function(e,t,n){h.encodeInto(e,t.subarray(n))}:function(e,t,n){t.set(h.encode(e),n)};function p(e,t,n){for(var i=t,r=i+n,s=[],o="";i<r;){var a=e[i++];if(0==(128&a))s.push(a);else if(192==(224&a)){var c=63&e[i++];s.push((31&a)<<6|c)}else if(224==(240&a)){c=63&e[i++];var l=63&e[i++];s.push((31&a)<<12|c<<6|l)}else if(240==(248&a)){var u=(7&a)<<18|(c=63&e[i++])<<12|(l=63&e[i++])<<6|63&e[i++];u>65535&&(u-=65536,s.push(u>>>10&1023|55296),u=56320|1023&u),s.push(u)}else s.push(a);s.length>=4096&&(o+=String.fromCharCode.apply(String,s),s.length=0)}return s.length>0&&(o+=String.fromCharCode.apply(String,s)),o}var g,m=l?new TextDecoder:null,v=l?"undefined"!=typeof process&&"force"!==(null===(s=null===process||void 0===process?void 0:process.env)||void 0===s?void 0:s.TEXT_DECODER)?200:0:o,b=function(e,t){this.type=e,this.data=t},y=(g=function(e,t){return g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},g(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}g(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),w=function(e){function t(n){var i=e.call(this,n)||this,r=Object.create(t.prototype);return Object.setPrototypeOf(i,r),Object.defineProperty(i,"name",{configurable:!0,enumerable:!1,value:t.name}),i}return y(t,e),t}(Error),_=-1,x=4294967295,E=17179869183;function S(e){var t,n=e.sec,i=e.nsec;if(n>=0&&i>=0&&n<=E){if(0===i&&n<=x){var r=new Uint8Array(4);return(t=new DataView(r.buffer)).setUint32(0,n),r}var s=n/4294967296,o=4294967295&n;return r=new Uint8Array(8),(t=new DataView(r.buffer)).setUint32(0,i<<2|3&s),t.setUint32(4,o),r}return r=new Uint8Array(12),(t=new DataView(r.buffer)).setUint32(0,i),a(t,4,n),r}function C(e){var t=e.getTime(),n=Math.floor(t/1e3),i=1e6*(t-1e3*n),r=Math.floor(i/1e9);return{sec:n+r,nsec:i-1e9*r}}function M(e){return e instanceof Date?S(C(e)):null}function T(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);switch(e.byteLength){case 4:return{sec:t.getUint32(0),nsec:0};case 8:var n=t.getUint32(0);return{sec:4294967296*(3&n)+t.getUint32(4),nsec:n>>>2};case 12:return{sec:c(t,4),nsec:t.getUint32(0)};default:throw new w("Unrecognized data size for timestamp (expected 4, 8, or 12): ".concat(e.length))}}function $(e){var t=T(e);return new Date(1e3*t.sec+t.nsec/1e6)}var O={type:_,encode:M,decode:$},k=function(){function e(){this.builtInEncoders=[],this.builtInDecoders=[],this.encoders=[],this.decoders=[],this.register(O)}return e.prototype.register=function(e){var t=e.type,n=e.encode,i=e.decode;if(t>=0)this.encoders[t]=n,this.decoders[t]=i;else{var r=1+t;this.builtInEncoders[r]=n,this.builtInDecoders[r]=i}},e.prototype.tryToEncode=function(e,t){for(var n=0;n<this.builtInEncoders.length;n++)if(null!=(i=this.builtInEncoders[n])&&null!=(r=i(e,t)))return new b(-1-n,r);for(n=0;n<this.encoders.length;n++){var i,r;if(null!=(i=this.encoders[n])&&null!=(r=i(e,t)))return new b(n,r)}return e instanceof b?e:null},e.prototype.decode=function(e,t,n){var i=t<0?this.builtInDecoders[-1-t]:this.decoders[t];return i?i(e,t,n):new b(t,e)},e.defaultCodec=new e,e}();function P(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e instanceof ArrayBuffer?new Uint8Array(e):Uint8Array.from(e)}var R=function(){function e(e,t,n,i,r,s,o,a){void 0===e&&(e=k.defaultCodec),void 0===t&&(t=void 0),void 0===n&&(n=100),void 0===i&&(i=2048),void 0===r&&(r=!1),void 0===s&&(s=!1),void 0===o&&(o=!1),void 0===a&&(a=!1),this.extensionCodec=e,this.context=t,this.maxDepth=n,this.initialBufferSize=i,this.sortKeys=r,this.forceFloat32=s,this.ignoreUndefined=o,this.forceIntegerToFloat=a,this.pos=0,this.view=new DataView(new ArrayBuffer(this.initialBufferSize)),this.bytes=new Uint8Array(this.view.buffer)}return e.prototype.reinitializeState=function(){this.pos=0},e.prototype.encodeSharedRef=function(e){return this.reinitializeState(),this.doEncode(e,1),this.bytes.subarray(0,this.pos)},e.prototype.encode=function(e){return this.reinitializeState(),this.doEncode(e,1),this.bytes.slice(0,this.pos)},e.prototype.doEncode=function(e,t){if(t>this.maxDepth)throw new Error("Too deep objects in depth ".concat(t));null==e?this.encodeNil():"boolean"==typeof e?this.encodeBoolean(e):"number"==typeof e?this.encodeNumber(e):"string"==typeof e?this.encodeString(e):this.encodeObject(e,t)},e.prototype.ensureBufferSizeToWrite=function(e){var t=this.pos+e;this.view.byteLength<t&&this.resizeBuffer(2*t)},e.prototype.resizeBuffer=function(e){var t=new ArrayBuffer(e),n=new Uint8Array(t),i=new DataView(t);n.set(this.bytes),this.view=i,this.bytes=n},e.prototype.encodeNil=function(){this.writeU8(192)},e.prototype.encodeBoolean=function(e){!1===e?this.writeU8(194):this.writeU8(195)},e.prototype.encodeNumber=function(e){Number.isSafeInteger(e)&&!this.forceIntegerToFloat?e>=0?e<128?this.writeU8(e):e<256?(this.writeU8(204),this.writeU8(e)):e<65536?(this.writeU8(205),this.writeU16(e)):e<4294967296?(this.writeU8(206),this.writeU32(e)):(this.writeU8(207),this.writeU64(e)):e>=-32?this.writeU8(224|e+32):e>=-128?(this.writeU8(208),this.writeI8(e)):e>=-32768?(this.writeU8(209),this.writeI16(e)):e>=-2147483648?(this.writeU8(210),this.writeI32(e)):(this.writeU8(211),this.writeI64(e)):this.forceFloat32?(this.writeU8(202),this.writeF32(e)):(this.writeU8(203),this.writeF64(e))},e.prototype.writeStringHeader=function(e){if(e<32)this.writeU8(160+e);else if(e<256)this.writeU8(217),this.writeU8(e);else if(e<65536)this.writeU8(218),this.writeU16(e);else{if(!(e<4294967296))throw new Error("Too long string: ".concat(e," bytes in UTF-8"));this.writeU8(219),this.writeU32(e)}},e.prototype.encodeString=function(e){if(e.length>d){var t=u(e);this.ensureBufferSizeToWrite(5+t),this.writeStringHeader(t),f(e,this.bytes,this.pos),this.pos+=t}else t=u(e),this.ensureBufferSizeToWrite(5+t),this.writeStringHeader(t),function(e,t,n){for(var i=e.length,r=n,s=0;s<i;){var o=e.charCodeAt(s++);if(0!=(4294967168&o)){if(0==(4294965248&o))t[r++]=o>>6&31|192;else{if(o>=55296&&o<=56319&&s<i){var a=e.charCodeAt(s);56320==(64512&a)&&(++s,o=((1023&o)<<10)+(1023&a)+65536)}0==(4294901760&o)?(t[r++]=o>>12&15|224,t[r++]=o>>6&63|128):(t[r++]=o>>18&7|240,t[r++]=o>>12&63|128,t[r++]=o>>6&63|128)}t[r++]=63&o|128}else t[r++]=o}}(e,this.bytes,this.pos),this.pos+=t},e.prototype.encodeObject=function(e,t){var n=this.extensionCodec.tryToEncode(e,this.context);if(null!=n)this.encodeExtension(n);else if(Array.isArray(e))this.encodeArray(e,t);else if(ArrayBuffer.isView(e))this.encodeBinary(e);else{if("object"!=typeof e)throw new Error("Unrecognized object: ".concat(Object.prototype.toString.apply(e)));this.encodeMap(e,t)}},e.prototype.encodeBinary=function(e){var t=e.byteLength;if(t<256)this.writeU8(196),this.writeU8(t);else if(t<65536)this.writeU8(197),this.writeU16(t);else{if(!(t<4294967296))throw new Error("Too large binary: ".concat(t));this.writeU8(198),this.writeU32(t)}var n=P(e);this.writeU8a(n)},e.prototype.encodeArray=function(e,t){var n=e.length;if(n<16)this.writeU8(144+n);else if(n<65536)this.writeU8(220),this.writeU16(n);else{if(!(n<4294967296))throw new Error("Too large array: ".concat(n));this.writeU8(221),this.writeU32(n)}for(var i=0,r=e;i<r.length;i++){var s=r[i];this.doEncode(s,t+1)}},e.prototype.countWithoutUndefined=function(e,t){for(var n=0,i=0,r=t;i<r.length;i++)void 0!==e[r[i]]&&n++;return n},e.prototype.encodeMap=function(e,t){var n=Object.keys(e);this.sortKeys&&n.sort();var i=this.ignoreUndefined?this.countWithoutUndefined(e,n):n.length;if(i<16)this.writeU8(128+i);else if(i<65536)this.writeU8(222),this.writeU16(i);else{if(!(i<4294967296))throw new Error("Too large map object: ".concat(i));this.writeU8(223),this.writeU32(i)}for(var r=0,s=n;r<s.length;r++){var o=s[r],a=e[o];this.ignoreUndefined&&void 0===a||(this.encodeString(o),this.doEncode(a,t+1))}},e.prototype.encodeExtension=function(e){var t=e.data.length;if(1===t)this.writeU8(212);else if(2===t)this.writeU8(213);else if(4===t)this.writeU8(214);else if(8===t)this.writeU8(215);else if(16===t)this.writeU8(216);else if(t<256)this.writeU8(199),this.writeU8(t);else if(t<65536)this.writeU8(200),this.writeU16(t);else{if(!(t<4294967296))throw new Error("Too large extension object: ".concat(t));this.writeU8(201),this.writeU32(t)}this.writeI8(e.type),this.writeU8a(e.data)},e.prototype.writeU8=function(e){this.ensureBufferSizeToWrite(1),this.view.setUint8(this.pos,e),this.pos++},e.prototype.writeU8a=function(e){var t=e.length;this.ensureBufferSizeToWrite(t),this.bytes.set(e,this.pos),this.pos+=t},e.prototype.writeI8=function(e){this.ensureBufferSizeToWrite(1),this.view.setInt8(this.pos,e),this.pos++},e.prototype.writeU16=function(e){this.ensureBufferSizeToWrite(2),this.view.setUint16(this.pos,e),this.pos+=2},e.prototype.writeI16=function(e){this.ensureBufferSizeToWrite(2),this.view.setInt16(this.pos,e),this.pos+=2},e.prototype.writeU32=function(e){this.ensureBufferSizeToWrite(4),this.view.setUint32(this.pos,e),this.pos+=4},e.prototype.writeI32=function(e){this.ensureBufferSizeToWrite(4),this.view.setInt32(this.pos,e),this.pos+=4},e.prototype.writeF32=function(e){this.ensureBufferSizeToWrite(4),this.view.setFloat32(this.pos,e),this.pos+=4},e.prototype.writeF64=function(e){this.ensureBufferSizeToWrite(8),this.view.setFloat64(this.pos,e),this.pos+=8},e.prototype.writeU64=function(e){this.ensureBufferSizeToWrite(8),function(e,t,n){var i=n/4294967296,r=n;e.setUint32(t,i),e.setUint32(t+4,r)}(this.view,this.pos,e),this.pos+=8},e.prototype.writeI64=function(e){this.ensureBufferSizeToWrite(8),a(this.view,this.pos,e),this.pos+=8},e}(),A={};function I(e,t){return void 0===t&&(t=A),new R(t.extensionCodec,t.context,t.maxDepth,t.initialBufferSize,t.sortKeys,t.forceFloat32,t.ignoreUndefined,t.forceIntegerToFloat).encodeSharedRef(e)}function j(e){return"".concat(e<0?"-":"","0x").concat(Math.abs(e).toString(16).padStart(2,"0"))}var L=function(){function e(e,t){void 0===e&&(e=16),void 0===t&&(t=16),this.maxKeyLength=e,this.maxLengthPerKey=t,this.hit=0,this.miss=0,this.caches=[];for(var n=0;n<this.maxKeyLength;n++)this.caches.push([])}return e.prototype.canBeCached=function(e){return e>0&&e<=this.maxKeyLength},e.prototype.find=function(e,t,n){e:for(var i=0,r=this.caches[n-1];i<r.length;i++){for(var s=r[i],o=s.bytes,a=0;a<n;a++)if(o[a]!==e[t+a])continue e;return s.str}return null},e.prototype.store=function(e,t){var n=this.caches[e.length-1],i={bytes:e,str:t};n.length>=this.maxLengthPerKey?n[Math.random()*n.length|0]=i:n.push(i)},e.prototype.decode=function(e,t,n){var i=this.find(e,t,n);if(null!=i)return this.hit++,i;this.miss++;var r=p(e,t,n),s=Uint8Array.prototype.slice.call(e,t,t+n);return this.store(s,r),r},e}(),D=function(e,t){var n,i,r,s,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,i&&(r=2&s[0]?i.return:s[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,s[1])).done)return r;switch(i=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,i=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((r=(r=o.trys).length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){o.label=s[1];break}if(6===s[0]&&o.label<r[1]){o.label=r[1],r=s;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(s);break}r[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],i=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}},N=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(n){t[n]=e[n]&&function(t){return new Promise((function(i,r){!function(e,t,n,i){Promise.resolve(i).then((function(t){e({value:t,done:n})}),t)}(i,r,(t=e[n](t)).done,t.value)}))}}},B=function(e){return this instanceof B?(this.v=e,this):new B(e)},U=new DataView(new ArrayBuffer(0)),q=new Uint8Array(U.buffer),F=function(){try{U.getInt8(0)}catch(e){return e.constructor}throw new Error("never reached")}(),W=new F("Insufficient data"),V=new L,H=function(){function e(e,t,n,i,r,s,a,c){void 0===e&&(e=k.defaultCodec),void 0===t&&(t=void 0),void 0===n&&(n=o),void 0===i&&(i=o),void 0===r&&(r=o),void 0===s&&(s=o),void 0===a&&(a=o),void 0===c&&(c=V),this.extensionCodec=e,this.context=t,this.maxStrLength=n,this.maxBinLength=i,this.maxArrayLength=r,this.maxMapLength=s,this.maxExtLength=a,this.keyDecoder=c,this.totalPos=0,this.pos=0,this.view=U,this.bytes=q,this.headByte=-1,this.stack=[]}return e.prototype.reinitializeState=function(){this.totalPos=0,this.headByte=-1,this.stack.length=0},e.prototype.setBuffer=function(e){this.bytes=P(e),this.view=function(e){if(e instanceof ArrayBuffer)return new DataView(e);var t=P(e);return new DataView(t.buffer,t.byteOffset,t.byteLength)}(this.bytes),this.pos=0},e.prototype.appendBuffer=function(e){if(-1!==this.headByte||this.hasRemaining(1)){var t=this.bytes.subarray(this.pos),n=P(e),i=new Uint8Array(t.length+n.length);i.set(t),i.set(n,t.length),this.setBuffer(i)}else this.setBuffer(e)},e.prototype.hasRemaining=function(e){return this.view.byteLength-this.pos>=e},e.prototype.createExtraByteError=function(e){var t=this.view,n=this.pos;return new RangeError("Extra ".concat(t.byteLength-n," of ").concat(t.byteLength," byte(s) found at buffer[").concat(e,"]"))},e.prototype.decode=function(e){this.reinitializeState(),this.setBuffer(e);var t=this.doDecodeSync();if(this.hasRemaining(1))throw this.createExtraByteError(this.pos);return t},e.prototype.decodeMulti=function(e){return D(this,(function(t){switch(t.label){case 0:this.reinitializeState(),this.setBuffer(e),t.label=1;case 1:return this.hasRemaining(1)?[4,this.doDecodeSync()]:[3,3];case 2:return t.sent(),[3,1];case 3:return[2]}}))},e.prototype.decodeAsync=function(e){var t,n,i,r,s,o,a,c;return s=this,o=void 0,c=function(){var s,o,a,c,l,u,h,d;return D(this,(function(f){switch(f.label){case 0:s=!1,f.label=1;case 1:f.trys.push([1,6,7,12]),t=N(e),f.label=2;case 2:return[4,t.next()];case 3:if((n=f.sent()).done)return[3,5];if(a=n.value,s)throw this.createExtraByteError(this.totalPos);this.appendBuffer(a);try{o=this.doDecodeSync(),s=!0}catch(e){if(!(e instanceof F))throw e}this.totalPos+=this.pos,f.label=4;case 4:return[3,2];case 5:return[3,12];case 6:return c=f.sent(),i={error:c},[3,12];case 7:return f.trys.push([7,,10,11]),n&&!n.done&&(r=t.return)?[4,r.call(t)]:[3,9];case 8:f.sent(),f.label=9;case 9:return[3,11];case 10:if(i)throw i.error;return[7];case 11:return[7];case 12:if(s){if(this.hasRemaining(1))throw this.createExtraByteError(this.totalPos);return[2,o]}throw u=(l=this).headByte,h=l.pos,d=l.totalPos,new RangeError("Insufficient data in parsing ".concat(j(u)," at ").concat(d," (").concat(h," in the current buffer)"))}}))},new((a=void 0)||(a=Promise))((function(e,t){function n(e){try{r(c.next(e))}catch(e){t(e)}}function i(e){try{r(c.throw(e))}catch(e){t(e)}}function r(t){var r;t.done?e(t.value):(r=t.value,r instanceof a?r:new a((function(e){e(r)}))).then(n,i)}r((c=c.apply(s,o||[])).next())}))},e.prototype.decodeArrayStream=function(e){return this.decodeMultiAsync(e,!0)},e.prototype.decodeStream=function(e){return this.decodeMultiAsync(e,!1)},e.prototype.decodeMultiAsync=function(e,t){return function(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,r=n.apply(e,t||[]),s=[];return i={},o("next"),o("throw"),o("return"),i[Symbol.asyncIterator]=function(){return this},i;function o(e){r[e]&&(i[e]=function(t){return new Promise((function(n,i){s.push([e,t,n,i])>1||a(e,t)}))})}function a(e,t){try{(n=r[e](t)).value instanceof B?Promise.resolve(n.value.v).then(c,l):u(s[0][2],n)}catch(e){u(s[0][3],e)}var n}function c(e){a("next",e)}function l(e){a("throw",e)}function u(e,t){e(t),s.shift(),s.length&&a(s[0][0],s[0][1])}}(this,arguments,(function(){var n,i,r,s,o,a,c,l,u;return D(this,(function(h){switch(h.label){case 0:n=t,i=-1,h.label=1;case 1:h.trys.push([1,13,14,19]),r=N(e),h.label=2;case 2:return[4,B(r.next())];case 3:if((s=h.sent()).done)return[3,12];if(o=s.value,t&&0===i)throw this.createExtraByteError(this.totalPos);this.appendBuffer(o),n&&(i=this.readArraySize(),n=!1,this.complete()),h.label=4;case 4:h.trys.push([4,9,,10]),h.label=5;case 5:return[4,B(this.doDecodeSync())];case 6:return[4,h.sent()];case 7:return h.sent(),0==--i?[3,8]:[3,5];case 8:return[3,10];case 9:if(!((a=h.sent())instanceof F))throw a;return[3,10];case 10:this.totalPos+=this.pos,h.label=11;case 11:return[3,2];case 12:return[3,19];case 13:return c=h.sent(),l={error:c},[3,19];case 14:return h.trys.push([14,,17,18]),s&&!s.done&&(u=r.return)?[4,B(u.call(r))]:[3,16];case 15:h.sent(),h.label=16;case 16:return[3,18];case 17:if(l)throw l.error;return[7];case 18:return[7];case 19:return[2]}}))}))},e.prototype.doDecodeSync=function(){e:for(;;){var e=this.readHeadByte(),t=void 0;if(e>=224)t=e-256;else if(e<192)if(e<128)t=e;else if(e<144){if(0!=(i=e-128)){this.pushMapState(i),this.complete();continue e}t={}}else if(e<160){if(0!=(i=e-144)){this.pushArrayState(i),this.complete();continue e}t=[]}else{var n=e-160;t=this.decodeUtf8String(n,0)}else if(192===e)t=null;else if(194===e)t=!1;else if(195===e)t=!0;else if(202===e)t=this.readF32();else if(203===e)t=this.readF64();else if(204===e)t=this.readU8();else if(205===e)t=this.readU16();else if(206===e)t=this.readU32();else if(207===e)t=this.readU64();else if(208===e)t=this.readI8();else if(209===e)t=this.readI16();else if(210===e)t=this.readI32();else if(211===e)t=this.readI64();else if(217===e)n=this.lookU8(),t=this.decodeUtf8String(n,1);else if(218===e)n=this.lookU16(),t=this.decodeUtf8String(n,2);else if(219===e)n=this.lookU32(),t=this.decodeUtf8String(n,4);else if(220===e){if(0!==(i=this.readU16())){this.pushArrayState(i),this.complete();continue e}t=[]}else if(221===e){if(0!==(i=this.readU32())){this.pushArrayState(i),this.complete();continue e}t=[]}else if(222===e){if(0!==(i=this.readU16())){this.pushMapState(i),this.complete();continue e}t={}}else if(223===e){if(0!==(i=this.readU32())){this.pushMapState(i),this.complete();continue e}t={}}else if(196===e){var i=this.lookU8();t=this.decodeBinary(i,1)}else if(197===e)i=this.lookU16(),t=this.decodeBinary(i,2);else if(198===e)i=this.lookU32(),t=this.decodeBinary(i,4);else if(212===e)t=this.decodeExtension(1,0);else if(213===e)t=this.decodeExtension(2,0);else if(214===e)t=this.decodeExtension(4,0);else if(215===e)t=this.decodeExtension(8,0);else if(216===e)t=this.decodeExtension(16,0);else if(199===e)i=this.lookU8(),t=this.decodeExtension(i,1);else if(200===e)i=this.lookU16(),t=this.decodeExtension(i,2);else{if(201!==e)throw new w("Unrecognized type byte: ".concat(j(e)));i=this.lookU32(),t=this.decodeExtension(i,4)}this.complete();for(var r=this.stack;r.length>0;){var s=r[r.length-1];if(0===s.type){if(s.array[s.position]=t,s.position++,s.position!==s.size)continue e;r.pop(),t=s.array}else{if(1===s.type){if(void 0,"string"!=(o=typeof t)&&"number"!==o)throw new w("The type of key must be string or number but "+typeof t);if("__proto__"===t)throw new w("The key __proto__ is not allowed");s.key=t,s.type=2;continue e}if(s.map[s.key]=t,s.readCount++,s.readCount!==s.size){s.key=null,s.type=1;continue e}r.pop(),t=s.map}}return t}var o},e.prototype.readHeadByte=function(){return-1===this.headByte&&(this.headByte=this.readU8()),this.headByte},e.prototype.complete=function(){this.headByte=-1},e.prototype.readArraySize=function(){var e=this.readHeadByte();switch(e){case 220:return this.readU16();case 221:return this.readU32();default:if(e<160)return e-144;throw new w("Unrecognized array type byte: ".concat(j(e)))}},e.prototype.pushMapState=function(e){if(e>this.maxMapLength)throw new w("Max length exceeded: map length (".concat(e,") > maxMapLengthLength (").concat(this.maxMapLength,")"));this.stack.push({type:1,size:e,key:null,readCount:0,map:{}})},e.prototype.pushArrayState=function(e){if(e>this.maxArrayLength)throw new w("Max length exceeded: array length (".concat(e,") > maxArrayLength (").concat(this.maxArrayLength,")"));this.stack.push({type:0,size:e,array:new Array(e),position:0})},e.prototype.decodeUtf8String=function(e,t){var n;if(e>this.maxStrLength)throw new w("Max length exceeded: UTF-8 byte length (".concat(e,") > maxStrLength (").concat(this.maxStrLength,")"));if(this.bytes.byteLength<this.pos+t+e)throw W;var i,r=this.pos+t;return i=this.stateIsMapKey()&&(null===(n=this.keyDecoder)||void 0===n?void 0:n.canBeCached(e))?this.keyDecoder.decode(this.bytes,r,e):e>v?function(e,t,n){var i=e.subarray(t,t+n);return m.decode(i)}(this.bytes,r,e):p(this.bytes,r,e),this.pos+=t+e,i},e.prototype.stateIsMapKey=function(){return this.stack.length>0&&1===this.stack[this.stack.length-1].type},e.prototype.decodeBinary=function(e,t){if(e>this.maxBinLength)throw new w("Max length exceeded: bin length (".concat(e,") > maxBinLength (").concat(this.maxBinLength,")"));if(!this.hasRemaining(e+t))throw W;var n=this.pos+t,i=this.bytes.subarray(n,n+e);return this.pos+=t+e,i},e.prototype.decodeExtension=function(e,t){if(e>this.maxExtLength)throw new w("Max length exceeded: ext length (".concat(e,") > maxExtLength (").concat(this.maxExtLength,")"));var n=this.view.getInt8(this.pos+t),i=this.decodeBinary(e,t+1);return this.extensionCodec.decode(i,n,this.context)},e.prototype.lookU8=function(){return this.view.getUint8(this.pos)},e.prototype.lookU16=function(){return this.view.getUint16(this.pos)},e.prototype.lookU32=function(){return this.view.getUint32(this.pos)},e.prototype.readU8=function(){var e=this.view.getUint8(this.pos);return this.pos++,e},e.prototype.readI8=function(){var e=this.view.getInt8(this.pos);return this.pos++,e},e.prototype.readU16=function(){var e=this.view.getUint16(this.pos);return this.pos+=2,e},e.prototype.readI16=function(){var e=this.view.getInt16(this.pos);return this.pos+=2,e},e.prototype.readU32=function(){var e=this.view.getUint32(this.pos);return this.pos+=4,e},e.prototype.readI32=function(){var e=this.view.getInt32(this.pos);return this.pos+=4,e},e.prototype.readU64=function(){var e,t,n=(e=this.view,t=this.pos,4294967296*e.getUint32(t)+e.getUint32(t+4));return this.pos+=8,n},e.prototype.readI64=function(){var e=c(this.view,this.pos);return this.pos+=8,e},e.prototype.readF32=function(){var e=this.view.getFloat32(this.pos);return this.pos+=4,e},e.prototype.readF64=function(){var e=this.view.getFloat64(this.pos);return this.pos+=8,e},e}(),z={};function G(e,t){return void 0===t&&(t=z),new H(t.extensionCodec,t.context,t.maxStrLength,t.maxBinLength,t.maxArrayLength,t.maxMapLength,t.maxExtLength).decode(e)}function Y(e,t){return void 0===t&&(t=z),new H(t.extensionCodec,t.context,t.maxStrLength,t.maxBinLength,t.maxArrayLength,t.maxMapLength,t.maxExtLength).decodeMulti(e)}var K=function(e,t){var n,i,r,s,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,i&&(r=2&s[0]?i.return:s[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,s[1])).done)return r;switch(i=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,i=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((r=(r=o.trys).length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){o.label=s[1];break}if(6===s[0]&&o.label<r[1]){o.label=r[1],r=s;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(s);break}r[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],i=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}},J=function(e){return this instanceof J?(this.v=e,this):new J(e)},Q=function(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,r=n.apply(e,t||[]),s=[];return i={},o("next"),o("throw"),o("return"),i[Symbol.asyncIterator]=function(){return this},i;function o(e){r[e]&&(i[e]=function(t){return new Promise((function(n,i){s.push([e,t,n,i])>1||a(e,t)}))})}function a(e,t){try{(n=r[e](t)).value instanceof J?Promise.resolve(n.value.v).then(c,l):u(s[0][2],n)}catch(e){u(s[0][3],e)}var n}function c(e){a("next",e)}function l(e){a("throw",e)}function u(e,t){e(t),s.shift(),s.length&&a(s[0][0],s[0][1])}};function Z(e){return null!=e[Symbol.asyncIterator]?e:function(e){return Q(this,arguments,(function(){var t,n,i,r;return K(this,(function(s){switch(s.label){case 0:t=e.getReader(),s.label=1;case 1:s.trys.push([1,,9,10]),s.label=2;case 2:return[4,J(t.read())];case 3:return n=s.sent(),i=n.done,r=n.value,i?[4,J(void 0)]:[3,5];case 4:return[2,s.sent()];case 5:return function(e){if(null==e)throw new Error("Assertion Failure: value must not be null nor undefined")}(r),[4,J(r)];case 6:return[4,s.sent()];case 7:return s.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}}))}))}(e)}var X=function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))},ee=function(e,t){var n,i,r,s,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,i&&(r=2&s[0]?i.return:s[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,s[1])).done)return r;switch(i=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,i=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((r=(r=o.trys).length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){o.label=s[1];break}if(6===s[0]&&o.label<r[1]){o.label=r[1],r=s;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(s);break}r[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],i=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}};function te(e,t){return void 0===t&&(t=z),X(this,void 0,void 0,(function(){var n;return ee(this,(function(i){return n=Z(e),[2,new H(t.extensionCodec,t.context,t.maxStrLength,t.maxBinLength,t.maxArrayLength,t.maxMapLength,t.maxExtLength).decodeAsync(n)]}))}))}function ne(e,t){void 0===t&&(t=z);var n=Z(e);return new H(t.extensionCodec,t.context,t.maxStrLength,t.maxBinLength,t.maxArrayLength,t.maxMapLength,t.maxExtLength).decodeArrayStream(n)}function ie(e,t){void 0===t&&(t=z);var n=Z(e);return new H(t.extensionCodec,t.context,t.maxStrLength,t.maxBinLength,t.maxArrayLength,t.maxMapLength,t.maxExtLength).decodeStream(n)}function re(e,t){return void 0===t&&(t=z),ie(e,t)}},2561:e=>{"use strict";e.exports={i8:"3.3.3"}}},t={};function n(i){var r=t[i];if(void 0!==r)return r.exports;var s=t[i]={exports:{}};return e[i].call(s.exports,s,s.exports,n),s.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var i={};(()=>{"use strict";n.r(i),n.d(i,{activate:()=>Je,deactivate:()=>Qe});const e=require("vscode");var t=n.n(e);const r=require("child_process");var s=n(1017),o=n.n(s),a=n(9562),c=n(1440);class l{constructor(e,n){this.disposables=[],this.scrollPage=(e,n)=>{t().commands.executeCommand("editorScroll",{to:n,by:e,revealCursor:!0})},this.scrollLine=e=>{t().commands.executeCommand("editorScroll",{to:e,by:"line",revealCursor:this.revealCursorScrollLine})},this.goToLine=e=>{const n=t().window.activeTextEditor;if(!n)return;const i=n.visibleRanges[0].start.line,r=n.visibleRanges[0].end.line,s="top"===e?i:"bottom"===e?r:Math.floor(i+(r-i)/2),o=n.document.lineAt(s);n.selections=[new(t().Selection)(s,o.firstNonWhitespaceCharacterIndex,s,o.firstNonWhitespaceCharacterIndex)]},this.revealLine=(e,n=!1)=>{const i=t().window.activeTextEditor;if(!i)return;const r=i.selection.active;if(t().commands.executeCommand("revealLine",{lineNumber:r.line,at:e}),n){const e=i.document.lineAt(r.line);i.selections=[new(t().Selection)(r.line,e.firstNonWhitespaceCharacterIndex,r.line,e.firstNonWhitespaceCharacterIndex)]}},this.client=e,this.revealCursorScrollLine=n,this.disposables.push(t().commands.registerCommand("vscode-neovim.ctrl-f",(()=>this.scrollPage("page","down")))),this.disposables.push(t().commands.registerCommand("vscode-neovim.ctrl-b",(()=>this.scrollPage("page","up")))),this.disposables.push(t().commands.registerCommand("vscode-neovim.ctrl-d",(()=>this.scrollPage("halfPage","down")))),this.disposables.push(t().commands.registerCommand("vscode-neovim.ctrl-u",(()=>this.scrollPage("halfPage","up")))),this.disposables.push(t().commands.registerCommand("vscode-neovim.ctrl-e",(()=>this.scrollLine("down")))),this.disposables.push(t().commands.registerCommand("vscode-neovim.ctrl-y",(()=>this.scrollLine("up"))))}dispose(){for(const e of this.disposables)e.dispose()}handleExtensionRequest(e,n){return i=this,r=void 0,o=function*(){switch(e){case"reveal":{const[e,t]=n;this.revealLine(e,!!t);break}case"move-cursor":{const[e]=n;this.goToLine(e);break}case"scroll":{const[e,t]=n;this.scrollPage(e,t);break}case"scroll-line":{const[e]=n;this.scrollLine(e);break}case"insert-line":{const[e]=n;yield this.client.command("startinsert"),yield t().commands.executeCommand("before"===e?"editor.action.insertLineBefore":"editor.action.insertLineAfter");break}}},new((s=void 0)||(s=Promise))((function(e,t){function n(e){try{c(o.next(e))}catch(e){t(e)}}function a(e){try{c(o.throw(e))}catch(e){t(e)}}function c(t){var i;t.done?e(t.value):(i=t.value,i instanceof s?i:new s((function(e){e(i)}))).then(n,a)}c((o=o.apply(i,r||[])).next())}));var i,r,s,o}}var u=n(2361);const h="ModeManager";class d{constructor(e=""){this.shortname=e}get char(){return this.shortname.charAt(0).replace("","v")}get name(){switch(this.char.toLowerCase()){case"i":return"insert";case"v":return"visual";case"c":return"cmdline";case"r":return"replace";default:return"normal"}}get visual(){return"V"===this.char?"line":"v"===this.shortname.charAt(0)?"char":"block"}get isVisual(){return"visual"===this.name}get isInsert(){return"insert"===this.name}get isNormal(){return"normal"===this.name}}class f{constructor(e){this.logger=e,this.disposables=[],this.mode=new d("n"),this.isRecording=!1,this.eventEmitter=new u.EventEmitter}dispose(){this.disposables.forEach((e=>e.dispose()))}get currentMode(){return this.mode}get isInsertMode(){return this.mode.isInsert}get isVisualMode(){return this.mode.isVisual}get isNormalMode(){return this.mode.isNormal}get isRecordingInInsertMode(){return this.isRecording}onModeChange(e){this.eventEmitter.on("neovimModeChanged",e)}handleExtensionRequest(t,n){return i=this,r=void 0,o=function*(){switch(t){case"mode-changed":{const[t]=n;this.logger.debug(`${h}: Changing mode to ${t}`),this.mode=new d(t),!this.isInsertMode&&this.isRecording&&(this.isRecording=!1,e.commands.executeCommand("setContext","neovim.recording",!1)),e.commands.executeCommand("setContext","neovim.mode",this.mode.name),this.logger.debug(`${h}: Setting mode context to ${this.mode.name}`),this.eventEmitter.emit("neovimModeChanged");break}case"notify-recording":this.logger.debug(`${h}: setting recording flag`),this.isRecording=!0,e.commands.executeCommand("setContext","neovim.recording",!0)}},new((s=void 0)||(s=Promise))((function(e,t){function n(e){try{c(o.next(e))}catch(e){t(e)}}function a(e){try{c(o.throw(e))}catch(e){t(e)}}function c(t){var i;t.done?e(t.value):(i=t.value,i instanceof s?i:new s((function(e){e(i)}))).then(n,a)}c((o=o.apply(i,r||[])).next())}));var i,r,s,o}}const p=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)},g="object"==typeof global&&global&&global.Object===Object&&global;var m="object"==typeof self&&self&&self.Object===Object&&self;const v=g||m||Function("return this")(),b=function(){return v.Date.now()};var y=/\s/;var w=/^\s+/;const _=function(e){return e?e.slice(0,function(e){for(var t=e.length;t--&&y.test(e.charAt(t)););return t}(e)+1).replace(w,""):e},x=v.Symbol;var E=Object.prototype,S=E.hasOwnProperty,C=E.toString,M=x?x.toStringTag:void 0;var T=Object.prototype.toString;var $=x?x.toStringTag:void 0;const O=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":$&&$ in Object(e)?function(e){var t=S.call(e,M),n=e[M];try{e[M]=void 0;var i=!0}catch(e){}var r=C.call(e);return i&&(t?e[M]=n:delete e[M]),r}(e):function(e){return T.call(e)}(e)};var k=/^[-+]0x[0-9a-f]+$/i,P=/^0b[01]+$/i,R=/^0o[0-7]+$/i,A=parseInt;const I=function(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return null!=e&&"object"==typeof e}(e)&&"[object Symbol]"==O(e)}(e))return NaN;if(p(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=p(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=_(e);var n=P.test(e);return n||R.test(e)?A(e.slice(2),n?2:8):k.test(e)?NaN:+e};var j=Math.max,L=Math.min;const D=function(e,t,n){var i,r,s,o,a,c,l=0,u=!1,h=!1,d=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function f(t){var n=i,s=r;return i=r=void 0,l=t,o=e.apply(s,n)}function g(e){var n=e-c;return void 0===c||n>=t||n<0||h&&e-l>=s}function m(){var e=b();if(g(e))return v(e);a=setTimeout(m,function(e){var n=t-(e-c);return h?L(n,s-(e-l)):n}(e))}function v(e){return a=void 0,d&&i?f(e):(i=r=void 0,o)}function y(){var e=b(),n=g(e);if(i=arguments,r=this,c=e,n){if(void 0===a)return function(e){return l=e,a=setTimeout(m,t),u?f(e):o}(c);if(h)return clearTimeout(a),a=setTimeout(m,t),f(c)}return void 0===a&&(a=setTimeout(m,t)),o}return t=I(t)||0,p(n)&&(u=!!n.leading,s=(h="maxWait"in n)?j(I(n.maxWait)||0,t):s,d="trailing"in n?!!n.trailing:d),y.cancel=function(){void 0!==a&&clearTimeout(a),l=0,i=c=r=a=void 0},y.flush=function(){return void 0===a?o:v(b())},y};var N=n(1810),B=n(7529),U=n.n(B);const q=[[768,879],[1155,1158],[1160,1161],[1425,1469],[1471,1471],[1473,1474],[1476,1477],[1479,1479],[1536,1539],[1552,1557],[1611,1630],[1648,1648],[1750,1764],[1767,1768],[1770,1773],[1807,1807],[1809,1809],[1840,1866],[1958,1968],[2027,2035],[2305,2306],[2364,2364],[2369,2376],[2381,2381],[2385,2388],[2402,2403],[2433,2433],[2492,2492],[2497,2500],[2509,2509],[2530,2531],[2561,2562],[2620,2620],[2625,2626],[2631,2632],[2635,2637],[2672,2673],[2689,2690],[2748,2748],[2753,2757],[2759,2760],[2765,2765],[2786,2787],[2817,2817],[2876,2876],[2879,2879],[2881,2883],[2893,2893],[2902,2902],[2946,2946],[3008,3008],[3021,3021],[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3260,3260],[3263,3263],[3270,3270],[3276,3277],[3298,3299],[3393,3395],[3405,3405],[3530,3530],[3538,3540],[3542,3542],[3633,3633],[3636,3642],[3655,3662],[3761,3761],[3764,3769],[3771,3772],[3784,3789],[3864,3865],[3893,3893],[3895,3895],[3897,3897],[3953,3966],[3968,3972],[3974,3975],[3984,3991],[3993,4028],[4038,4038],[4141,4144],[4146,4146],[4150,4151],[4153,4153],[4184,4185],[4448,4607],[4959,4959],[5906,5908],[5938,5940],[5970,5971],[6002,6003],[6068,6069],[6071,6077],[6086,6086],[6089,6099],[6109,6109],[6155,6157],[6313,6313],[6432,6434],[6439,6440],[6450,6450],[6457,6459],[6679,6680],[6912,6915],[6964,6964],[6966,6970],[6972,6972],[6978,6978],[7019,7027],[7616,7626],[7678,7679],[8203,8207],[8234,8238],[8288,8291],[8298,8303],[8400,8431],[12330,12335],[12441,12442],[43014,43014],[43019,43019],[43045,43046],[64286,64286],[65024,65039],[65056,65059],[65279,65279],[65529,65531],[68097,68099],[68101,68102],[68108,68111],[68152,68154],[68159,68159],[119143,119145],[119155,119170],[119173,119179],[119210,119213],[119362,119364],[917505,917505],[917536,917631],[917760,917999]],F={nul:0,control:0};function W(e,t){let n=F;if(t&&(n={...F,...t}),"string"!=typeof e)return V(e,n);let i=0;for(let t=0;t<e.length;t++){const r=V(e.charCodeAt(t),n);if(r<0)return-1;i+=r}return i}function V(e,t=F){return 0===e?t.nul:e<32||e>=127&&e<160?t.control:function(e){let t,n=0,i=q.length-1;if(e<q[0][0]||e>q[i][1])return!1;for(;i>=n;)if(t=Math.floor((n+i)/2),e>q[t][1])n=t+1;else{if(!(e<q[t][0]))return!0;i=t-1}return!1}(e)?0:1+Number(e>=4352&&(e<=4447||9001===e||9002===e||e>=11904&&e<=42191&&12351!==e||e>=44032&&e<=55203||e>=63744&&e<=64255||e>=65040&&e<=65049||e>=65072&&e<=65135||e>=65280&&e<=65376||e>=65504&&e<=65510||e>=131072&&e<=196605||e>=196608&&e<=262141))}const H="vscode-neovim",z=`asvetliakov.${H}`;function G(e,t){const n=[],i={};n[0]="";const r=(e,t)=>{let r="",s=0,o=-1,a=n.length;for(;o<e.length-1;){o=e.indexOf("\n",s),-1==o&&(o=e.length-1);let c=e.substring(s,o+1);(i.hasOwnProperty?i.hasOwnProperty(c):void 0!==i[c])?r+=String.fromCharCode(i[c]):(a==t&&(c=e.substring(s),o=e.length),r+=String.fromCharCode(a),i[c]=a,n[a++]=c),s=o+1}return r};return{chars1:r(e,4e4),chars2:r(t,65535),lineArray:n}}function Y(e){const t=[];let n,i=0,r=0,s=0;for(let o=0;o<e.length;o++){const[a,c]=e[o];if(0===a)n&&("changed"===n.type?(i+=n.end-n.start+1,r+=n.newEnd-n.newStart+1):"added"===n.type?r+=Math.abs(s):"removed"===n.type&&(i+=Math.abs(s)),t.push(n),n=void 0,s=0),i+=c.length,r+=c.length;else if(n||(n={start:i,end:i,newStart:r,newEnd:r,type:"changed"},s=0),-1===a){if(1===c.length&&e[o+1]&&1===e[o+1][0]&&1===e[o+1][1].length){o++;continue}n.type="removed",n.end+=c.length-1,s=-c.length}else"removed"===n.type?n.type="changed":n.type="added",n.newEnd+=c.length-1,s+=c.length}return n&&t.push(n),t}function K(e,t){if(0===t||!e)return 0;let n=0,i=0;for(;n<t;){const t=Z(e.codePointAt(n));if(i+=t,n+=4===t?2:1,n>=e.length)return i}return i}function J(e,t){let n=0,i=0;for(;n<t;){if(i>=e.length)return i+(t-n);const r=Z(e.codePointAt(i));n+=r,i+=4===r?2:1}return i}function Q(t,n){const i=J(t.document.lineAt(n.line).text,n.character);return new e.Position(n.line,i)}function Z(e){return null==e?0:e<=127?1:e<=2047?2:e>=55296&&e<=57343?4:e<65535?3:4}function X(e,t,n){if(0===t||!e)return 0;let i=0,r=0;for(;r<t;)if("\t"===e[i]?(r+=n-r%n,i++):(r+=W(e[i]),i++),i>=e.length)return i;return i}function ee(e,t){const n=t.text.length,i=t.rangeOffset,r=t.rangeOffset+n;return e.rangeOffset>=i&&e.rangeOffset<=r||e.rangeOffset<i&&e.rangeOffset+e.rangeLength>=i}function te(e,t,n){if(e.range.contains(t))return!0;if(e.range.isSingleLine&&e.text){const i=e.text.split(n),r=i.length,s=e.range.start.line+r-1,o=e.range.end.character+i.slice(-1)[0].length;if(s>=t.line&&o>=t.character)return!0}return!1}function ne(t,n){const i=e.workspace.getConfiguration(H),r=i.get("useWSL"),s=process.platform;return n.environmentVariableName&&process.env[n.environmentVariableName]||i.get(n.vscodeSettingName)||(r&&"win32"===s?i.get(`${t}.linux`):i.get(`${t}.${s}`))}function ie(e,t,n){return{rangeLength:e.rangeLength,rangeOffset:e.rangeOffset,text:e.text,startMode:n,eol:t}}function re(e,t){const n=Object.assign({},t),i=e.rangeOffset<=t.rangeOffset?e.rangeOffset-t.rangeOffset+e.rangeLength:e.rangeLength,r=e.rangeOffset<=t.rangeOffset?0:e.rangeOffset-t.rangeOffset,s=e.rangeOffset-t.rangeOffset+i;return n.text=t.text.slice(0,r)+e.text+t.text.slice(s),e.rangeOffset<t.rangeOffset&&(n.rangeOffset=e.rangeOffset,n.rangeLength+=e.rangeLength),n}function se(t){const n=t.eol===e.EndOfLine.CRLF?"\r\n":"\n";return t.getText().split(n)}function oe(e,t=!0){let n=e.replace(/</g,"<LT>");return t&&(n=n.replace(/\n/g,"<CR>")),n}function ae(e,t,n,i=""){return r=this,s=void 0,a=function*(){const r=yield e.callAtomic(t),s=[];r&&Array.isArray(r)&&Array.isArray(r[0])&&r[0].forEach(((e,n)=>{if(e){const i=t[n];"nvim_input"!==(null==i?void 0:i[0])&&s.push(`${(null==i?void 0:i[0])||"Unknown"}: ${e}`)}})),s.length&&n.error(`${i}:\n${s.join("\n")}`)},new((o=void 0)||(o=Promise))((function(e,t){function n(e){try{c(a.next(e))}catch(e){t(e)}}function i(e){try{c(a.throw(e))}catch(e){t(e)}}function c(t){var r;t.done?e(t.value):(r=t.value,r instanceof o?r:new o((function(e){e(r)}))).then(n,i)}c((a=a.apply(r,s||[])).next())}));var r,s,o,a}function ce(e){let t=0;return e.map((([e,n])=>{let i=null;switch(e){case U().DELETE:i={op:e,range:[t,t+n.length],chars:null},t+=n.length;break;case U().EQUAL:t+=n.length;break;case U().INSERT:i={op:e,range:[t,t],chars:n},t+=0;break;default:throw new Error("Operation not supported")}return i})).filter((function(e){return null!==e}))}function le(t,{editorOps:n,line:i}){n.forEach((n=>{const{op:r,range:[s,o],chars:a}=n;switch(r){case U().DELETE:t.delete(new e.Range(new e.Position(i,s),new e.Position(i,o)));break;case U().INSERT:a&&t.insert(new e.Position(i,s),a)}}))}class ue{constructor(){this.resolve=()=>{},this.reject=()=>{},this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t})),this.promise.catch((e=>{}))}}var he=function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))};const de="BufferManager",fe="__vscode_neovim__-";class pe{constructor(t,n,i,r){this.logger=t,this.client=n,this.main=i,this.settings=r,this.disposables=[],this.syncLayoutCancelTokenSource=new e.CancellationTokenSource,this.externalTextDocuments=new Set,this.textDocumentToBufferId=new Map,this.textEditorToWinId=new Map,this.winIdToEditor=new Map,this.grids=new Map,this.editorTabConfiguration=new WeakMap,this.onWindowChanged=t=>he(this,void 0,void 0,(function*(){this.logger.debug(`${de} onWindowChanged, target window id: ${t}`);const n=()=>he(this,void 0,void 0,(function*(){e.window.activeTextEditor&&(yield e.window.showTextDocument(e.window.activeTextEditor.document,e.window.activeTextEditor.viewColumn))}));let i=this.getEditorFromWinId(t);if(!i)return this.logger.debug(`${de} target editor not found <check 1>, return to active editor`),void(yield n());if(e.window.activeTextEditor===i)return;if(yield new Promise((e=>setTimeout(e,50))),this.syncLayoutPromise&&(yield this.syncLayoutPromise.promise),this.syncActiveEditorPromise&&(yield this.syncActiveEditorPromise.promise),void 0===e.window.activeTextEditor)return void this.logger.debug(`${de} activeTextEditor is undefined, skipping`);yield this.main.cursorManager.waitForCursorUpdate(e.window.activeTextEditor);const{id:r}=yield this.client.getWindow();if(i=this.getEditorFromWinId(r),!i)return this.logger.debug(`${de} target editor not found <check 2>, return to active editor`),void n();if(e.window.activeTextEditor===i)return;yield this.main.cursorManager.waitForCursorUpdate(i);const s=i.document.uri,{scheme:o}=s;switch(o){case"output":return void(yield e.commands.executeCommand("workbench.panel.output.focus"));case"vscode-notebook-cell":{const t=e.window.visibleNotebookEditors.find((e=>e.notebook.uri.fsPath===s.fsPath));if(t)return yield e.window.showTextDocument(i.document,t.viewColumn),yield new Promise((e=>setTimeout(e,50))),void(yield e.window.showTextDocument(i.document,i.viewColumn));break}default:return void(yield e.window.showTextDocument(i.document,i.viewColumn))}yield n()})),this.onWindowChangedDebounced=D(this.onWindowChanged,100,{leading:!1,trailing:!0}),this.onDidCloseTextDocument=e=>{},this.onDidChangeVisibleTextEditors=()=>{this.logger.debug(`${de}: onDidChangeVisibleTextEditors`),this.syncLayoutPromise||(this.syncLayoutPromise=new ue),this.syncLayoutCancelTokenSource.cancel(),this.syncLayoutCancelTokenSource=new e.CancellationTokenSource,this.syncLayoutDebounced(this.syncLayoutCancelTokenSource.token)},this.onDidChangeActiveTextEditor=()=>{this.logger.debug(`${de}: onDidChangeActiveTextEditor`),this.syncActiveEditorPromise||(this.syncActiveEditorPromise=new ue),this.syncActiveEditorDebounced()},this.syncLayout=t=>he(this,void 0,void 0,(function*(){var n;this.logger.debug(`${de}: syncing layout`);const i=[...e.window.visibleTextEditors];this.logger.debug(`${de}: new/changed editors/windows`);for(const e of i){if(this.logger.debug(`${de}: Visible editor, viewColumn: ${e.viewColumn}, doc: ${e.document.uri.toString()}`),!this.textDocumentToBufferId.has(e.document)){this.logger.debug(`${de}: Document not known, init in neovim`);const t=yield this.client.createBuffer(!1,!0);if("number"==typeof t){this.logger.error(`${de}: Cannot create a buffer, code: ${t}`);continue}yield this.initBufferForDocument(e.document,t,e),this.logger.debug(`${de}: Document: ${e.document.uri.toString()}, BufId: ${t.id}`),this.textDocumentToBufferId.set(e.document,t.id)}const t=this.textDocumentToBufferId.get(e.document);let n;try{this.textEditorToWinId.has(e)||(this.logger.debug(`${de}: Creating new neovim window for ${e.viewColumn} column (undefined is OK here)`),n=yield this.createNeovimWindow(t),this.logger.debug(`${de}: Created new window: ${n}`),this.logger.debug(`${de}: ViewColumn: ${e.viewColumn} - WinId: ${n}`),this.textEditorToWinId.set(e,n),this.winIdToEditor.set(n,e),this.main.cursorManager.updateNeovimCursorPosition(e,e.selection.active))}catch(e){this.logger.error(`${de}: ${e.message}`);continue}}this.logger.debug(`${de}: Clean up windows and buffers`);const r=[],s=[];[...this.textEditorToWinId.entries()].forEach((([e,t])=>{i.includes(e)||(this.logger.debug(`${de}: Editor viewColumn: ${e.viewColumn}, winId: ${t}, closing`),this.textEditorToWinId.delete(e),this.winIdToEditor.delete(t),r.push(t))})),[...this.textDocumentToBufferId.entries()].forEach((([e,t])=>{!i.some((t=>t.document===e))&&e.isClosed&&(this.logger.debug(`${de}: Document: ${e.uri.toString()}, bufId: ${t}, deleting`),this.textDocumentToBufferId.delete(e),s.push(t))})),s.length&&(yield this.client.executeLua("require'vscode-neovim.api'.delete_buffers(...)",[s])),r.length&&(yield this.client.executeLua("require'vscode-neovim.api'.close_windows(...)",[r])),t.isCancellationRequested?this.logger.debug(`${de}: Cancellation requested in syncLayout, returning`):(null===(n=this.syncLayoutPromise)||void 0===n||n.resolve(),this.syncLayoutPromise=void 0)})),this.syncLayoutDebounced=D(this.syncLayout,200,{leading:!1,trailing:!0}),this.syncActiveEditor=()=>he(this,void 0,void 0,(function*(){this.logger.debug(`${de}: syncing active editor`),yield this.waitForLayoutSync();const t=()=>{var e;null===(e=this.syncActiveEditorPromise)||void 0===e||e.resolve(),this.syncActiveEditorPromise=void 0},n=e.window.activeTextEditor;if(!n)return void t();const i=this.textEditorToWinId.get(n);if(!i)return this.logger.error(`${de}: Unable to determine neovim windows id for editor viewColumn: ${n.viewColumn}, docUri: ${n.document.uri.toString()}`),void t();this.logger.debug(`${de}: Setting active editor - viewColumn: ${n.viewColumn}, winId: ${i}`),yield this.main.cursorManager.updateNeovimCursorPosition(n,n.selection.active);try{yield this.client.request("nvim_set_current_win",[i])}catch(e){this.logger.error(`${de} ${e.message}`)}t()})),this.syncActiveEditorDebounced=D(this.syncActiveEditor,100,{leading:!1,trailing:!0}),this.onDidChangeEditorOptions=e=>{this.logger.debug(`${de}: Received onDidChangeEditorOptions`);const t=this.textDocumentToBufferId.get(e.textEditor.document);if(!t)return void this.logger.warn(`${de}: No buffer for onDidChangeEditorOptions, skipping`);const n=this.editorTabConfiguration.get(e.textEditor);n&&n.insertSpaces===e.options.insertSpaces&&n.tabSize===e.options.tabSize||(this.logger.debug(`${de}: Updating tab options for bufferId: ${t}`),this.editorTabConfiguration.set(e.textEditor,{insertSpaces:e.options.insertSpaces,tabSize:e.options.tabSize}),this.resyncBufferTabOptions(e.textEditor,t))},this.receivedBufferEvent=(e,t,n,i,r,s)=>{this.onBufferEvent&&this.onBufferEvent(e.id,t,n,i,r,s)},this.disposables.push(e.window.onDidChangeVisibleTextEditors(this.onDidChangeVisibleTextEditors)),this.disposables.push(e.window.onDidChangeActiveTextEditor(this.onDidChangeActiveTextEditor)),this.disposables.push(e.workspace.onDidCloseTextDocument(this.onDidCloseTextDocument)),this.disposables.push(e.window.onDidChangeTextEditorOptions(this.onDidChangeEditorOptions))}dispose(){this.disposables.forEach((e=>e.dispose()))}forceResync(){return he(this,void 0,void 0,(function*(){this.logger.debug(`${de}: force resyncing layout`),this.syncLayoutPromise||(this.syncLayoutPromise=new ue),yield this.syncLayoutDebounced(this.syncLayoutCancelTokenSource.token),yield this.syncActiveEditorDebounced()}))}waitForLayoutSync(){return he(this,void 0,void 0,(function*(){this.syncLayoutPromise&&(this.logger.debug(`${de}: Waiting for completing layout resyncing`),yield this.syncLayoutPromise.promise,this.logger.debug(`${de}: Waiting done`))}))}getTextDocumentForBufferId(e){var t;const n=null===(t=[...this.textDocumentToBufferId].find((([,t])=>e===t)))||void 0===t?void 0:t[0];return n&&!n.isClosed?n:void 0}getBufferIdForTextDocument(e){return this.textDocumentToBufferId.get(e)}getGridIdForWinId(e){const t=[...this.grids].reverse().find((([,t])=>t.winId===e));return t?t[0]:void 0}getWinIdForGridId(e){var t;return null===(t=this.grids.get(e))||void 0===t?void 0:t.winId}getWinIdForTextEditor(e){return this.textEditorToWinId.get(e)}getEditorFromWinId(e){const t=[...this.textEditorToWinId].find((([,t])=>t===e));return t?t[0]:this.winIdToEditor.get(e)}getGridIdFromEditor(e){return this.getGridIdForWinId(this.getWinIdForTextEditor(e)||0)}getEditorFromGridId(e){const t=this.getWinIdForGridId(e);if(t)return this.getEditorFromWinId(t)}isExternalTextDocument(e){return"output"!==e.uri.scheme&&this.externalTextDocuments.has(e)}handleRedrawBatch(e){for(const[t,...n]of e)switch(t){case"win_external_pos":case"win_pos":for(const[e,t]of n)this.grids.set(e,{winId:t.id});break;case"win_close":for(const[e]of n)this.grids.delete(e)}}handleExtensionRequest(t,n){var i;return he(this,void 0,void 0,(function*(){switch(t){case"open-file":{const[t,i]=n,r=e.window.activeTextEditor;let s,o;try{if("__vscode_new__"===t)s=yield e.workspace.openTextDocument();else{const n=t.trim(),i=this.findPathFromFileName(n);s=yield e.workspace.openTextDocument(i)}}catch(e){this.logger.error(`${de}: Error opening file ${t}, ${e}`)}if(!s)return;i&&"all"!==i&&r&&(o=r.viewColumn,yield e.commands.executeCommand("workbench.action.revertAndCloseActiveEditor")),yield e.window.showTextDocument(s,o),"all"===i&&(yield e.commands.executeCommand("workbench.action.closeOtherEditors"));break}case"external-buffer":{const[t,r,s,o]=n;if(t.startsWith(`${fe}output:`))break;const a=parseInt(r,10);if(t&&this.isVscodeUriName(t)){if(t){const n=t.startsWith(fe)?t.substring(18):t;this.logger.debug(`${de}: Buffer request for ${n}, bufId: ${r}`);try{let t=this.findDocFromUri(n);t||(this.logger.debug(`${de}: Opening a doc: ${n}`),t=yield e.workspace.openTextDocument(e.Uri.parse(n,!0)));let r=!1;if(!this.textDocumentToBufferId.has(t)){this.logger.debug(`${de}: No doc -> buffer mapping exists, assigning mapping and init buffer options`);const e=(yield this.client.buffers).find((e=>e.id===a));e&&(r=!0,yield this.initBufferForDocument(t,e)),this.textDocumentToBufferId.set(t,a)}if((null===(i=e.window.activeTextEditor)||void 0===i?void 0:i.document)!==t){const n=yield e.window.showTextDocument(t,{viewColumn:e.window.activeTextEditor?e.window.activeTextEditor.viewColumn:e.ViewColumn.Active,preserveFocus:!1,preview:!1});this.editorTabConfiguration.set(n,{insertSpaces:n.options.insertSpaces,tabSize:n.options.tabSize}),r&&(yield this.resyncBufferTabOptions(n,a))}}catch(e){}}}else{if(this.logger.debug(`${de}: Attaching new external buffer: ${t}, id: ${a}`),1===a)return void this.logger.debug(`${de}: ${a} is the first neovim buffer, skipping`);yield this.attachNeovimExternalBuffer(t,a,!!s,o)}break}case"window-changed":this.onWindowChangedDebounced(n[0])}}))}initBufferForDocument(t,n,i){return he(this,void 0,void 0,(function*(){const r=n.id;this.logger.debug(`${de}: Init buffer for ${r}, doc: ${t.uri.toString()}`);const{options:{insertSpaces:s,tabSize:o}}=i||{options:{insertSpaces:!0,tabSize:4}},a=t.eol===e.EndOfLine.LF?"\n":"\r\n",c=t.getText().split(a);i&&this.editorTabConfiguration.set(i,{tabSize:o,insertSpaces:s});const l=[["nvim_buf_set_option",[r,"expandtab",s]],["nvim_buf_set_option",[r,"tabstop",o]],["nvim_buf_set_option",[r,"shiftwidth",o]]],u=[["nvim_buf_set_lines",[r,0,-1,!1,c]],["nvim_buf_set_var",[r,"vscode_controlled",!0]],["nvim_buf_set_name",[r,fe+t.uri.toString()]],["nvim_buf_set_option",[r,"modifiable",!this.isExternalTextDocument(t)]],["nvim_buf_set_option",[r,"buftype","nofile"]],["nvim_buf_set_option",[r,"buflisted",!0]],...l];yield ae(this.client,u,this.logger,de),yield ae(this.client,l,this.logger,de),this.isExternalTextDocument(t)||(yield this.client.callFunction("VSCodeClearUndo",r)),this.onBufferInit&&this.onBufferInit(r,t),n.listen("lines",this.receivedBufferEvent)}))}resyncBufferTabOptions(e,t){return he(this,void 0,void 0,(function*(){const{options:{insertSpaces:n,tabSize:i}}=e,r=[["nvim_buf_set_option",[t,"expandtab",n]],["nvim_buf_set_option",[t,"tabstop",i]],["nvim_buf_set_option",[t,"shiftwidth",i]]];yield ae(this.client,r,this.logger,de)}))}createNeovimWindow(e){return he(this,void 0,void 0,(function*(){yield this.client.setOption("eventignore","BufWinEnter,BufEnter,BufLeave");const t=yield this.client.openWindow(e,!1,{external:!0,width:this.settings.neovimViewportWidth,height:100});if(yield this.client.setOption("eventignore",""),"number"==typeof t)throw new Error(`Unable to create a new neovim window, code: ${t}`);return t.id}))}unloadBuffer(e){return he(this,void 0,void 0,(function*(){try{yield this.client.command(`bunload! ${e}`)}catch(t){this.logger.warn(`${de}: Can't unload the buffer: ${e}, err: ${null==t?void 0:t.message}`)}}))}isVscodeUriName(e){return!!(/:\/\//.test(e)||e.startsWith("output:")||e.startsWith(`${fe}output:`)||e.startsWith("/search-editor:")||e.startsWith(`${fe}/search-editor:`))}findPathFromFileName(t){const n=e.workspace.workspaceFolders;return n?o().resolve(n[0].uri.fsPath,t):t}findDocFromUri(t){return t.startsWith("/search-editor")&&(t=t.slice(1)),e.workspace.textDocuments.find((e=>e.uri.toString()===t))}attachNeovimExternalBuffer(t,n,i,r){return he(this,void 0,void 0,(function*(){const t=(yield this.client.buffers).find((e=>e.id===n));if(!t)return;const s=yield t.lines;if(!s.length||1===s.length&&!s[0])return void this.logger.debug(`${de}: Skipping empty external buffer ${n}`);const o=yield e.workspace.openTextDocument({content:s.join("\n")});this.externalTextDocuments.add(o),this.textDocumentToBufferId.set(o,n),this.onBufferInit&&this.onBufferInit(n,o),t.listen("lines",this.receivedBufferEvent),yield t[N.ATTACH](!0);const a=yield this.client.windows;let c=0;for(const e of a)(yield e.buffer).id===n&&(this.logger.debug(`${de}: Found window assigned to external buffer ${n}, winId: ${e.id}, isKnownWindow: ${this.winIdToEditor.has(e.id)}`),this.winIdToEditor.has(e.id)||(c=e.id));const l=yield e.window.showTextDocument(o,{preserveFocus:!1,preview:!0,viewColumn:e.ViewColumn.Active});this.editorTabConfiguration.set(l,{tabSize:r,insertSpaces:i}),l.options.insertSpaces=i,l.options.tabSize=r,c&&(setTimeout((()=>he(this,void 0,void 0,(function*(){const t=yield this.client.request("nvim_win_get_cursor",[c]);if(t){this.logger.debug(`${de}: Adjusting cursor pos for external buffer: ${n}, originalPos: [${t[0]}, ${t[1]}]`);const i=t[0]-1;let r=t[1];try{r=J(o.lineAt(i).text,t[1]),this.logger.debug(`${de}: Adjusted cursor: [${i}, ${r}]`)}catch(e){this.logger.warn(`${de}: Unable to get cursor pos for external buffer: ${n}`)}l.selections=[new e.Selection(i,r,i,r)]}}))),1e3),setTimeout((()=>{this.logger.debug(`${de}: Closing window ${c} for external buffer: ${n}`);try{this.client.request("nvim_win_close",[c,!0])}catch(e){this.logger.warn(`${de}: Closing the window: ${c} for external buffer failed: ${e.message}`)}}),5e3))}))}}var ge=function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))};const me="TypingManager";class ve{constructor(t,n,i){this.logger=t,this.client=n,this.main=i,this.disposables=[],this.isExitingInsertMode=!1,this.neovimEnable=!0,this.isEnteringInsertMode=!1,this.pendingKeysAfterExit="",this.pendingKeysAfterEnter="",this.isInComposition=!1,this.composingText="",this.onModeChange=()=>ge(this,void 0,void 0,(function*(){if(this.main.modeManager.isInsertMode&&this.typeHandlerDisposable&&!this.main.modeManager.isRecordingInInsertMode){const t=e.window.activeTextEditor,n=t&&this.main.changeManager.getDocumentChangeCompletionLock(t.document);n?(this.logger.debug(`${me}: Waiting for cursor completion operation before disposing type handler`),this.pendingKeysAfterEnter="",this.isEnteringInsertMode=!0,n.then((()=>ge(this,void 0,void 0,(function*(){yield this.main.cursorManager.waitForCursorUpdate(t),this.main.modeManager.isInsertMode&&(this.disposeType(),this.disposeReplacePrevChar()),this.pendingKeysAfterEnter&&(this.logger.debug(`${me}: Replaying pending keys after entering insert mode: ${this.pendingKeysAfterEnter}`),yield e.commands.executeCommand(this.main.modeManager.isInsertMode?"default:type":"type",{text:this.pendingKeysAfterEnter}),this.pendingKeysAfterEnter=""),this.isEnteringInsertMode=!1}))))):(this.disposeType(),this.disposeReplacePrevChar())}else this.main.modeManager.isInsertMode||(this.isEnteringInsertMode=!1,this.isExitingInsertMode=!1,this.registerType(),this.registerReplacePrevChar())})),this.onVSCodeType=(t,n,i)=>ge(this,void 0,void 0,(function*(){this.isEnteringInsertMode?this.pendingKeysAfterEnter+=i.text:this.isExitingInsertMode?this.pendingKeysAfterExit+=i.text:this.isInComposition?this.composingText+=i.text:this.main.modeManager.isInsertMode&&!this.main.modeManager.isRecordingInInsertMode?(yield this.client.mode).blocking?this.client.input(oe(i.text,!this.main.modeManager.isRecordingInInsertMode)):(this.disposeType(),this.disposeReplacePrevChar(),e.commands.executeCommand("default:type",{text:i.text})):this.client.input(oe(i.text,!this.main.modeManager.isRecordingInInsertMode))})),this.onSendCommand=t=>ge(this,void 0,void 0,(function*(){if(this.logger.debug(`${me}: Send for: ${t}`),this.main.cursorManager.wantInsertCursorUpdate=!0,this.main.modeManager.isInsertMode&&!(yield this.client.mode).blocking){this.logger.debug(`${me}: Syncing buffers with neovim (${t})`),yield this.main.changeManager.documentChangeLock.waitForUnlock(),e.window.activeTextEditor&&(yield this.main.cursorManager.updateNeovimCursorPosition(e.window.activeTextEditor,e.window.activeTextEditor.selection.active)),yield this.main.changeManager.syncDotRepeatWithNeovim();const n=oe(this.pendingKeysAfterExit);this.logger.debug(`${me}: Pending keys sent with ${t}: ${n}`),this.pendingKeysAfterExit="",yield this.client.input(`${t}${n}`)}else this.isExitingInsertMode=!1,yield this.client.input(`${t}`)})),this.onSendBlockingCommand=e=>ge(this,void 0,void 0,(function*(){this.registerType(),this.registerReplacePrevChar(),yield this.onSendCommand(e)})),this.onEnableCommand=e=>{switch(e){case"enable":this.neovimEnable=!0;break;case"disable":this.neovimEnable=!1;break;case"toggle":this.neovimEnable=!this.neovimEnable}this.neovimEnable?this.client.command("stopinsert"):this.client.command("startinsert")},this.onEscapeKeyCommand=(e="<Esc>")=>ge(this,void 0,void 0,(function*(){(this.neovimEnable||"<Esc>"!==e)&&(this.isExitingInsertMode=!0,yield this.onSendBlockingCommand(e))})),this.handleCompositeEscapeFirstKey=t=>ge(this,void 0,void 0,(function*(){const n=(new Date).getTime();this.compositeEscapeFirstPressTimestamp&&n-this.compositeEscapeFirstPressTimestamp<=200?(this.compositeEscapeFirstPressTimestamp=void 0,yield e.commands.executeCommand("deleteLeft"),yield this.onEscapeKeyCommand()):(this.compositeEscapeFirstPressTimestamp=n,yield e.commands.executeCommand("type",{text:t}))})),this.handleCompositeEscapeSecondKey=t=>ge(this,void 0,void 0,(function*(){const n=(new Date).getTime();this.compositeEscapeFirstPressTimestamp&&n-this.compositeEscapeFirstPressTimestamp<=200?(this.compositeEscapeFirstPressTimestamp=void 0,yield e.commands.executeCommand("deleteLeft"),yield this.onEscapeKeyCommand()):yield e.commands.executeCommand("type",{text:t})})),this.onReplacePreviousChar=e=>{this.isInComposition&&(this.composingText=this.composingText.substring(0,this.composingText.length-e.replaceCharCnt)+e.text)},this.onCompositionStart=()=>{this.isInComposition=!0},this.onCompositionEnd=()=>{this.isInComposition=!1,this.main.modeManager.isInsertMode||this.client.input(oe(this.composingText,!this.main.modeManager.isRecordingInInsertMode)),this.composingText=""},this.registerType(),this.registerReplacePrevChar(),this.disposables.push(e.commands.registerCommand("vscode-neovim.send",this.onSendCommand)),this.disposables.push(e.commands.registerCommand("vscode-neovim.send-blocking",this.onSendBlockingCommand)),this.disposables.push(e.commands.registerCommand("vscode-neovim.escape",this.onEscapeKeyCommand)),this.disposables.push(e.commands.registerCommand("vscode-neovim.enable",(()=>this.onEnableCommand("enable")))),this.disposables.push(e.commands.registerCommand("vscode-neovim.disable",(()=>this.onEnableCommand("disable")))),this.disposables.push(e.commands.registerCommand("vscode-neovim.toggle",(()=>this.onEnableCommand("toggle")))),this.disposables.push(e.commands.registerCommand("vscode-neovim.compositeEscape1",(e=>this.handleCompositeEscapeFirstKey(e)))),this.disposables.push(e.commands.registerCommand("vscode-neovim.compositeEscape2",(e=>this.handleCompositeEscapeSecondKey(e)))),this.disposables.push(e.commands.registerCommand("compositionStart",this.onCompositionStart)),this.disposables.push(e.commands.registerCommand("compositionEnd",this.onCompositionEnd)),this.main.modeManager.onModeChange(this.onModeChange)}dispose(){var e,t;null===(e=this.typeHandlerDisposable)||void 0===e||e.dispose(),null===(t=this.replacePrevCharHandlerDisposable)||void 0===t||t.dispose(),this.disposables.forEach((e=>e.dispose()))}registerType(){this.typeHandlerDisposable||(this.logger.debug(`${me}: Enabling type handler`),this.typeHandlerDisposable=e.commands.registerTextEditorCommand("type",this.onVSCodeType))}disposeType(){this.typeHandlerDisposable&&(this.logger.debug(`${me}: Disabling type handler`),this.typeHandlerDisposable.dispose(),this.typeHandlerDisposable=void 0)}registerReplacePrevChar(){this.replacePrevCharHandlerDisposable||(this.logger.debug(`${me}: Enabling replacePrevChar handler`),this.replacePrevCharHandlerDisposable=e.commands.registerCommand("replacePreviousChar",this.onReplacePreviousChar))}disposeReplacePrevChar(){this.replacePrevCharHandlerDisposable&&(this.logger.debug(`${me}: Disabling replacePrevChar handler`),this.replacePrevCharHandlerDisposable.dispose(),this.replacePrevCharHandlerDisposable=void 0)}}var be=function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))};const ye="CursorManager";class we{constructor(t,n,i){this.logger=t,this.client=n,this.main=i,this.disposables=[],this.cursorModes=new Map,this.neovimCursorPosition=new WeakMap,this.cursorUpdatePromise=new Map,this.wantInsertCursorUpdate=!0,this.gridCursorUpdates=new Set,this.debouncedCursorUpdates=new WeakMap,this.debouncedApplySelectionChanged=new Map,this.getDebouncedUpdateCursorPos=e=>{const t=this.debouncedCursorUpdates.get(e);if(t)return t;const n=D(this.updateCursorPosInEditor,5,{leading:!1,trailing:!0,maxWait:10});return this.debouncedCursorUpdates.set(e,n),n},this.updateCursorPosInEditor=(t,n)=>be(this,void 0,void 0,(function*(){var i,r;if(this.logger.debug(`${ye}: Waiting for document change completion before setting the editor cursor`),yield this.main.changeManager.getDocumentChangeCompletionLock(t.document),this.main.modeManager.isInsertMode&&!this.wantInsertCursorUpdate&&!this.main.modeManager.isRecordingInInsertMode)return this.logger.debug(`${ye}: Skipping insert cursor update in editor`),null===(i=this.cursorUpdatePromise.get(t))||void 0===i||i.resolve(),void this.cursorUpdatePromise.delete(t);const s=this.main.viewportManager.getCursorFromViewport(n);if(!s)return void this.logger.warn(`${ye}: No cursor for gridId from viewport: ${n}`);const o=Q(t,s),a=t.selection;let c;const l=this.main.modeManager.currentMode;l.isVisual?c=yield this.createVisualSelection(t,l,o,void 0):(this.logger.debug(`${ye}: Updating cursor in editor pos: [${o.line}, ${o.character}]`),c=[new e.Selection(o,o)]),this.neovimCursorPosition.set(t,c[0]),t.selections=c,c[0].isEqual(a)||(this.logger.debug(`${ye}: The selection was changed, scroll view`),this.triggerMovementFunctions(t,o)),null===(r=this.cursorUpdatePromise.get(t))||void 0===r||r.resolve(),this.cursorUpdatePromise.delete(t)})),this.onSelectionChanged=t=>{if(this.main.modeManager.isInsertMode)return;const{textEditor:n,kind:i}=t;this.logger.debug(`${ye}: onSelectionChanged, kind: ${i}, editor: ${n.document.uri.fsPath}, active: [${n.selection.active.line}, ${n.selection.active.character}]`),i!==e.TextEditorSelectionChangeKind.Mouse||n.selection.isEmpty||this.updateCursorStyle("visual"),this.getDebouncedApplySelectionChanged(i)(n,i)},this.getDebouncedApplySelectionChanged=t=>{let n;n=void 0!==this.previousApplyDebounceTime?this.previousApplyDebounceTime:t===e.TextEditorSelectionChangeKind.Mouse?100:50,this.previousApplyDebounceTime=n;let i=this.debouncedApplySelectionChanged.get(n);return i||(i=D(this.applySelectionChanged,n,{leading:!1,trailing:!0}),this.debouncedApplySelectionChanged.set(n,i),i)},this.applySelectionChanged=(t,n)=>be(this,void 0,void 0,(function*(){this.updateCursorStyle(this.main.modeManager.currentMode.name),this.logger.debug(`${ye}: Waiting for possible layout completion operation`),yield this.main.bufferManager.waitForLayoutSync(),this.logger.debug(`${ye}: Waiting for possible document change completion operation`),yield this.main.changeManager.getDocumentChangeCompletionLock(t.document),this.logger.debug(`${ye}: Waiting done`);const i=t.selection,r=this.main.changeManager.eatDocumentCursorAfterChange(t.document);r&&r.isEqual(i.active)?this.logger.debug(`${ye}: Skipping onSelectionChanged event since it was selection produced by doc change`):(this.logger.debug(`${ye}: Applying changed selection, kind: ${n},  cursor: [${i.active.line}, ${i.active.character}], isMultiSelection: ${t.selections.length>1}`),i.isEmpty?(this.main.modeManager.isVisualMode&&n==e.TextEditorSelectionChangeKind.Mouse&&(yield this.client.input("<Esc>")),yield this.updateNeovimCursorPosition(t,i.active)):yield this.updateNeovimVisualSelection(t,i)),this.previousApplyDebounceTime=void 0})),this.createVisualSelection=(t,n,i,r)=>be(this,void 0,void 0,(function*(){const s=t.document;if(!r){const n=yield this.client.callFunction("getpos",["v"]);r=Q(t,new e.Position(n[1]-1,n[2]-1))}this.logger.debug(`${ye}: Creating visual selection, mode: ${n.visual}, anchor: [${r.line}, ${r.character}], active: [${i.line}, ${i.character}]`);const o=s.lineAt(i.line).range.end.character,a=s.lineAt(r.line).range.end.character;switch(n.visual){case"char":return r.isBeforeOrEqual(i)?[new e.Selection(r,new e.Position(i.line,Math.min(i.character+1,o)))]:[new e.Selection(new e.Position(r.line,Math.min(r.character+1,a)),i)];case"line":return r.line<=i.line?[new e.Selection(r.line,0,i.line,o)]:[new e.Selection(r.line,a,i.line,0)];case"block":{const t=[],n=r.line<i.line;for(let o=i.line;n?o>=r.line:o<=r.line;n?o--:o++){const n=s.lineAt(o);(n.range.end.character>Math.min(r.character,i.character)||o===i.line)&&t.push(new e.Selection(o,Math.min(r.character,i.character),o,Math.min(Math.max(r.character,i.character)+1,n.range.end.character)))}return t}}})),this.triggerMovementFunctions=(t,n)=>{e.commands.executeCommand("editor.action.wordHighlight.trigger");const i=Math.min(...t.visibleRanges.map((e=>e.start.line))),r=Math.max(...t.visibleRanges.map((e=>e.end.line))),s=n.line-t.selection.active.line,o=s>0?n.line>r+10?e.TextEditorRevealType.InCenterIfOutsideViewport:e.TextEditorRevealType.Default:s<0&&n.line<i-10?e.TextEditorRevealType.InCenterIfOutsideViewport:e.TextEditorRevealType.Default;t.revealRange(new e.Selection(n,n),o),this.main.viewportManager.scrollNeovim(t)},this.disposables.push(e.window.onDidChangeTextEditorSelection(this.onSelectionChanged));const r=()=>{this.updateCursorStyle(),setTimeout((()=>this.updateCursorStyle()),100)};this.disposables.push(e.window.onDidChangeVisibleTextEditors(r)),this.disposables.push(e.window.onDidChangeActiveTextEditor(r))}dispose(){this.disposables.forEach((e=>e.dispose()))}handleExtensionRequest(e,t){return be(this,void 0,void 0,(function*(){switch(e){case"window-scroll":case"visual-changed":{const[e]=t,n=this.main.bufferManager.getGridIdForWinId(e);n&&this.gridCursorUpdates.add(n);break}case"range-command":{const[e,n,i,r,s,o,a,c]=t;try{yield this.handleRangeCommand(e,n,i,r,s,o,!!a,Array.isArray(c)?c:[c])}catch(t){this.logger.error(`${e} failed, range: [${i}, ${r}, ${s}, ${o}] args: ${JSON.stringify(c)} error: ${t.message}`)}break}case"visual-edit":{const[e,n,i,r,s,o,a]=t;this.multipleCursorFromVisualMode(!!e,new d(n),i-1,r-1,s,o,!!a);break}}}))}handleRedrawBatch(e){for(const[t,...n]of e){const e=n[0]||[];switch(t){case"grid_cursor_goto":for(const[e,t,i]of n)this.gridCursorUpdates.add(e);break;case"grid_scroll":for(const[e,t,i,r,s,o,a]of n)this.gridCursorUpdates.add(e);break;case"mode_info_set":{const[,t]=e;for(const e of t)e.name&&e.cursor_shape&&this.cursorModes.set(e.name,{cursorShape:e.cursor_shape});break}case"mode_change":{const[t]=e;this.main.modeManager.isInsertMode&&(this.wantInsertCursorUpdate=!0),this.updateCursorStyle(t);break}}}this.processCursorMoved()}waitForCursorUpdate(e){return be(this,void 0,void 0,(function*(){const t=this.cursorUpdatePromise.get(e);if(t)return t.promise}))}updateCursorStyle(t=this.main.modeManager.currentMode.name){const n=this.cursorModes.get(t);if(!n)return;let i;i="visual"==t?e.TextEditorCursorStyle.LineThin:"block"===n.cursorShape?e.TextEditorCursorStyle.Block:"horizontal"===n.cursorShape?e.TextEditorCursorStyle.Underline:e.TextEditorCursorStyle.Line;for(const t of e.window.visibleTextEditors)t.options.cursorStyle=i}processCursorMoved(){for(const e of this.gridCursorUpdates){this.logger.debug(`${ye}: Received cursor update from neovim, gridId: ${e}`);const t=this.main.bufferManager.getEditorFromGridId(e);t?(this.cursorUpdatePromise.has(t)||this.cursorUpdatePromise.set(t,new ue),this.getDebouncedUpdateCursorPos(t)(t,e)):this.logger.warn(`${ye}: No editor for gridId: ${e}`)}this.gridCursorUpdates.clear()}updateNeovimCursorPosition(t,n){return be(this,void 0,void 0,(function*(){const i=this.main.bufferManager.getWinIdForTextEditor(t);if(!i)return;const r=this.neovimCursorPosition.get(t);if(r&&r.active.isEqual(n))return void this.logger.debug(`${ye}: Skipping event since neovim has same cursor pos`);const s=function(t,n){const i=K(t.document.lineAt(n.line).text,n.character);return new e.Position(n.line,i)}(t,n);this.logger.debug(`${ye}: Updating cursor pos in neovim, winId: ${i}, pos: [${s.line}, ${s.character}]`);const o=[s.line+1,s.character];try{yield this.client.request("nvim_win_set_cursor",[i,o])}catch(e){this.logger.error(`${ye}: ${e.message}`)}}))}updateNeovimVisualSelection(t,n){return be(this,void 0,void 0,(function*(){if(!this.main.bufferManager.getWinIdForTextEditor(t))return;const i=this.main.bufferManager.getBufferIdForTextDocument(t.document);if(!i)return;const r=this.neovimCursorPosition.get(t);if(r&&r.isEqual(n))return void this.logger.debug(`${ye}: Skipping event since neovim has same visual pos`);let s=n.anchor,o=n.active;s.isBeforeOrEqual(o)?o=new e.Position(o.line,Math.max(o.character-1,0)):s=new e.Position(s.line,Math.max(s.character-1,0)),this.logger.debug(`${ye}: Starting visual mode from: [${s.line}, ${s.character}] to [${o.line}, ${o.character}]`);const a=yield this.client.call("visualmode",[1]);yield this.client.call("nvim_buf_set_mark",[i,"<",s.line+1,s.character,{}]),yield this.client.call("nvim_buf_set_mark",[i,">",o.line+1,o.character,{}]),yield this.client.input("V"===a?"gvv":"gv"),yield this.client.call("winrestview",[{curswant:o.character}])}))}handleRangeCommand(t,n,i,r,s,o,a,c){return be(this,void 0,void 0,(function*(){const l=e.window.activeTextEditor;if(!l)return;this.logger.debug(`${ye}: Range command: ${t}, range: [${i}, ${s}] - [${r}, ${o}], leaveSelection: ${a}`);const u=l.selections,h=yield this.createVisualSelection(l,new d(n),new e.Position(r-1,o-1),new e.Position(i-1,s-1));this.neovimCursorPosition.set(l,h[0]),l.selections=h;const f=yield e.commands.executeCommand(t,...c);return this.logger.debug(`${ye}: Range command completed`),a||(this.neovimCursorPosition.set(l,u[0]),l.selections=u),f}))}multipleCursorFromVisualMode(t,n,i,r,s,o,a){return be(this,void 0,void 0,(function*(){if(!e.window.activeTextEditor)return;yield this.waitForCursorUpdate(e.window.activeTextEditor),this.wantInsertCursorUpdate=!1,this.logger.debug(`${ye}: Spawning multiple cursors from lines: [${i}, ${r}], col: [${s}, ${o}], mode: ${n.visual}, append: ${t}, skipEmpty: ${a}`);const c=[],l=e.window.activeTextEditor.document;for(let u=i;u<=r;u++){const i=l.lineAt(u);if(""===i.text.trim()&&(a||"block"===n.visual))continue;let r=0;r="line"===n.visual?t?i.range.end.character:i.firstNonWhitespaceCharacterIndex:t?Math.max(s,o):Math.min(s,o)-1,this.logger.debug(`${ye}: Multiple cursor at: [${u}, ${r}]`),c.push(new e.Selection(u,r,u,r))}e.window.activeTextEditor.selections=c}))}}var _e,xe=n(7147),Ee=n.n(xe);!function(e){e[e.none=0]="none",e[e.error=1]="error",e[e.warn=2]="warn",e[e.debug=3]="debug"}(_e||(_e={}));class Se{constructor(e,t,n=!1){if(this.logLevel=e,this.outputToConsole=n,this.disposables=[],this.fd=0,e!==_e.none)try{this.fd=Ee().openSync(t,"w")}catch(e){}}dispose(){this.fd&&Ee().closeSync(this.fd),this.disposables.forEach((e=>e.dispose()))}debug(e){e=`${this.getTimestamp()} ${e}`,this.logLevel>=_e.debug&&(this.fd&&Ee().appendFileSync(this.fd,e+"\n"),this.outputToConsole&&console.log(e))}warn(e){e=`${this.getTimestamp()} ${e}`,this.logLevel>=_e.warn&&(this.fd&&Ee().appendFileSync(this.fd,e+"\n"),this.outputToConsole&&console.log(e))}error(t){t=`${this.getTimestamp()} ${t}`,this.logLevel>=_e.error&&(this.fd&&Ee().appendFileSync(this.fd,t+"\n"),this.outputToConsole&&console.log(t)),e.window.showErrorMessage(t)}getTimestamp(){return(new Date).toISOString()}}new Error("timeout while waiting for mutex to become available"),new Error("mutex already locked");const Ce=new Error("request for lock canceled");class Me{constructor(e,t=Ce){this._value=e,this._cancelError=t,this._weightedQueues=[],this._weightedWaiters=[]}acquire(e=1){if(e<=0)throw new Error(`invalid weight ${e}: must be positive`);return new Promise(((t,n)=>{this._weightedQueues[e-1]||(this._weightedQueues[e-1]=[]),this._weightedQueues[e-1].push({resolve:t,reject:n}),this._dispatch()}))}runExclusive(e,t=1){return n=this,i=void 0,s=function*(){const[n,i]=yield this.acquire(t);try{return yield e(n)}finally{i()}},new((r=void 0)||(r=Promise))((function(e,t){function o(e){try{c(s.next(e))}catch(e){t(e)}}function a(e){try{c(s.throw(e))}catch(e){t(e)}}function c(t){var n;t.done?e(t.value):(n=t.value,n instanceof r?n:new r((function(e){e(n)}))).then(o,a)}c((s=s.apply(n,i||[])).next())}));var n,i,r,s}waitForUnlock(e=1){if(e<=0)throw new Error(`invalid weight ${e}: must be positive`);return new Promise((t=>{this._weightedWaiters[e-1]||(this._weightedWaiters[e-1]=[]),this._weightedWaiters[e-1].push(t),this._dispatch()}))}isLocked(){return this._value<=0}getValue(){return this._value}setValue(e){this._value=e,this._dispatch()}release(e=1){if(e<=0)throw new Error(`invalid weight ${e}: must be positive`);this._value+=e,this._dispatch()}cancel(){this._weightedQueues.forEach((e=>e.forEach((e=>e.reject(this._cancelError))))),this._weightedQueues=[]}_dispatch(){var e;for(let t=this._value;t>0;t--){const n=null===(e=this._weightedQueues[t-1])||void 0===e?void 0:e.shift();if(!n)continue;const i=this._value,r=t;this._value-=t,t=this._value+1,n.resolve([i,this._newReleaser(r)])}this._drainUnlockWaiters()}_newReleaser(e){let t=!1;return()=>{t||(t=!0,this.release(e))}}_drainUnlockWaiters(){for(let e=this._value;e>0;e--)this._weightedWaiters[e-1]&&(this._weightedWaiters[e-1].forEach((e=>e())),this._weightedWaiters[e-1]=[])}}class Te{constructor(e){this._semaphore=new Me(1,e)}acquire(){return e=this,t=void 0,i=function*(){const[,e]=yield this._semaphore.acquire();return e},new((n=void 0)||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}));var e,t,n,i}runExclusive(e){return this._semaphore.runExclusive((()=>e()))}isLocked(){return this._semaphore.isLocked()}waitForUnlock(){return this._semaphore.waitForUnlock()}release(){this._semaphore.isLocked()&&this._semaphore.release()}cancel(){return this._semaphore.cancel()}}var $e=function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))};const Oe="DocumentChangeManager";class ke{constructor(t,n,i){this.logger=t,this.client=n,this.main=i,this.disposables=[],this.pendingEvents=[],this.bufferSkipTicks=new Map,this.documentSkipVersionOnChange=new WeakMap,this.textDocumentChangePromise=new Map,this.cursorAfterTextDocumentChange=new WeakMap,this.documentContentInNeovim=new WeakMap,this.applyingEdits=!1,this.documentChangeLock=new Te,this.onBufferInit=(e,t)=>{this.logger.debug(`${Oe}: Init buffer content for bufId: ${e}, uri: ${t.uri.toString()}`),this.documentContentInNeovim.set(t,t.getText())},this.onNeovimChangeEvent=(e,t,n,i,r,s)=>{this.logger.debug(`${Oe}: Received neovim buffer changed event for bufId: ${e}, tick: ${t}`);const o=this.main.bufferManager.getTextDocumentForBufferId(e);o?(this.bufferSkipTicks.get(e)||0)>=t?this.logger.debug(`${Oe}: BufId: ${e} skipping tick: ${t}`):n!==i||0!==r.length?(this.textDocumentChangePromise.has(o)||this.textDocumentChangePromise.set(o,[]),this.textDocumentChangePromise.get(o).push(new ue),this.pendingEvents.push([e,t,n,i,r,s]),this.applyingEdits||this.applyEdits()):this.logger.debug(`${Oe}: BufId: ${e} empty change, skipping`):this.logger.debug(`${Oe}: No text document for buffer: ${e}`)},this.applyEdits=()=>$e(this,void 0,void 0,(function*(){var t,n;let i;this.applyingEdits=!0,this.logger.debug(`${Oe}: Applying neovim edits`);const r=setTimeout((()=>{e.window.withProgress({location:e.ProgressLocation.Notification,title:"Applying neovim edits"},(()=>new Promise((e=>i=e))))}),1e3);for(;this.pendingEvents.length;){const i=new Map;let r=this.pendingEvents.shift();for(;r;){const[e,t,n,s,o,a]=r,c=this.main.bufferManager.getTextDocumentForBufferId(e);if(!c){this.logger.warn(`${Oe}: No document for ${e}, skip`);continue}this.logger.debug(`${Oe}: Accumulating edits for ${c.uri.toString()}, bufId: ${e}`),i.get(c)||i.set(c,se(c));let l=i.get(c);if(n!==s&&s===n+1&&1===o.length&&""===o[0])for(let e=n;e<s;e++)l[e]="";else if(n!==s&&1===o.length&&""===o[0]){for(let e=1;e<s-n;e++)l.splice(n,1);l[n]=""}else if(n===s||o.length)n===s?(n>l.length&&o.unshift(""),0===n?l.unshift(...o):l=[...l.slice(0,n),...o,...l.slice(n)]):(n>=l.length&&o.unshift(""),l=[...l.slice(0,n),...o,...l.slice(s)]);else for(let e=0;e<s-n;e++)l.splice(n,1);i.set(c,l),r=this.pendingEvents.shift()}for(const[r,s]of i){const i=(null===(t=this.textDocumentChangePromise.get(r))||void 0===t?void 0:t.length)||0;try{if(this.logger.debug(`${Oe}: Applying edits for ${r.uri.toString()}`),r.isClosed){this.logger.debug(`${Oe}: Document was closed, skippnig`);continue}const t=e.window.visibleTextEditors.find((e=>e.document===r));if(!t){this.logger.debug(`${Oe}: No visible text editor for document, skipping`);continue}let o=r.getText();const a=r.eol===e.EndOfLine.CRLF?"\r\n":"\n";let c=s.join(a);o+=`${a}end${a}end`,c+=`${a}end${a}end`;const l=G(o,c),u=Y(U()(l.chars1,l.chars2));if(!u.length)continue;this.documentSkipVersionOnChange.set(r,r.version+1);const h=t.selection.active,d=yield t.edit((n=>{for(const i of u){const r=s.slice(i.newStart,i.newEnd+1);if("removed"===i.type)if(i.end>=t.document.lineCount-1&&i.start>0){const r=t.document.lineAt(i.start-1).range.end.character;n.delete(new e.Range(i.start-1,r,i.end,999999))}else n.delete(new e.Range(i.start,0,i.end+1,0));else if("changed"===i.type){const s=t.document.getText(new e.Range(i.start,0,i.end,99999)).replace("\r\n","\n"),o=r.join("\n");if(o.length>s.length&&o.startsWith(s))n.insert(new e.Position(i.start,s.length),o.slice(s.length));else{const t=i.start==i.end&&i.newStart==i.newEnd;let a;t&&(a=ce(U()(s,o))),a&&t?le(n,{editorOps:a,line:i.newStart}):n.replace(new e.Range(i.start,0,i.end,999999),r.join("\n"))}}else"added"===i.type&&(i.start>=t.document.lineCount?r.unshift(...new Array(i.start-(t.document.lineCount-1)).fill("")):r.push(""),n.insert(new e.Position(i.start,0),r.join("\n")))}}),{undoStopAfter:!1,undoStopBefore:!1}),f=(null===(n=this.textDocumentChangePromise.get(r))||void 0===n?void 0:n.splice(0,i))||[];d?(t.selection.anchor.isEqual(t.selection.active)?t.selections=[new e.Selection(h,h)]:t.selections=[new e.Selection(t.selection.active,t.selection.active)],this.cursorAfterTextDocumentChange.set(t.document,t.selection.active),f.forEach((e=>e.resolve&&e.resolve())),this.logger.debug(`${Oe}: Changes succesfully applied for ${r.uri.toString()}`),this.documentContentInNeovim.set(r,r.getText())):(f.forEach((e=>{e.promise.catch((()=>this.logger.warn(`${Oe}: Edit was canceled for doc: ${r.uri.toString()}`))),e.reject()})),this.logger.warn(`${Oe}: Changes were not applied for ${r.uri.toString()}`))}catch(e){this.logger.error(`${Oe}: Error applying neovim edits, error: ${e.message}`)}}}const s=[...this.textDocumentChangePromise.values()].flatMap((e=>e));this.textDocumentChangePromise.clear(),s.forEach((e=>e.resolve&&e.resolve())),r&&clearTimeout(r),i&&i(),this.pendingEvents.length&&this.applyEdits(),this.applyingEdits=!1})),this.onChangeTextDocument=e=>$e(this,void 0,void 0,(function*(){const{document:t}=e,n=this.documentContentInNeovim.get(t);null!=n?(this.documentContentInNeovim.set(t,t.getText()),yield this.documentChangeLock.runExclusive((()=>$e(this,void 0,void 0,(function*(){return yield this.onChangeTextDocumentLocked(e,n)}))))):this.logger.warn(`${Oe}: Can't get last known neovim content for ${t.uri.toString()}, skipping`)})),this.onChangeTextDocumentLocked=(t,n)=>$e(this,void 0,void 0,(function*(){var i;const{document:r,contentChanges:s}=t;if(this.logger.debug(`${Oe}: Change text document for uri: ${r.uri.toString()}`),this.logger.debug(`${Oe}: Version: ${r.version}, skipVersion: ${this.documentSkipVersionOnChange.get(r)}`),(null!==(i=this.documentSkipVersionOnChange.get(r))&&void 0!==i?i:0)>=r.version)return void this.logger.debug(`${Oe}: Skipping a change since versions equals`);const o=this.main.bufferManager.getBufferIdForTextDocument(r);if(!o)return void this.logger.warn(`${Oe}: No neovim buffer for ${r.uri.toString()}`);const a=r.eol===e.EndOfLine.LF?"\n":"\r\n",c=this.dotRepeatStartModeInsertHint,l=e.window.activeTextEditor;if(l&&l.document===r&&this.main.modeManager.isInsertMode){this.dotRepeatStartModeInsertHint=void 0;const e=l.selection.active;for(const t of s)te(t,e,a)&&(this.dotRepeatChange&&ee(t,this.dotRepeatChange)?this.dotRepeatChange=re(t,this.dotRepeatChange):this.dotRepeatChange=ie(t,a,c))}const u=[];for(const e of s){const{text:t,range:{start:i,end:r}}=e,s=K(n.split(a)[i.line],i.character),o=K(n.split(a)[r.line],r.character);u.push([i.line,s,r.line,o,t.split(a)])}const h=yield this.client.request("nvim_buf_get_changedtick",[o]);h?(this.bufferSkipTicks.set(o,h+u.length),this.logger.debug(`${Oe}: Setting wantInsertCursorUpdate to false`),this.main.cursorManager.wantInsertCursorUpdate=!1,yield this.client.executeLua("return require('vscode-neovim.api').handle_changes(...)",[o,u])):this.logger.warn(`${Oe}: Can't get changed tick for bufId: ${o}, deleted?`)})),this.main.bufferManager.onBufferEvent=this.onNeovimChangeEvent,this.main.bufferManager.onBufferInit=this.onBufferInit,this.disposables.push(e.workspace.onDidChangeTextDocument(this.onChangeTextDocument))}dispose(){this.disposables.forEach((e=>e.dispose()))}eatDocumentCursorAfterChange(e){const t=this.cursorAfterTextDocumentChange.get(e);return this.cursorAfterTextDocumentChange.delete(e),t}getDocumentChangeCompletionLock(e){return $e(this,void 0,void 0,(function*(){const t=this.textDocumentChangePromise.get(e);t&&t.length&&(yield Promise.all(t.map((e=>e.promise)).filter(Boolean)))}))}hasDocumentChangeCompletionLock(e){var t;return((null===(t=this.textDocumentChangePromise.get(e))||void 0===t?void 0:t.length)||0)>0}handleExtensionRequest(e,t){return $e(this,void 0,void 0,(function*(){if("insert-line"===e){const[e]=t;this.dotRepeatStartModeInsertHint="before"===e?"O":"o",this.logger.debug(`${Oe}: Setting start insert mode hint - ${this.dotRepeatStartModeInsertHint}`)}}))}syncDotRepeatWithNeovim(){return $e(this,void 0,void 0,(function*(){if(!this.dotRepeatChange)return;this.logger.debug(`${Oe}: Syncing dot repeat`);const e=Object.assign({},this.dotRepeatChange);this.dotRepeatChange=void 0;const t=yield this.client.window,n=yield this.client.createBuffer(!1,!0);if("number"==typeof n)return;yield this.client.setOption("eventignore","BufWinEnter,BufEnter,BufLeave");const i=yield this.client.openWindow(n,!0,{external:!0,width:100,height:100});if(yield this.client.setOption("eventignore",""),"number"==typeof i)return;const r=[],s=e.rangeLength;if(s){const e=new Array(s).fill("x").join("");r.push(["nvim_buf_set_lines",[n.id,0,0,!1,[e]]],["nvim_win_set_cursor",[i.id,[1,s]]])}let o="";e.startMode&&(o+=`<Esc>${e.startMode}`,e.text.startsWith(e.eol)&&(e.text=e.text.slice(e.eol.length))),e.rangeLength&&(o+=[...new Array(e.rangeLength).keys()].map((()=>"<BS>")).join("")),o+=e.text.split(e.eol).join("\n").replace("<","<LT>"),r.push(["nvim_input",[o]]),yield ae(this.client,r,this.logger,Oe);const a=[];a.push(["nvim_set_current_win",[t.id]]),a.push(["nvim_win_close",[i.id,!0]]),yield ae(this.client,a,this.logger,Oe)}))}}const Pe="CmdLine";class Re{constructor(t,n,i){this.logger=t,this.client=n,this.callbacks=i,this.isDisplayed=!1,this.disposables=[],this.completionAllowed=!1,this.completionItems=[],this.mode="",this.ignoreHideEvent=!1,this.redrawExpected=!1,this.updatedFromNvim=!1,this.onAccept=()=>{this.isDisplayed&&(this.callbacks.onChanged(this.input.value,!1),this.callbacks.onAccepted())},this.onChange=e=>{if(!this.isDisplayed)return;const t=this.mode;":"!==t||"?"!==e.charAt(0)&&"/"!==e.charAt(0)||!this.input.items.length||(this.input.items=[],this.completionItems=[]);const n=!(":"!==t||"?"===e.charAt(0)||"/"===e.charAt(0)||e.includes("s/")||e.includes("substitute/")||e.includes("g/")||e.includes("global/")||e.includes("v/")||e.includes("vglobal/"));n||this.cancelCompletions(),this.updatedFromNvim?(this.updatedFromNvim=!1,this.logger.debug(`${Pe}: Skipped updating cmdline because change originates from nvim: ${e}`)):(this.logger.debug(`${Pe}: Sending cmdline to nvim: ${e}`),this.callbacks.onChanged(e,n))},this.onHide=()=>{this.isDisplayed&&(this.clean(),this.ignoreHideEvent?this.ignoreHideEvent=!1:this.callbacks.onCanceled())},this.processCompletionTimer=()=>{this.completionAllowed=!0,this.isDisplayed&&this.completionItems.length&&(this.input.items=this.completionItems),this.completionTimer=void 0},this.cancelCompletions=()=>{this.completionTimer&&(clearTimeout(this.completionTimer),this.completionTimer=void 0),this.input.items=[]},this.acceptSelection=()=>{if(!this.isDisplayed)return;const e=this.input.activeItems[0];if(!e)return;const t=e.label;let n=this.input.value;const i=/[\s/\\!@#$:<'>%]/g;i.test(n)&&(n=n.split(i).pop());const r=t.search(n);n&&-1!==r||"~"===n?this.input.value=this.input.value.replace(n,t):this.input.value+=t,this.onChange(this.input.value)},this.sendRedraw=e=>{this.redrawExpected=!0,this.client.input(e)},this.testCmdline=e=>{this.input.value+=e},this.callbacks=i,this.input=e.window.createQuickPick(),this.input.ignoreFocusOut=!0,this.disposables.push(this.input.onDidAccept(this.onAccept)),this.disposables.push(this.input.onDidChangeValue(this.onChange)),this.disposables.push(this.input.onDidHide(this.onHide)),this.disposables.push(e.commands.registerCommand("vscode-neovim.commit-cmdline",this.onAccept)),this.disposables.push(e.commands.registerCommand("vscode-neovim.complete-selection-cmdline",this.acceptSelection)),this.disposables.push(e.commands.registerCommand("vscode-neovim.send-cmdline",this.sendRedraw)),this.disposables.push(e.commands.registerCommand("vscode-neovim.test-cmdline",this.testCmdline))}show(e="",t,n=""){if(this.isDisplayed){const i=n||this.getTitle(t);i!==this.input.title&&(this.input.title=i),this.redrawExpected&&this.input.value!==e?(this.input.value=e,this.redrawExpected=!1,this.updatedFromNvim=!0):this.logger.debug(`${Pe}: Ignoring cmdline_show because no redraw expected: ${e}`)}else this.input.value="",this.isDisplayed=!0,this.mode=t,this.input.title=n||this.getTitle(t),this.input.show(),e&&(this.input.value=e),this.completionAllowed=!1,this.completionItems=[],this.input.items=[],this.completionTimer=setTimeout(this.processCompletionTimer,1500)}setCompletionItems(e){this.completionItems=e.map((e=>({label:e,alwaysShow:!0}))),this.completionAllowed&&(this.input.items=this.completionItems)}cancel(e=!1){this.ignoreHideEvent=e,this.input.hide()}dispose(){for(const e of this.disposables)e.dispose();this.input.dispose()}getTitle(e){switch(e){case"/":return"⟳ Forward Search:";case"?":return"⟲ Backward Search:";case":":return"⌘ VIM Command Line:";default:return e}}clean(){this.completionTimer&&clearTimeout(this.completionTimer),this.isDisplayed=!1,this.input.value="",this.input.title="",this.mode="",this.completionAllowed=!1,this.input.items=[],this.completionItems=[]}}var Ae=function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))};class Ie{constructor(e,t){this.logger=e,this.client=t,this.disposables=[],this.showCmd=(e,t,n)=>{this.commandLine||(this.commandLine=new Re(this.logger,this.client,{onAccepted:this.onCmdAccept,onCanceled:this.onCmdCancel,onChanged:this.onCmdChange})),this.commandLine.show(e,t,n)},this.showCmdOnTimer=(e,t,n)=>{this.showCmd(e,t,n),this.cmdlineTimer=void 0},this.onCmdChange=(e,t)=>Ae(this,void 0,void 0,(function*(){let n="<C-u>"+oe(e);t&&(n+="<C-e>"),yield this.client.input(n)})),this.onCmdCancel=()=>Ae(this,void 0,void 0,(function*(){yield this.client.input("<Esc>")})),this.onCmdAccept=()=>{this.client.input("<CR>")}}dispose(){this.commandLine&&this.commandLine.dispose(),this.disposables.forEach((e=>e.dispose()))}handleRedrawBatch(e){for(const[t,...n]of e){const e=n[0]||[];switch(t){case"cmdline_show":{const[t,n,i,r,s,o]=e,a=t.map((([,e])=>e)).join("");this.cmdlineTimer?(clearTimeout(this.cmdlineTimer),this.cmdlineTimer=void 0,this.showCmd(a,i,r)):""===a||"'<,'>"===a||this.commandLine?this.showCmd(a,i,r):this.cmdlineTimer=setTimeout((()=>this.showCmdOnTimer(a,i,r)),200);break}case"wildmenu_show":{const[t]=e;this.commandLine&&this.commandLine.setCompletionItems(t);break}case"cmdline_hide":this.cmdlineTimer?(clearTimeout(this.cmdlineTimer),this.cmdlineTimer=void 0):this.commandLine&&(this.commandLine.cancel(!0),this.commandLine.dispose(),this.commandLine=void 0)}}}}class je{constructor(){this._modeText="",this._statusText="",this._msgText="",this._seperator=" - ",this.statusBar=e.window.createStatusBarItem(e.StatusBarAlignment.Left,10),this._seperator=e.workspace.getConfiguration("window").get("titleSeparator",this._seperator)}refreshStatusBar(){const e=[];this._modeText.length&&e.push(this._modeText),this._statusText.length&&e.push(this._statusText),this._msgText.length&&e.push(this._msgText),e.length?(this.statusBar.text=e.join(this._seperator),this.statusBar.show()):this.statusBar.hide()}set modeString(e){this._modeText=e,this.refreshStatusBar()}set statusString(e){this._statusText=e,this.refreshStatusBar()}set msgString(e){this._msgText=e,this.refreshStatusBar()}dispose(){this.statusBar.dispose()}}class Le{constructor(e,t){this.logger=e,this.client=t,this.disposables=[],this.statusLine=new je,this.disposables.push(this.statusLine)}dispose(){this.disposables.forEach((e=>e.dispose()))}handleRedrawBatch(e){let t=!1,n=!1;e.forEach((([i,...r],s)=>{const o=r[0]||[],a=r[r.length-1]||[];switch(i){case"msg_showcmd":{const[e]=o;let t="";if(e)for(const n of e){const[,e]=n;e&&(t+=e)}this.statusLine.statusString=t;break}case"msg_show":{let i="";for(const[o,a]of r)if("return_prompt"===o&&(t=!0,n=!!e.slice(s).find((([e])=>"mouse_on"===e))),a)for(const e of a){const[,t]=e;t&&(i+=t)}this.statusLine.msgString=i;break}case"msg_showmode":{const[e]=a;let t="";if(e)for(const n of e){const[,e]=n;e&&(t+=e)}this.statusLine.modeString=t;break}case"msg_clear":this.statusLine.msgString=""}})),t&&!n&&this.client.input("<CR>")}}function De(t){return"string"==typeof t&&t.startsWith("theme.")&&(t=new e.ThemeColor(t.slice(6))),t}function Ne(e){const t=Object.assign(Object.assign({},e),{after:e.after?Object.assign({},e.after):void 0,before:e.before?Object.assign({},e.before):void 0});return t.backgroundColor=De(t.backgroundColor),t.borderColor=De(t.borderColor),t.color=De(t.color),t.outlineColor=De(t.outlineColor),t.overviewRulerColor=De(t.overviewRulerColor),t.after&&(t.after.backgroundColor=De(t.after.backgroundColor),t.after.borderColor=De(t.after.borderColor),t.after.color=De(t.after.color)),t.before&&(t.before.backgroundColor=De(t.before.backgroundColor),t.before.borderColor=De(t.before.borderColor),t.before.color=De(t.before.color)),t}class Be{constructor(e){this.highlights=new Map,this.prevGridHighlightsIds=new Map,this.highlighIdToDecorator=new Map,this.decoratorConfigurations=new Map,this.configuration=e;for(const[e,t]of Object.entries(this.configuration.highlights))"vim"!==t&&(this.configuration.highlights[e]=Ne(t))}addHighlightGroup(t,n,i){var r;const s=i.reverse().find((e=>void 0!==this.configuration.highlights[e])),o=s&&this.configuration.highlights[s];if(o&&"vim"!==o)this.highlighIdToDecorator.has(t)||this.createDecoratorForHighlightId(t,o);else if(this.highlighIdToDecorator.has(t)&&(null===(r=this.highlighIdToDecorator.get(t))||void 0===r||r.dispose()),Object.keys(n).length){const i=function(t){const n={};void 0!==t.background&&(n.backgroundColor="#"+t.background.toString(16).padStart(6,"0")),void 0!==t.foreground&&(n.color="#"+t.foreground.toString(16).padStart(6,"0"));const i=void 0!==t.special?"#"+t.special.toString(16).padStart(6,"0"):"";return void 0!==t.reverse&&(n.backgroundColor=new e.ThemeColor("editor.foreground"),n.color=new e.ThemeColor("editor.background")),void 0!==t.italic&&(n.fontStyle="italic"),void 0!==t.bold&&(n.fontWeight="bold"),void 0!==t.strikethrough&&(n.textDecoration="line-through solid"),void 0!==t.underline&&(n.textDecoration=`underline ${i} solid`),void 0!==t.undercurl&&(n.textDecoration=`underline ${i} wavy`),n}(n);this.createDecoratorForHighlightId(t,i)}}getDecoratorForHighlightId(e){return this.highlighIdToDecorator.get(e)}getDecoratorOptions(e){return this.decoratorConfigurations.get(e)}cleanRow(e,t){const n=this.highlights.get(e);n&&delete n[t]}processHLCellsEvent(e,t,n,i,r){let s=0,o=n;this.highlights.has(e)||this.highlights.set(e,[]);const a=this.highlights.get(e);let c=!1;for(const[e,[n,l,u]]of r.entries()){null!=l&&(s=l);let h=n;if(""===h&&e>0&&1==r[e-1][0].length)continue;if("♥"===h)continue;const d="\t"===h||"❥"===h?1:u||1;for(let e=0;e<d;e++){if(a[t]||(a[t]=[]),0!=s){c=!0;const e={hlId:s},n=i.slice(o,o+h.length);"❥"===h&&(h="\t"),o<=i.length&&""!==h&&n!==h&&(e.virtText=h.replace(" ","‍"),e.overlayPos=i.length>0?o:1),a[t][o]=e}else a[t][o]&&(c=!0,delete a[t][o]);o++}}return c}shiftGridHighlights(e,t,n){const i=this.highlights.get(e);if(i)if(t>0){for(let e=0;e<t;e++)delete i[n+e];const e=[];i.forEach(((t,n)=>{e.push(n)}));for(const r of e)r<=n||(i[r-t]=i[r],delete i[r])}else if(t<0){for(let e=0;e<Math.abs(t);e++)delete i[0!==n?n+e:i.length-1-e];const e=[];i.forEach(((t,n)=>{e.push(n)}));for(const r of e.reverse())r<=n||(i[r+Math.abs(t)]=i[r],delete i[r])}}getGridHighlights(t,n,i){const r=[],s=new Map,o=this.highlights.get(n);if(o){let e=0,t=0,n=0,i=0,r=0;o.forEach(((o,a)=>{o.forEach(((o,c)=>{if(o.virtText)return s.has(o.hlId)||s.set(o.hlId,[]),void s.get(o.hlId).push({lineS:a,lineE:a,colS:o.overlayPos||c,colE:c+1,hl:o});e===o.hlId&&n===a&&r===c-1||(e&&(s.has(e)||s.set(e,[]),s.get(e).push({lineS:t,lineE:n,colS:i,colE:r}),e=0,i=0,r=0,t=0,n=0),e=o.hlId,t=a,n=a,i=c),r=c}))})),e&&(s.has(e)||s.set(e,[]),s.get(e).push({lineS:t,lineE:n,colS:i,colE:r}))}for(const[n,o]of s){const s=this.getDecoratorForHighlightId(n);if(!s)continue;const a=o.map((n=>{const r=t.document.lineAt(Math.min(i+n.lineS,t.document.lineCount-1)).text.length;if(n.hl){const t=this.getDecoratorOptions(s);return this.createVirtTextDecorationOption(n.hl.virtText,Object.assign(Object.assign({},t),{backgroundColor:t.backgroundColor||new e.ThemeColor("editor.background")}),i+n.lineS,n.colS+1,r)}return{range:new e.Range(i+n.lineS,n.colS,i+n.lineE,n.colE+1)}}));r.push([s,a])}const a=this.prevGridHighlightsIds.get(n);if(a)for(const e of a)if(!s.has(e)){const t=this.getDecoratorForHighlightId(e);if(!t)continue;r.push([t,[]])}return this.prevGridHighlightsIds.set(n,new Set(s.keys())),r}createDecoratorForHighlightId(t,n){const i=e.window.createTextEditorDecorationType(n);this.decoratorConfigurations.set(i,n),this.highlighIdToDecorator.set(t,i)}createVirtTextDecorationOption(t,n,i,r,s){return{range:new e.Range(i,r+t.length-1,i,r+t.length-1),renderOptions:{after:Object.assign(Object.assign(Object.assign({margin:`0 0 0 -${Math.min(s-r+1,t.length)}ch`},n),n.before),{width:`${t.length}ch; position:absolute; z-index:99;`,contentText:t})}}}}class Ue{constructor(e,t){this.main=e,this.settings=t,this.disposables=[],this.commandsDisposables=[],this.applyHLGridUpdates=e=>{for(const t of e){const e=this.main.viewportManager.getGridOffset(t),n=this.main.bufferManager.getEditorFromGridId(t);n&&e&&this.main.changeManager.getDocumentChangeCompletionLock(n.document).then((()=>{const i=this.highlightProvider.getGridHighlights(n,t,e.line);for(const[e,t]of i)n.setDecorations(e,t)}))}},this.highlightProvider=new Be(t)}dispose(){this.disposables.forEach((e=>e.dispose())),this.commandsDisposables.forEach((e=>e.dispose()))}handleRedrawBatch(e){const t=new Set;for(const[n,...i]of e)switch(n){case"hl_attr_define":for(const[e,t,,n]of i)this.highlightProvider.addHighlightGroup(e,t,n.map((e=>e.hi_name)));break;case"grid_scroll":for(const[e,n,,,,r]of i)1!==e&&(this.highlightProvider.shiftGridHighlights(e,r,n),t.add(e));break;case"grid_line":{const e=i;for(let[n,i,r,s]of e){const e=this.main.viewportManager.getGridOffset(n);if(!e)continue;const o=this.main.bufferManager.getEditorFromGridId(n);if(!o)continue;const a=e.line+i;if(a>=o.document.lineCount||a<0){a>0&&(this.highlightProvider.cleanRow(n,i),t.add(n));continue}const c=o.document.lineAt(a).text,l=X(c,r+e.character,o.options.tabSize);this.highlightProvider.processHLCellsEvent(n,i,l,c,s)&&t.add(n)}break}}t.size&&this.applyHLGridUpdates(t)}}class qe{constructor(e,t){this.logger=e,this.main=t,this.disposables=[]}dispose(){this.disposables.forEach((e=>e.dispose()))}handleVSCodeCommand(t,n){return i=this,r=void 0,o=function*(){const i=e.window.activeTextEditor;if(i)return yield this.main.cursorManager.waitForCursorUpdate(i),yield e.commands.executeCommand(t,...n)},new((s=void 0)||(s=Promise))((function(e,t){function n(e){try{c(o.next(e))}catch(e){t(e)}}function a(e){try{c(o.throw(e))}catch(e){t(e)}}function c(t){var i;t.done?e(t.value):(i=t.value,i instanceof s?i:new s((function(e){e(i)}))).then(n,a)}c((o=o.apply(i,r||[])).next())}));var i,r,s,o}}class Fe{constructor(t){this.logger=t,this.disposables=[],this.channel=e.window.createOutputChannel(`${H}`),this.disposables.push(this.channel)}dispose(){this.disposables.forEach((e=>e.dispose()))}handleRedrawBatch(e){for(const[t,...n]of e)switch(t){case"msg_show":{let e="";for(const[t,i,r]of n){if("return_prompt"===t)continue;r&&(this.channel.clear(),e="");let n="";for(const e of i)n+=e[1];e+=("\n"===n[0]?"":"\n")+n}e.split("\n").slice(1).length>2&&this.channel.show(!0),this.channel.append(e);break}case"msg_history_show":{let e="\n";for(const t of n)for(const n of t)for(const[t,i]of n){let n="";for(const e of i)n+=e[1];e+=`${t}: ${n}\n`}this.channel.show(!0),this.channel.append(e);break}}}}var We=function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))};class Ve{constructor(){this.line=0,this.col=0,this.topline=0,this.botline=0,this.leftcol=0,this.skipcol=0}}class He{constructor(t,n,i,r){this.logger=t,this.client=n,this.main=i,this.neovimViewportHeightExtend=r,this.disposables=[],this.gridViewport=new Map,this.onDidChangeVisibleRange=e=>We(this,void 0,void 0,(function*(){this.scrollNeovim(e.textEditor)})),this.disposables.push(e.window.onDidChangeTextEditorVisibleRanges(this.onDidChangeVisibleRange))}dispose(){this.disposables.forEach((e=>e.dispose()))}getViewport(e){return this.gridViewport.has(e)||this.gridViewport.set(e,new Ve),this.gridViewport.get(e)}getCursorFromViewport(t){const n=this.getViewport(t);return new e.Position(n.line,n.col)}getGridOffset(t){const n=this.getViewport(t);return new e.Position(n.topline,n.leftcol)}handleExtensionRequest(e,t){return We(this,void 0,void 0,(function*(){switch(e){case"window-scroll":{const[e,n]=t,i=this.main.bufferManager.getGridIdForWinId(e);if(!i){this.logger.warn(`ViewportManager: Unable to update scrolled view. No grid for winId: ${e}`);break}const r=this.getViewport(i);r.leftcol=n.leftcol,r.skipcol=n.skipcol;break}}}))}handleRedrawBatch(e){for(const[t,...n]of e)switch(t){case"win_viewport":for(const[e,t,i,r,s,o,a,c]of n){const t=this.getViewport(e);t.topline=i,t.botline=r,t.line=s,t.col=o}break;case"grid_destroy":for(const[e]of n)this.gridViewport.delete(e)}}scrollNeovim(e){if(null==e||this.main.modeManager.isInsertMode)return;const t=e.visibleRanges;if(!t||0==t.length||t[0].end.line-t[0].start.line<=1)return;const n=t[0].start.line-this.neovimViewportHeightExtend,i=t[t.length-1].end.line+t.length+this.neovimViewportHeightExtend,r=e.selection.active.line,s=this.main.bufferManager.getGridIdFromEditor(e);if(null==s)return;const o=this.gridViewport.get(s);o&&n!=(null==o?void 0:o.topline)&&r==(null==o?void 0:o.line)&&this.client.lua("require('vscode-neovim.api').scroll_viewport(...)",[Math.max(n,0),i])}}var ze=function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))};const Ge="MainController";class Ye{constructor(e){this.disposables=[],this.currentRedrawBatch=[],this.onNeovimNotification=(e,t)=>{const n=[this.bufferManager,this.viewportManager,this.cursorManager,this.commandLineManager,this.statusLineManager,this.highlightManager,this.multilineMessagesManager],i=[this.modeManager,this.changeManager,this.commandsController,this.bufferManager,this.viewportManager,this.cursorManager],r=[this.customCommandsManager];if("vscode-command"===e){const[e,n]=t;return void r.forEach((t=>ze(this,void 0,void 0,(function*(){try{yield t.handleVSCodeCommand(e,Array.isArray(n)?n:[n])}catch(t){this.logger.error(`${e} failed, args: ${JSON.stringify(n)} error: ${t.message}`)}}))))}if("vscode-neovim"===e){const[e,n]=t;return void i.forEach((t=>{try{t.handleExtensionRequest(e,n)}catch(t){this.logger.error(`${e} failed, args: ${JSON.stringify(n)} error: ${t.message}`)}}))}if("redraw"!==e)return;const s=t;if(function(e,t){for(let e=t.length-1;e>=0;e--){const[n]=t[e];if("flush"===n)return t[e]}}(0,t)){const e=[...this.currentRedrawBatch.splice(0),...s];n.forEach((t=>t.handleRedrawBatch(e)))}else this.currentRedrawBatch.push(...s)},this.handleCustomRequest=(e,t,n)=>ze(this,void 0,void 0,(function*(){const i=[this.modeManager,this.changeManager,this.commandsController,this.bufferManager,this.cursorManager],r=[this.customCommandsManager];try{let s;if("vscode-command"===e){const[e,n]=t;s=(yield Promise.all(r.map((t=>t.handleVSCodeCommand(e,Array.isArray(n)?n:[n]))))).find((e=>null!=e))}else if("vscode-neovim"===e){const[e,n]=t;s=(yield Promise.all(i.map((t=>t.handleExtensionRequest(e,n))))).find((e=>null!=e))}n.send(s||"",!1)}catch(e){n.send(e.message,!0)}})),this.settings=e,this.logger=new Se(_e[e.logConf.level],e.logConf.logPath,e.logConf.outputToConsole),this.disposables.push(this.logger);let n=e.extensionPath;e.useWsl&&(n=(0,r.execSync)(`C:\\Windows\\system32\\wsl.exe wslpath '${n}'`).toString().trim());const i=o().posix.join(n,"vim","vscode-neovim.vim"),s=["-N","--embed","-S",o().posix.join(n,"runtime/lua","vscode-neovim/force-options.lua"),"--cmd",`source ${i}`],l=t().workspace.workspaceFolders,u=l&&l.length?l[0].uri.fsPath:void 0;!u||e.useWsl||t().env.remoteName||s.push("-c",`cd ${u}`),e.useWsl&&s.unshift(e.neovimPath),1===parseInt(process.env.NEOVIM_DEBUG||"",10)&&s.push("-u","NONE","--listen",`${process.env.NEOVIM_DEBUG_HOST||"127.0.0.1"}:${process.env.NEOVIM_DEBUG_PORT||4e3}`),e.clean&&s.push("--clean"),e.customInitFile&&s.push("-u",e.customInitFile),this.logger.debug(`${Ge}: Spawning nvim, path: ${e.neovimPath}, useWsl: ${e.useWsl}, args: ${JSON.stringify(s)}`),e.NVIM_APPNAME&&(process.env.NVIM_APPNAME=e.NVIM_APPNAME,e.useWsl&&(process.env.WSLENV="NVIM_APPNAME/u")),this.nvimProc=(0,r.spawn)(e.useWsl?"C:\\Windows\\system32\\wsl.exe":e.neovimPath,s,{}),this.nvimProc.on("close",(e=>{this.logger.error(`${Ge}: Neovim exited with code: ${e}`)})),this.nvimProc.on("error",(e=>{this.logger.error(`${Ge}: Neovim spawn error: ${e.message}. Check if the path is correct.`),t().window.showErrorMessage("Neovim: configure the path to neovim and restart the editor")})),this.logger.debug(`${Ge}: Attaching to neovim`),this.client=(0,a.ub)({proc:this.nvimProc,options:{logger:(0,c.createLogger)({transports:[new c.transports.Console],level:"error",exitOnError:!1})}}),this.verifyExperimentalAffinity()}init(){return ze(this,void 0,void 0,(function*(){this.logger.debug(`${Ge}: Init, attaching to neovim notifications`),this.client.on("disconnect",(()=>{this.logger.error(`${Ge}: Neovim was disconnected`)})),this.client.on("notification",this.onNeovimNotification),this.client.on("request",this.handleCustomRequest),yield this.client.setClientInfo("vscode-neovim",{major:0,minor:1,patch:0},"embedder",{},{}),yield this.checkNeovimVersion();const e=yield this.client.channelId;yield this.client.setVar("vscode_channel",e),this.commandsController=new l(this.client,this.settings.revealCursorScrollLine),this.disposables.push(this.commandsController),this.modeManager=new f(this.logger),this.disposables.push(this.modeManager),this.bufferManager=new pe(this.logger,this.client,this,{neovimViewportWidth:this.settings.neovimViewportWidth}),this.disposables.push(this.bufferManager),this.viewportManager=new He(this.logger,this.client,this,this.settings.neovimViewportHeightExtend),this.disposables.push(this.viewportManager),this.highlightManager=new Ue(this,this.settings.highlightsConfiguration),this.disposables.push(this.highlightManager),this.changeManager=new ke(this.logger,this.client,this),this.disposables.push(this.changeManager),this.cursorManager=new we(this.logger,this.client,this),this.disposables.push(this.cursorManager),this.typingManager=new ve(this.logger,this.client,this),this.disposables.push(this.typingManager),this.commandLineManager=new Ie(this.logger,this.client),this.disposables.push(this.commandLineManager),this.statusLineManager=new Le(this.logger,this.client),this.disposables.push(this.statusLineManager),this.customCommandsManager=new qe(this.logger,this),this.disposables.push(this.customCommandsManager),this.multilineMessagesManager=new Fe(this.logger),this.disposables.push(this.multilineMessagesManager),this.logger.debug(`${Ge}: UIAttach`),yield this.client.uiAttach(this.settings.neovimViewportWidth,100,{rgb:!0,ext_cmdline:!0,ext_linegrid:!0,ext_hlstate:!0,ext_messages:!0,ext_multigrid:!0,ext_popupmenu:!0,ext_tabline:!0,ext_wildmenu:!0}),yield this.bufferManager.forceResync(),yield t().commands.executeCommand("setContext","neovim.init",!0),this.logger.debug(`${Ge}: Init completed`)}))}dispose(){for(const e of this.disposables)e.dispose();this.client.quit()}checkNeovimVersion(){return ze(this,void 0,void 0,(function*(){const[,e]=yield this.client.apiInfo;(0===e.version.major&&e.version.minor<8||!e.ui_events.find((e=>"win_viewport"===e.name)))&&t().window.showErrorMessage("The extension requires neovim 0.8 or greater")}))}restartExtensionHostPrompt(e){return ze(this,void 0,void 0,(function*(){t().window.showInformationMessage(e,"Restart").then((e=>{"Restart"==e&&(this.logger.debug("Restarting extension host"),t().commands.executeCommand("workbench.action.restartExtensionHost"))}))}))}verifyExperimentalAffinity(){return ze(this,void 0,void 0,(function*(){const e=t().workspace.getConfiguration("extensions"),n=e.inspect("experimental.affinity"),i=null==n?void 0:n.workspaceValue;if(i&&z in i)return void this.logger.debug(`Extension affinity value ${i[z]} found in Workspace settings`);const r=null==n?void 0:n.globalValue;if(r&&z in r)return void this.logger.debug(`Extension affinity value ${r[z]} found in User settings`);this.logger.debug("Extension affinity value not set in User and Workspace settings");const s=t=>{this.logger.debug(`Setting extension affinity value to ${t} in User settings`),e.update("experimental.affinity",Object.assign(Object.assign({},r),{[z]:t}),!0).then((()=>{this.logger.debug(`Successfull set extension affinity value to ${t} in User settings`)}),(e=>{this.logger.error(`Error while setting experimental affinity. ${e}`)}))};t().window.showWarningMessage("No affinity assigned to vscode-neovim. It is recommended to assign affinity for major performance improvements. Would you like to set default affinity? [Learn more](https://github.com/vscode-neovim/vscode-neovim#affinity)","Yes","Cancel").then((e=>{"Yes"==e&&(s(1),this.restartExtensionHostPrompt("Requires restart of extension host for changes to take effect. This restarts all extensions."))}))}))}}var Ke=function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))};function Je(t){var n;return Ke(this,void 0,void 0,(function*(){const i=e.extensions.getExtension(z),r=e.workspace.getConfiguration(H),s=function(){var e;return null!==(e=ne("neovimExecutablePaths",{vscodeSettingName:"neovimPath",environmentVariableName:"NEOVIM_PATH"}))&&void 0!==e?e:"nvim"}(),o="win32"==process.platform,a=r.get("highlightGroups.highlights"),c=r.get("useCtrlKeysForNormalMode",!0),l=r.get("useCtrlKeysForInsertMode",!0),u=o&&r.get("useWSL",!1),h=r.get("revealCursorScrollLine",!1),d=r.get("neovimWidth",1e3),f=r.get("neovimViewportHeightExtend",1),p=null!==(n=ne("neovimInitVimPaths",{vscodeSettingName:"neovimInitPath"}))&&void 0!==n?n:"",g=r.get("neovimClean",!1),m=r.get("NVIM_APPNAME",""),v=r.get("logPath",""),b=r.get("logLevel","none"),y=r.get("logOutputToConsole",!1);e.commands.executeCommand("setContext","neovim.ctrlKeysNormal",c),e.commands.executeCommand("setContext","neovim.ctrlKeysInsert",l);try{const n=new Ye({customInitFile:p,clean:g,NVIM_APPNAME:m,extensionPath:t.extensionPath.replace(/\\/g,"\\\\"),highlightsConfiguration:{highlights:a},neovimPath:s,useWsl:i.extensionKind!==e.ExtensionKind.Workspace&&u,neovimViewportWidth:d,neovimViewportHeightExtend:f,revealCursorScrollLine:h,logConf:{logPath:v,outputToConsole:y,level:b}});t.subscriptions.push(n),yield n.init()}catch(t){e.window.showErrorMessage(`Unable to init vscode-neovim: ${t.message}`)}}))}function Qe(){}})(),module.exports=i})();
//# sourceMappingURL=extension.js.map